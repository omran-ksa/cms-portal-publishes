{"version":3,"file":"content-name.component-IlSUfsTr.js","sources":["../../../src/packages/ufm/components/content-name/content-name.element.ts","../../../src/packages/ufm/components/content-name/content-name.component.ts"],"sourcesContent":["import { UmbUfmElementBase } from '../ufm-element-base.js';\r\nimport { UMB_UFM_RENDER_CONTEXT } from '../ufm-render/ufm-render.context.js';\r\nimport { customElement, property } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbDocumentItemRepository, UMB_DOCUMENT_ENTITY_TYPE } from '@umbraco-cms/backoffice/document';\r\nimport { UmbId } from '@umbraco-cms/backoffice/id';\r\nimport { UmbMediaItemRepository, UMB_MEDIA_ENTITY_TYPE } from '@umbraco-cms/backoffice/media';\r\nimport { UmbMemberItemRepository, UMB_MEMBER_ENTITY_TYPE } from '@umbraco-cms/backoffice/member';\r\n\r\nconst elementName = 'ufm-content-name';\r\n\r\n@customElement(elementName)\r\nexport class UmbUfmContentNameElement extends UmbUfmElementBase {\r\n\t@property()\r\n\talias?: string;\r\n\r\n\t#documentRepository?: UmbDocumentItemRepository;\r\n\t#mediaRepository?: UmbMediaItemRepository;\r\n\t#memberRepository?: UmbMemberItemRepository;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_UFM_RENDER_CONTEXT, (context) => {\r\n\t\t\tthis.observe(\r\n\t\t\t\tcontext?.value,\r\n\t\t\t\tasync (value) => {\r\n\t\t\t\t\tconst temp =\r\n\t\t\t\t\t\tthis.alias && typeof value === 'object'\r\n\t\t\t\t\t\t\t? (value as Record<string, unknown>)[this.alias]\r\n\t\t\t\t\t\t\t: (value as unknown);\r\n\r\n\t\t\t\t\tif (!temp) return;\r\n\r\n\t\t\t\t\tconst entityType = this.#getEntityType(temp);\r\n\t\t\t\t\tconst uniques = this.#getUniques(temp);\r\n\r\n\t\t\t\t\tthis.value = await this.#getNames(entityType, uniques);\r\n\t\t\t\t},\r\n\t\t\t\t'observeValue',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t#getEntityType(value: unknown) {\r\n\t\tif (Array.isArray(value) && value.length > 0) {\r\n\t\t\tconst item = value[0];\r\n\t\t\tif (item.type) return item.type;\r\n\t\t\tif (item.mediaKey) return UMB_MEDIA_ENTITY_TYPE;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t#getUniques(value: unknown) {\r\n\t\tif (Array.isArray(value)) {\r\n\t\t\treturn value.map((x) => x.unique ?? x.mediaKey ?? x).filter((x) => UmbId.validate(x));\r\n\t\t}\r\n\r\n\t\treturn typeof value === 'string' && UmbId.validate(value) ? [value] : [];\r\n\t}\r\n\r\n\tasync #getNames(entityType: string, uniques?: Array<string>) {\r\n\t\tif (uniques?.length) {\r\n\t\t\tconst repository = this.#getRepository(entityType);\r\n\t\t\tif (repository) {\r\n\t\t\t\tconst { data } = await repository.requestItems(uniques);\r\n\t\t\t\tif (Array.isArray(data) && data.length > 0) {\r\n\t\t\t\t\treturn data.map((item) => item.name).join(', ');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t}\r\n\r\n\t#getRepository(entityType?: string | null) {\r\n\t\tswitch (entityType) {\r\n\t\t\tcase UMB_MEDIA_ENTITY_TYPE:\r\n\t\t\t\tif (!this.#mediaRepository) this.#mediaRepository = new UmbMediaItemRepository(this);\r\n\t\t\t\treturn this.#mediaRepository;\r\n\r\n\t\t\tcase UMB_MEMBER_ENTITY_TYPE:\r\n\t\t\t\tif (!this.#memberRepository) this.#memberRepository = new UmbMemberItemRepository(this);\r\n\t\t\t\treturn this.#memberRepository;\r\n\r\n\t\t\tcase UMB_DOCUMENT_ENTITY_TYPE:\r\n\t\t\tdefault:\r\n\t\t\t\tif (!this.#documentRepository) this.#documentRepository = new UmbDocumentItemRepository(this);\r\n\t\t\t\treturn this.#documentRepository;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport { UmbUfmContentNameElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t[elementName]: UmbUfmContentNameElement;\r\n\t}\r\n}\r\n","import type { UfmToken } from '../../plugins/marked-ufm.plugin.js';\r\nimport { UmbUfmComponentBase } from '../ufm-component-base.js';\r\n\r\nimport './content-name.element.js';\r\n\r\nexport class UmbUfmContentNameComponent extends UmbUfmComponentBase {\r\n\trender(token: UfmToken) {\r\n\t\tif (!token.text) return;\r\n\r\n\t\tif (token.prefix === '~') {\r\n\t\t\t/*\r\n\t\t\t * @deprecated since version 15.0-rc3\r\n\t\t\t */\r\n\t\t\tconsole.warn(`Please update your UFM syntax from \\`${token.raw}\\` to \\`{umbContentName:${token.text}}\\`.`);\r\n\t\t}\r\n\r\n\t\tconst attributes = super.getAttributes(token.text);\r\n\t\treturn `<ufm-content-name ${attributes}></ufm-content-name>`;\r\n\t}\r\n}\r\n\r\nexport { UmbUfmContentNameComponent as api };\r\n"],"names":["_documentRepository","_mediaRepository","_memberRepository","_UmbUfmContentNameElement_instances","getEntityType_fn","getUniques_fn","getNames_fn","getRepository_fn","elementName","UmbUfmContentNameElement","UmbUfmElementBase","__privateAdd","UMB_UFM_RENDER_CONTEXT","context","value","temp","entityType","__privateMethod","uniques","item","UMB_MEDIA_ENTITY_TYPE","x","UmbId","repository","data","__privateGet","UmbMediaItemRepository","UMB_MEMBER_ENTITY_TYPE","UmbMemberItemRepository","UMB_DOCUMENT_ENTITY_TYPE","UmbDocumentItemRepository","__decorateClass","property","customElement","UmbUfmContentNameComponent","UmbUfmComponentBase","token"],"mappings":"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"}