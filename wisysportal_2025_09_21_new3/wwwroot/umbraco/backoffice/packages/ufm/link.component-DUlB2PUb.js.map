{"version":3,"file":"link.component-DUlB2PUb.js","sources":["../../../src/packages/ufm/components/link/link.element.ts","../../../src/packages/ufm/components/link/link.component.ts"],"sourcesContent":["import { UmbUfmElementBase } from '../ufm-element-base.js';\r\nimport { UMB_UFM_RENDER_CONTEXT } from '../ufm-render/ufm-render.context.js';\r\nimport { customElement, property } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbDocumentItemRepository, UMB_DOCUMENT_ENTITY_TYPE } from '@umbraco-cms/backoffice/document';\r\nimport { UmbMediaItemRepository, UMB_MEDIA_ENTITY_TYPE } from '@umbraco-cms/backoffice/media';\r\nimport type { UmbLinkPickerLink } from '@umbraco-cms/backoffice/multi-url-picker';\r\n\r\nconst elementName = 'ufm-link';\r\n\r\n@customElement(elementName)\r\nexport class UmbUfmLinkElement extends UmbUfmElementBase {\r\n\t@property()\r\n\talias?: string;\r\n\r\n\t#documentRepository?: UmbDocumentItemRepository;\r\n\t#mediaRepository?: UmbMediaItemRepository;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_UFM_RENDER_CONTEXT, (context) => {\r\n\t\t\tthis.observe(\r\n\t\t\t\tcontext?.value,\r\n\t\t\t\tasync (value) => {\r\n\t\t\t\t\tconst temp =\r\n\t\t\t\t\t\tthis.alias && typeof value === 'object'\r\n\t\t\t\t\t\t\t? (value as Record<string, unknown>)[this.alias]\r\n\t\t\t\t\t\t\t: (value as unknown);\r\n\r\n\t\t\t\t\tif (!temp) return;\r\n\r\n\t\t\t\t\tconst items = Array.isArray(temp) ? temp : [temp];\r\n\t\t\t\t\tconst names = await Promise.all(items.map(async (item) => await this.#getName(item)));\r\n\t\t\t\t\tthis.value = names.filter((x) => x).join(', ');\r\n\t\t\t\t},\r\n\t\t\t\t'observeValue',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tasync #getName(item?: unknown) {\r\n\t\tconst link = item as UmbLinkPickerLink;\r\n\r\n\t\tif (link.name) {\r\n\t\t\treturn link.name;\r\n\t\t}\r\n\r\n\t\tconst entityType = link.type;\r\n\t\tconst unique = link.unique;\r\n\r\n\t\tif (unique) {\r\n\t\t\tconst repository = this.#getRepository(entityType);\r\n\t\t\tif (repository) {\r\n\t\t\t\tconst { data } = await repository.requestItems([unique]);\r\n\t\t\t\tif (Array.isArray(data) && data.length > 0) {\r\n\t\t\t\t\treturn data.map((item) => item.name).join(', ');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t}\r\n\r\n\t#getRepository(entityType?: string | null) {\r\n\t\tswitch (entityType) {\r\n\t\t\tcase UMB_MEDIA_ENTITY_TYPE:\r\n\t\t\t\tif (!this.#mediaRepository) this.#mediaRepository = new UmbMediaItemRepository(this);\r\n\t\t\t\treturn this.#mediaRepository;\r\n\r\n\t\t\tcase UMB_DOCUMENT_ENTITY_TYPE:\r\n\t\t\tdefault:\r\n\t\t\t\tif (!this.#documentRepository) this.#documentRepository = new UmbDocumentItemRepository(this);\r\n\t\t\t\treturn this.#documentRepository;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport { UmbUfmLinkElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t[elementName]: UmbUfmLinkElement;\r\n\t}\r\n}\r\n","import type { UfmToken } from '../../plugins/marked-ufm.plugin.js';\r\nimport { UmbUfmComponentBase } from '../ufm-component-base.js';\r\n\r\nimport './link.element.js';\r\n\r\nexport class UmbUfmLinkComponent extends UmbUfmComponentBase {\r\n\trender(token: UfmToken) {\r\n\t\tif (!token.text) return;\r\n\r\n\t\tconst attributes = super.getAttributes(token.text);\r\n\t\treturn `<ufm-link ${attributes}></ufm-link>`;\r\n\t}\r\n}\r\n\r\nexport { UmbUfmLinkComponent as api };\r\n"],"names":["_documentRepository","_mediaRepository","_UmbUfmLinkElement_instances","getName_fn","getRepository_fn","elementName","UmbUfmLinkElement","UmbUfmElementBase","__privateAdd","UMB_UFM_RENDER_CONTEXT","context","value","temp","items","names","item","__privateMethod","x","link","entityType","unique","repository","data","UMB_MEDIA_ENTITY_TYPE","__privateGet","UmbMediaItemRepository","UMB_DOCUMENT_ENTITY_TYPE","UmbDocumentItemRepository","__decorateClass","property","customElement","UmbUfmLinkComponent","UmbUfmComponentBase","token"],"mappings":";;;;;;;;;;;wYAAAA,GAAAC,GAAAC,GAAAC,GAAAC;AAOA,MAAMC,IAAc;AAGP,IAAAC,IAAN,cAAgCC,EAAkB;AAAA,EAOxD,cAAc;AACP,UAAA,GARDC,EAAA,MAAAN,CAAA,GAINM,EAAA,MAAAR,CAAA,GACAQ,EAAA,MAAAP,CAAA,GAKM,KAAA,eAAeQ,GAAwB,CAACC,MAAY;AACnD,WAAA;AAAA,QACJA,GAAS;AAAA,QACT,OAAOC,MAAU;AACV,gBAAAC,IACL,KAAK,SAAS,OAAOD,KAAU,WAC3BA,EAAkC,KAAK,KAAK,IAC5CA;AAEL,cAAI,CAACC,EAAM;AAEX,gBAAMC,IAAQ,MAAM,QAAQD,CAAI,IAAIA,IAAO,CAACA,CAAI,GAC1CE,IAAQ,MAAM,QAAQ,IAAID,EAAM,IAAI,OAAOE,MAAS,MAAMC,EAAA,MAAKd,GAALC,CAAA,EAAA,KAAA,MAAcY,EAAK,CAAC;AAC/E,eAAA,QAAQD,EAAM,OAAO,CAACG,MAAMA,CAAC,EAAE,KAAK,IAAI;AAAA,QAC9C;AAAA,QACA;AAAA,MACD;AAAA,IAAA,CACA;AAAA,EAAA;AAsCH;AA7DCjB,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AALMC,IAAA,oBAAA,QAAA;AA8BAC,IAAQ,eAACY,GAAgB;AAC9B,QAAMG,IAAOH;AAEb,MAAIG,EAAK;AACR,WAAOA,EAAK;AAGb,QAAMC,IAAaD,EAAK,MAClBE,IAASF,EAAK;AAEpB,MAAIE,GAAQ;AACL,UAAAC,IAAaL,EAAK,MAAAd,GAAAE,CAAA,EAAL,KAAoB,MAAAe,CAAA;AACvC,QAAIE,GAAY;AACT,YAAA,EAAE,MAAAC,MAAS,MAAMD,EAAW,aAAa,CAACD,CAAM,CAAC;AACvD,UAAI,MAAM,QAAQE,CAAI,KAAKA,EAAK,SAAS;AACjC,eAAAA,EAAK,IAAI,CAACP,MAASA,EAAK,IAAI,EAAE,KAAK,IAAI;AAAA,IAC/C;AAAA,EACD;AAGM,SAAA;AACR;AAEAX,IAAc,SAACe,GAA4B;AAC1C,UAAQA,GAAY;AAAA,IACnB,KAAKI;AACJ,aAAKC,EAAK,MAAAvB,CAAA,aAAuBA,GAAmB,IAAIwB,EAAuB,IAAI,CAAA,GAC5ED,EAAK,MAAAvB,CAAA;AAAA,IAEb,KAAKyB;AAAA,IACL;AACC,aAAKF,EAAK,MAAAxB,CAAA,aAA0BA,GAAsB,IAAI2B,EAA0B,IAAI,CAAA,GACrFH,EAAK,MAAAxB,CAAA;AAAA,EAAA;AAEf;AA9DA4B,EAAA;AAAA,EADCC,EAAS;AAAA,GADEvB,EAEZ,WAAA,SAAA,CAAA;AAFYA,IAANsB,EAAA;AAAA,EADNE,EAAczB,CAAW;AAAA,GACbC,CAAA;ACLN,MAAMyB,UAA4BC,EAAoB;AAAA,EAC5D,OAAOC,GAAiB;AACnB,WAACA,EAAM,OAGJ,aADY,MAAM,cAAcA,EAAM,IAAI,CACnB,iBAHb;AAAA,EAGa;AAEhC;"}