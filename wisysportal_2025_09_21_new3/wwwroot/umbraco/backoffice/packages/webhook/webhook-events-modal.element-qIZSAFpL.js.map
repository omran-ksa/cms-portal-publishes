{"version":3,"file":"webhook-events-modal.element-qIZSAFpL.js","sources":["../../../src/packages/webhook/webhook-event/modal/webhook-events-modal.element.ts"],"sourcesContent":["import { UmbWebhookEventRepository } from '../repository/webhook-event.repository.js';\r\nimport type { UmbWebhookEventModel } from '../types.js';\r\nimport type { UmbWebhookPickerModalData, UmbWebhookPickerModalValue } from './webhook-events-modal.token.js';\r\nimport { customElement, html, state, repeat } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbSelectionManager } from '@umbraco-cms/backoffice/utils';\r\n\r\n@customElement('umb-webhook-events-modal')\r\nexport class UmbWebhookEventsModalElement extends UmbModalBaseElement<\r\n\tUmbWebhookPickerModalData,\r\n\tUmbWebhookPickerModalValue\r\n> {\r\n\t@state()\r\n\t_events: Array<UmbWebhookEventModel> = [];\r\n\r\n\t#repository = new UmbWebhookEventRepository(this);\r\n\r\n\t#selectionManager = new UmbSelectionManager(this);\r\n\r\n\t#eventsRequest?: Promise<any>;\r\n\r\n\toverride connectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\r\n\t\tthis.#selectionManager.setSelectable(true);\r\n\t\tthis.#selectionManager.setMultiple(true);\r\n\t\tthis.#selectionManager.setSelection(this.data?.events.map((item) => item.alias) ?? []);\r\n\r\n\t\tthis.#requestEvents();\r\n\t\tthis.#observeSelection();\r\n\t}\r\n\r\n\tasync #observeSelection() {\r\n\t\tawait this.#eventsRequest;\r\n\r\n\t\tthis.observe(this.#selectionManager.selection, (selection) => {\r\n\t\t\tthis.value = { events: this._events.filter((item) => selection.includes(item.alias)) };\r\n\t\t});\r\n\t}\r\n\r\n\tasync #requestEvents() {\r\n\t\tthis.#eventsRequest = this.#repository.requestEvents();\r\n\t\tconst { data } = await this.#eventsRequest;\r\n\r\n\t\tif (!data) return;\r\n\r\n\t\tthis._events = data.items;\r\n\t}\r\n\r\n\t#submit() {\r\n\t\tthis.modalContext?.submit();\r\n\t}\r\n\r\n\t#close() {\r\n\t\tthis.modalContext?.reject();\r\n\t}\r\n\r\n\t#getItemDisabled(item: UmbWebhookEventModel) {\r\n\t\tconst selection = this.#selectionManager.getSelection();\r\n\r\n\t\tif (!selection.length) return false;\r\n\r\n\t\tconst selectedEvents = this._events.filter((item) => selection.includes(item.alias));\r\n\t\treturn selectedEvents[0].eventType !== item.eventType;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=${this.localize.term('webhooks_selectEvents')}>\r\n\t\t\t\t<uui-box>\r\n\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\tthis._events,\r\n\t\t\t\t\t\t(item) => item.alias,\r\n\t\t\t\t\t\t(item) => html`\r\n\t\t\t\t\t\t\t<uui-menu-item\r\n\t\t\t\t\t\t\t\tlabel=${item.eventName}\r\n\t\t\t\t\t\t\t\t?disabled=${this.#getItemDisabled(item)}\r\n\t\t\t\t\t\t\t\tselectable\r\n\t\t\t\t\t\t\t\t@selected=${() => this.#selectionManager.select(item.alias)}\r\n\t\t\t\t\t\t\t\t@deselected=${() => this.#selectionManager.deselect(item.alias)}\r\n\t\t\t\t\t\t\t\t?selected=${this.value.events.includes(item)}>\r\n\t\t\t\t\t\t\t\t<uui-icon slot=\"icon\" name=\"icon-globe\"></uui-icon>\r\n\t\t\t\t\t\t\t</uui-menu-item>\r\n\t\t\t\t\t\t`,\r\n\t\t\t\t\t)}\r\n\t\t\t\t</uui-box>\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button label=${this.localize.term('general_cancel')} @click=${this.#close}></uui-button>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlabel=${this.localize.term('general_submit')}\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t@click=${this.#submit}></uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n}\r\n\r\nexport default UmbWebhookEventsModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-webhook-events-modal': UmbWebhookEventsModalElement;\r\n\t}\r\n}\r\n"],"names":["_repository","_selectionManager","_eventsRequest","_UmbWebhookEventsModalElement_instances","observeSelection_fn","requestEvents_fn","submit_fn","close_fn","getItemDisabled_fn","UmbWebhookEventsModalElement","UmbModalBaseElement","__privateAdd","UmbWebhookEventRepository","UmbSelectionManager","__privateGet","item","__privateMethod","html","repeat","selection","__privateSet","data","__decorateClass","state","customElement","UmbWebhookEventsModalElement$1"],"mappings":"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"}