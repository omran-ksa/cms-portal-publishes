{"version":3,"file":"document-grid-collection-view.element-CZej2Nat.js","sources":["../../../src/packages/documents/documents/collection/views/grid/document-grid-collection-view.element.ts"],"sourcesContent":["import { UMB_DOCUMENT_COLLECTION_CONTEXT } from '../../document-collection.context-token.js';\r\nimport type { UmbDocumentCollectionFilterModel, UmbDocumentCollectionItemModel } from '../../types.js';\r\nimport { UMB_EDIT_DOCUMENT_WORKSPACE_PATH_PATTERN } from '../../../paths.js';\r\nimport { getPropertyValueByAlias } from '../index.js';\r\nimport { css, customElement, html, repeat, state, when } from '@umbraco-cms/backoffice/external/lit';\r\nimport { fromCamelCase } from '@umbraco-cms/backoffice/utils';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbModalRouteBuilder } from '@umbraco-cms/backoffice/router';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { UmbDefaultCollectionContext, UmbCollectionColumnConfiguration } from '@umbraco-cms/backoffice/collection';\r\nimport type { UUIInterfaceColor } from '@umbraco-cms/backoffice/external/uui';\r\n\r\nimport '@umbraco-cms/backoffice/ufm';\r\n\r\n@customElement('umb-document-grid-collection-view')\r\nexport class UmbDocumentGridCollectionViewElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _workspacePathBuilder?: UmbModalRouteBuilder;\r\n\r\n\t@state()\r\n\tprivate _items: Array<UmbDocumentCollectionItemModel> = [];\r\n\r\n\t@state()\r\n\tprivate _selection: Array<string | null> = [];\r\n\r\n\t@state()\r\n\tprivate _userDefinedProperties?: Array<UmbCollectionColumnConfiguration>;\r\n\r\n\t#collectionContext?: UmbDefaultCollectionContext<UmbDocumentCollectionItemModel, UmbDocumentCollectionFilterModel>;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_DOCUMENT_COLLECTION_CONTEXT, (collectionContext) => {\r\n\t\t\tthis.#collectionContext = collectionContext;\r\n\t\t\tcollectionContext?.setupView(this);\r\n\t\t\tthis.observe(\r\n\t\t\t\tcollectionContext?.workspacePathBuilder,\r\n\t\t\t\t(builder) => {\r\n\t\t\t\t\tthis._workspacePathBuilder = builder;\r\n\t\t\t\t},\r\n\t\t\t\t'observePath',\r\n\t\t\t);\r\n\t\t\tthis.#observeCollectionContext();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeCollectionContext() {\r\n\t\tif (!this.#collectionContext) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#collectionContext.userDefinedProperties,\r\n\t\t\t(userDefinedProperties) => {\r\n\t\t\t\tthis._userDefinedProperties = userDefinedProperties;\r\n\t\t\t},\r\n\t\t\t'_observeUserDefinedProperties',\r\n\t\t);\r\n\r\n\t\tthis.observe(this.#collectionContext.items, (items) => (this._items = items), '_observeItems');\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#collectionContext.selection.selection,\r\n\t\t\t(selection) => (this._selection = selection),\r\n\t\t\t'_observeSelection',\r\n\t\t);\r\n\t}\r\n\r\n\t#onSelect(item: UmbDocumentCollectionItemModel) {\r\n\t\tthis.#collectionContext?.selection.select(item.unique);\r\n\t}\r\n\r\n\t#onDeselect(item: UmbDocumentCollectionItemModel) {\r\n\t\tthis.#collectionContext?.selection.deselect(item.unique);\r\n\t}\r\n\r\n\t#isSelected(item: UmbDocumentCollectionItemModel) {\r\n\t\treturn this.#collectionContext?.selection.isSelected(item.unique);\r\n\t}\r\n\r\n\t#getEditUrl(item: UmbDocumentCollectionItemModel) {\r\n\t\treturn item.unique && this._workspacePathBuilder\r\n\t\t\t? this._workspacePathBuilder({ entityType: item.entityType }) +\r\n\t\t\t\t\tUMB_EDIT_DOCUMENT_WORKSPACE_PATH_PATTERN.generateLocal({\r\n\t\t\t\t\t\tunique: item.unique,\r\n\t\t\t\t\t})\r\n\t\t\t: '';\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<div id=\"document-grid\">\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tthis._items,\r\n\t\t\t\t\t(item) => item.unique,\r\n\t\t\t\t\t(item) => this.#renderItem(item),\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(item: UmbDocumentCollectionItemModel) {\r\n\t\treturn html`\r\n\t\t\t<uui-card-content-node\r\n\t\t\t\t.name=${item.name ?? 'Unnamed Document'}\r\n\t\t\t\tselectable\r\n\t\t\t\t?select-only=${this._selection.length > 0}\r\n\t\t\t\t?selected=${this.#isSelected(item)}\r\n\t\t\t\thref=${this.#getEditUrl(item)}\r\n\t\t\t\t@selected=${() => this.#onSelect(item)}\r\n\t\t\t\t@deselected=${() => this.#onDeselect(item)}>\r\n\t\t\t\t<umb-icon slot=\"icon\" name=${item.icon}></umb-icon>\r\n\t\t\t\t${this.#renderState(item)} ${this.#renderProperties(item)}\r\n\t\t\t</uui-card-content-node>\r\n\t\t`;\r\n\t}\r\n\r\n\t#getStateTagConfig(state: string): { color: UUIInterfaceColor; label: string } {\r\n\t\tswitch (state) {\r\n\t\t\tcase 'Published':\r\n\t\t\t\treturn { color: 'positive', label: this.localize.term('content_published') };\r\n\t\t\tcase 'PublishedPendingChanges':\r\n\t\t\t\treturn { color: 'warning', label: this.localize.term('content_publishedPendingChanges') };\r\n\t\t\tcase 'Draft':\r\n\t\t\t\treturn { color: 'default', label: this.localize.term('content_unpublished') };\r\n\t\t\tcase 'NotCreated':\r\n\t\t\t\treturn { color: 'danger', label: this.localize.term('content_notCreated') };\r\n\t\t\tdefault:\r\n\t\t\t\treturn { color: 'danger', label: fromCamelCase(state) };\r\n\t\t}\r\n\t}\r\n\r\n\t#renderState(item: UmbDocumentCollectionItemModel) {\r\n\t\tconst tagConfig = this.#getStateTagConfig(item.state);\r\n\t\treturn html`<uui-tag slot=\"tag\" color=${tagConfig.color} look=\"secondary\">${tagConfig.label}</uui-tag>`;\r\n\t}\r\n\r\n\t#renderProperties(item: UmbDocumentCollectionItemModel) {\r\n\t\tif (!this._userDefinedProperties) return;\r\n\t\treturn html`\r\n\t\t\t<ul>\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tthis._userDefinedProperties,\r\n\t\t\t\t\t(column) => column.alias,\r\n\t\t\t\t\t(column) => this.#renderProperty(item, column),\r\n\t\t\t\t)}\r\n\t\t\t</ul>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderProperty(item: UmbDocumentCollectionItemModel, column: UmbCollectionColumnConfiguration) {\r\n\t\tconst value = getPropertyValueByAlias(item, column.alias);\r\n\t\treturn html`\r\n\t\t\t<li>\r\n\t\t\t\t<span>${this.localize.string(column.header)}:</span>\r\n\t\t\t\t${when(\r\n\t\t\t\t\tcolumn.nameTemplate,\r\n\t\t\t\t\t() => html`<umb-ufm-render inline .markdown=${column.nameTemplate} .value=${{ value }}></umb-ufm-render>`,\r\n\t\t\t\t\t() => html`${value}`,\r\n\t\t\t\t)}\r\n\t\t\t</li>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\r\n\t\t\t.container {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\t#document-grid {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\tuui-card-content-node {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 180px;\r\n\t\t\t}\r\n\r\n\t\t\tul {\r\n\t\t\t\tlist-style: none;\r\n\t\t\t\tpadding-inline-start: 0px;\r\n\t\t\t\tmargin: 0;\r\n\t\t\t}\r\n\r\n\t\t\tul > li > span {\r\n\t\t\t\tfont-weight: 700;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbDocumentGridCollectionViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-document-grid-collection-view': UmbDocumentGridCollectionViewElement;\r\n\t}\r\n}\r\n"],"names":["_collectionContext","_UmbDocumentGridCollectionViewElement_instances","observeCollectionContext_fn","onSelect_fn","onDeselect_fn","isSelected_fn","getEditUrl_fn","renderItem_fn","getStateTagConfig_fn","renderState_fn","renderProperties_fn","renderProperty_fn","UmbDocumentGridCollectionViewElement","UmbLitElement","__privateAdd","UMB_DOCUMENT_COLLECTION_CONTEXT","collectionContext","__privateSet","builder","__privateMethod","html","repeat","item","__privateGet","userDefinedProperties","items","selection","UMB_EDIT_DOCUMENT_WORKSPACE_PATH_PATTERN","state","fromCamelCase","tagConfig","column","value","getPropertyValueByAlias","when","UmbTextStyles","css","__decorateClass","customElement","UmbDocumentGridCollectionViewElement$1"],"mappings":"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"}