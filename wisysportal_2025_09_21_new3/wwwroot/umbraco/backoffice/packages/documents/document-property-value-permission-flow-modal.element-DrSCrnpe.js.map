{"version":3,"file":"document-property-value-permission-flow-modal.element-DrSCrnpe.js","sources":["../../../src/packages/documents/documents/user-permissions/document-property-value/document-property-value-permission-flow-modal/document-property-value-permission-flow-modal.element.ts"],"sourcesContent":["import { UMB_DOCUMENT_PROPERTY_VALUE_USER_PERMISSION_FLOW_PROPERTY_TYPE_MODAL } from './property-type-modal/property-type-modal.token.js';\r\nimport type {\r\n\tUmbDocumentPropertyValueUserPermissionFlowModalData,\r\n\tUmbDocumentPropertyValueUserPermissionFlowModalValue,\r\n} from './document-property-value-permission-flow-modal.token.js';\r\nimport { html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UMB_MODAL_MANAGER_CONTEXT, UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_DOCUMENT_TYPE_TREE_ALIAS } from '@umbraco-cms/backoffice/document-type';\r\nimport type { UmbSelectionChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport type { UmbTreeElement } from '@umbraco-cms/backoffice/tree';\r\n\r\n@customElement('umb-document-property-value-user-permission-flow-modal')\r\nexport class UmbDocumentPropertyValueUserPermissionFlowModalElement extends UmbModalBaseElement<\r\n\tUmbDocumentPropertyValueUserPermissionFlowModalData,\r\n\tUmbDocumentPropertyValueUserPermissionFlowModalValue\r\n> {\r\n\t@state()\r\n\t_selection: Array<string> = [];\r\n\r\n\tasync #next() {\r\n\t\tif (this._selection.length === 0) {\r\n\t\t\tthrow new Error('No document type selected');\r\n\t\t}\r\n\r\n\t\tconst documentType = { unique: this._selection[0] };\r\n\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tif (!modalManager) {\r\n\t\t\tthrow new Error('Could not get modal manager context');\r\n\t\t}\r\n\r\n\t\tconst modal = modalManager.open(this, UMB_DOCUMENT_PROPERTY_VALUE_USER_PERMISSION_FLOW_PROPERTY_TYPE_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\tdocumentType,\r\n\t\t\t\tpreset: {\r\n\t\t\t\t\tverbs: this.data?.preset?.verbs,\r\n\t\t\t\t},\r\n\t\t\t\tpickableFilter: this.data?.pickablePropertyTypeFilter,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\ttry {\r\n\t\t\tconst value = await modal.onSubmit();\r\n\r\n\t\t\tthis.updateValue({\r\n\t\t\t\tdocumentType,\r\n\t\t\t\tpropertyType: value.propertyType,\r\n\t\t\t\tverbs: value.verbs,\r\n\t\t\t});\r\n\r\n\t\t\tthis._submitModal();\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t}\r\n\r\n\t#onTreeSelectionChange(event: UmbSelectionChangeEvent) {\r\n\t\tconst target = event.target as UmbTreeElement;\r\n\t\tconst selection = target.getSelection();\r\n\t\tthis._selection = [...selection];\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=\"Choose Document Type\">\r\n\t\t\t\t<uui-box>\r\n\t\t\t\t\t<umb-tree\r\n\t\t\t\t\t\t@selection-change=${this.#onTreeSelectionChange}\r\n\t\t\t\t\t\t.props=${{\r\n\t\t\t\t\t\t\thideTreeRoot: true,\r\n\t\t\t\t\t\t\thideTreeItemActions: true,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\talias=${UMB_DOCUMENT_TYPE_TREE_ALIAS}></umb-tree>\r\n\t\t\t\t</uui-box>\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button label=${this.localize.term('general_close')} @click=${this._rejectModal}></uui-button>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlabel=\"${this.localize.term('general_next')}\"\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t@click=${this.#next}\r\n\t\t\t\t\t\t?disabled=${this._selection.length === 0}></uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n}\r\n\r\nexport { UmbDocumentPropertyValueUserPermissionFlowModalElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-document-property-value-user-permission-flow-modal': UmbDocumentPropertyValueUserPermissionFlowModalElement;\r\n\t}\r\n}\r\n"],"names":["_UmbDocumentPropertyValueUserPermissionFlowModalElement_instances","next_fn","onTreeSelectionChange_fn","UmbDocumentPropertyValueUserPermissionFlowModalElement","UmbModalBaseElement","__privateAdd","html","__privateMethod","UMB_DOCUMENT_TYPE_TREE_ALIAS","documentType","modalManager","UMB_MODAL_MANAGER_CONTEXT","modal","UMB_DOCUMENT_PROPERTY_VALUE_USER_PERMISSION_FLOW_PROPERTY_TYPE_MODAL","value","err","event","selection","__decorateClass","state","customElement"],"mappings":";;;;;;;;;;8OAAAA,GAAAC,GAAAC;AAYa,IAAAC,IAAN,cAAqEC,EAG1E;AAAA,EAHK,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAL,CAAA,GAKN,KAAA,aAA4B,CAAC;AAAA,EAAA;AAAA,EA6CpB,SAAS;AACV,WAAAM;AAAA;AAAA;AAAA;AAAA,0BAIiBC,QAAKP,GAAsBE,CAAA,CAAA;AAAA,eACtC;AAAA,MACR,cAAc;AAAA,MACd,qBAAqB;AAAA,IACrB,CAAA;AAAA,cACOM,CAA4B;AAAA;AAAA;AAAA,yBAGjB,KAAK,SAAS,KAAK,eAAe,CAAC,WAAW,KAAK,YAAY;AAAA;AAAA,eAEzE,KAAK,SAAS,KAAK,cAAc,CAAC;AAAA;AAAA;AAAA,eAGlCD,QAAKP,GAAKC,CAAA,CAAA;AAAA,kBACP,KAAK,WAAW,WAAW,CAAC;AAAA;AAAA;AAAA;AAAA,EAAA;AAK9C;AA1EOD,IAAA,oBAAA,QAAA;AAOAC,IAAK,iBAAG;AACT,MAAA,KAAK,WAAW,WAAW;AACxB,UAAA,IAAI,MAAM,2BAA2B;AAG5C,QAAMQ,IAAe,EAAE,QAAQ,KAAK,WAAW,CAAC,EAAE,GAE5CC,IAAe,MAAM,KAAK,WAAWC,CAAyB;AACpE,MAAI,CAACD;AACE,UAAA,IAAI,MAAM,qCAAqC;AAGtD,QAAME,IAAQF,EAAa,KAAK,MAAMG,GAAsE;AAAA,IAC3G,MAAM;AAAA,MACL,cAAAJ;AAAA,MACA,QAAQ;AAAA,QACP,OAAO,KAAK,MAAM,QAAQ;AAAA,MAC3B;AAAA,MACA,gBAAgB,KAAK,MAAM;AAAA,IAAA;AAAA,EAC5B,CACA;AAEG,MAAA;AACG,UAAAK,IAAQ,MAAMF,EAAM,SAAS;AAEnC,SAAK,YAAY;AAAA,MAChB,cAAAH;AAAA,MACA,cAAcK,EAAM;AAAA,MACpB,OAAOA,EAAM;AAAA,IAAA,CACb,GAED,KAAK,aAAa;AAAA,WACVC,GAAK;AACb,YAAQ,MAAMA,CAAG;AAAA,EAAA;AAEnB;AAEAb,IAAsB,SAACc,GAAgC;AAEhD,QAAAC,IADSD,EAAM,OACI,aAAa;AACjC,OAAA,aAAa,CAAC,GAAGC,CAAS;AAChC;AA3CAC,EAAA;AAAA,EADCC,EAAM;AAAA,GAJKhB,EAKZ,WAAA,cAAA,CAAA;AALYA,IAANe,EAAA;AAAA,EADNE,EAAc,wDAAwD;AAAA,GAC1DjB,CAAA;"}