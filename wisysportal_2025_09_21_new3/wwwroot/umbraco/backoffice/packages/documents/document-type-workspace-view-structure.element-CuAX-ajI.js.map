{"version":3,"file":"document-type-workspace-view-structure.element-CuAX-ajI.js","sources":["../../../src/packages/documents/document-types/workspace/document-type/views/structure/document-type-workspace-view-structure.element.ts"],"sourcesContent":["import type { UmbDocumentTypeWorkspaceContext } from '../../document-type-workspace.context.js';\r\nimport type { UmbInputDocumentTypeElement } from '../../../../components/input-document-type/input-document-type.element.js';\r\nimport { UMB_DOCUMENT_TYPE_WORKSPACE_CONTEXT } from '../../document-type-workspace.context-token.js';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type {\r\n\tUmbContentTypeSortModel,\r\n\tUmbInputContentTypeCollectionConfigurationElement,\r\n} from '@umbraco-cms/backoffice/content-type';\r\nimport type { UmbWorkspaceViewElement } from '@umbraco-cms/backoffice/workspace';\r\nimport type { UUIToggleElement } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n@customElement('umb-document-type-workspace-view-structure')\r\nexport class UmbDocumentTypeWorkspaceViewStructureElement extends UmbLitElement implements UmbWorkspaceViewElement {\r\n\t#workspaceContext?: UmbDocumentTypeWorkspaceContext;\r\n\r\n\t@state()\r\n\tprivate _allowedAtRoot?: boolean;\r\n\r\n\t@state()\r\n\tprivate _allowedContentTypeUniques?: Array<string>;\r\n\r\n\t@state()\r\n\tprivate _collection?: string | null;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\t// TODO: Figure out if this is the best way to consume the context or if it can be strongly typed with an UmbContextToken\r\n\t\tthis.consumeContext(UMB_DOCUMENT_TYPE_WORKSPACE_CONTEXT, (documentTypeContext) => {\r\n\t\t\tthis.#workspaceContext = documentTypeContext as UmbDocumentTypeWorkspaceContext;\r\n\t\t\tthis._observeDocumentType();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _observeDocumentType() {\r\n\t\tif (!this.#workspaceContext) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.allowedAtRoot,\r\n\t\t\t(allowedAtRoot) => (this._allowedAtRoot = allowedAtRoot),\r\n\t\t\t'_allowedAtRootObserver',\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.allowedContentTypes,\r\n\t\t\t(allowedContentTypes) => {\r\n\t\t\t\tconst oldValue = this._allowedContentTypeUniques;\r\n\t\t\t\tthis._allowedContentTypeUniques = allowedContentTypes\r\n\t\t\t\t\t?.map((x) => x.contentType.unique)\r\n\t\t\t\t\t.filter((x) => x !== undefined) as Array<string>;\r\n\t\t\t\tthis.requestUpdate('_allowedContentTypeUniques', oldValue);\r\n\t\t\t},\r\n\t\t\t'_allowedContentTypesObserver',\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.collection,\r\n\t\t\t(collection) => {\r\n\t\t\t\tthis._collection = collection?.unique;\r\n\t\t\t},\r\n\t\t\t'_collectionObserver',\r\n\t\t);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<uui-box headline=${this.localize.term('contentTypeEditor_structure')}>\r\n\t\t\t\t<umb-property-layout alias=\"Root\" label=${this.localize.term('contentTypeEditor_allowAtRootHeading')}>\r\n\t\t\t\t\t<div slot=\"description\">${this.localize.term('contentTypeEditor_allowAtRootDescription')}</div>\r\n\t\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t\t<uui-toggle\r\n\t\t\t\t\t\t\tlabel=${this.localize.term('contentTypeEditor_allowAtRootHeading')}\r\n\t\t\t\t\t\t\t?checked=${this._allowedAtRoot}\r\n\t\t\t\t\t\t\t@change=${(e: CustomEvent) => {\r\n\t\t\t\t\t\t\t\tthis.#workspaceContext?.setAllowedAtRoot((e.target as UUIToggleElement).checked);\r\n\t\t\t\t\t\t\t}}></uui-toggle>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t\t<umb-property-layout alias=\"ChildNodeType\" label=${this.localize.term('contentTypeEditor_childNodesHeading')}>\r\n\t\t\t\t\t<div slot=\"description\">${this.localize.term('contentTypeEditor_childNodesDescription')}</div>\r\n\t\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t\t<!-- TODO: maybe we want to somehow display the hierarchy, but not necessary in the same way as old backoffice? -->\r\n\t\t\t\t\t\t<umb-input-document-type\r\n\t\t\t\t\t\t\t.documentTypesOnly=${true}\r\n\t\t\t\t\t\t\t.selection=${this._allowedContentTypeUniques ?? []}\r\n\t\t\t\t\t\t\t@change=\"${(e: CustomEvent & { target: UmbInputDocumentTypeElement }) => {\r\n\t\t\t\t\t\t\t\tconst sortedContentTypesList: Array<UmbContentTypeSortModel> = e.target.selection.map((id, index) => ({\r\n\t\t\t\t\t\t\t\t\tcontentType: { unique: id },\r\n\t\t\t\t\t\t\t\t\tsortOrder: index,\r\n\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\tthis.#workspaceContext?.setAllowedContentTypes(sortedContentTypesList);\r\n\t\t\t\t\t\t\t}}\">\r\n\t\t\t\t\t\t</umb-input-document-type>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t</uui-box>\r\n\t\t\t<uui-box headline=${this.localize.term('contentTypeEditor_presentation')}>\r\n\t\t\t\t<umb-property-layout alias=\"collection\" label=\"${this.localize.term('contentTypeEditor_collection')}\">\r\n\t\t\t\t\t<div slot=\"description\">${this.localize.term('contentTypeEditor_collectionDescription')}</div>\r\n\t\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t\t<umb-input-content-type-collection-configuration\r\n\t\t\t\t\t\t\tdefault-value=\"c0808dd3-8133-4e4b-8ce8-e2bea84a96a4\"\r\n\t\t\t\t\t\t\t.value=${this._collection ?? undefined}\r\n\t\t\t\t\t\t\t@change=${(e: CustomEvent) => {\r\n\t\t\t\t\t\t\t\tconst unique = (e.target as UmbInputContentTypeCollectionConfigurationElement).value as string;\r\n\t\t\t\t\t\t\t\tthis.#workspaceContext?.setCollection({ unique });\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t</umb-input-content-type-collection-configuration>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tmargin: var(--uui-size-layout-1);\r\n\t\t\t\tpadding-bottom: var(--uui-size-layout-1); // To enforce some distance to the bottom of the scroll-container.\r\n\t\t\t}\r\n\t\t\tuui-box {\r\n\t\t\t\tmargin-top: var(--uui-size-layout-1);\r\n\t\t\t}\r\n\t\t\tuui-label,\r\n\t\t\tumb-property-editor-ui-number {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\r\n\t\t\t// TODO: is this necessary?\r\n\t\t\tuui-toggle {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbDocumentTypeWorkspaceViewStructureElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-document-type-workspace-view-structure': UmbDocumentTypeWorkspaceViewStructureElement;\r\n\t}\r\n}\r\n"],"names":["_workspaceContext","UmbDocumentTypeWorkspaceViewStructureElement","UmbLitElement","__privateAdd","UMB_DOCUMENT_TYPE_WORKSPACE_CONTEXT","documentTypeContext","__privateSet","__privateGet","allowedAtRoot","allowedContentTypes","oldValue","x","collection","html","sortedContentTypesList","id","index","unique","UmbTextStyles","css","__decorateClass","state","customElement","UmbDocumentTypeWorkspaceViewStructureElement$1"],"mappings":"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"}