{"version":3,"file":"document-type-tree-item-table-collection-view.element-td9veAa7.js","sources":["../../../src/packages/documents/document-types/tree/tree-item-children/collection/views/document-type-tree-item-table-collection-view.element.ts"],"sourcesContent":["import { UMB_EDIT_DOCUMENT_TYPE_WORKSPACE_PATH_PATTERN } from '../../../../paths.js';\r\nimport { UMB_EDIT_DOCUMENT_TYPE_FOLDER_WORKSPACE_PATH_PATTERN } from '../../../constants.js';\r\nimport type { UmbDocumentTypeTreeItemModel } from '../../../types.js';\r\nimport type { UmbDefaultCollectionContext } from '@umbraco-cms/backoffice/collection';\r\nimport { UMB_COLLECTION_CONTEXT } from '@umbraco-cms/backoffice/collection';\r\nimport type { UmbTableColumn, UmbTableConfig, UmbTableItem } from '@umbraco-cms/backoffice/components';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbModalRouteRegistrationController, type UmbModalRouteBuilder } from '@umbraco-cms/backoffice/router';\r\nimport { UMB_WORKSPACE_MODAL } from '@umbraco-cms/backoffice/workspace';\r\n\r\nconst elementName = 'umb-document-type-tree-item-table-collection-view';\r\n@customElement(elementName)\r\nexport class UmbDocumentTypeTreeItemTableCollectionViewElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _tableConfig: UmbTableConfig = {\r\n\t\tallowSelection: false,\r\n\t};\r\n\r\n\t@state()\r\n\tprivate _tableColumns: Array<UmbTableColumn> = [\r\n\t\t{\r\n\t\t\tname: 'Name',\r\n\t\t\talias: 'name',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Element Type',\r\n\t\t\talias: 'isElementType',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '',\r\n\t\t\talias: 'entityActions',\r\n\t\t\talign: 'right',\r\n\t\t},\r\n\t];\r\n\r\n\t@state()\r\n\tprivate _tableItems: Array<UmbTableItem> = [];\r\n\r\n\t#collectionContext?: UmbDefaultCollectionContext<any>;\r\n\t#routeBuilder?: UmbModalRouteBuilder;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_COLLECTION_CONTEXT, (instance) => {\r\n\t\t\tthis.#collectionContext = instance;\r\n\t\t});\r\n\r\n\t\tthis.#registerModalRoute();\r\n\t}\r\n\r\n\t#registerModalRoute() {\r\n\t\tnew UmbModalRouteRegistrationController(this, UMB_WORKSPACE_MODAL)\r\n\t\t\t.addAdditionalPath(':entityType')\r\n\t\t\t.onSetup((params) => {\r\n\t\t\t\treturn { data: { entityType: params.entityType, preset: {} } };\r\n\t\t\t})\r\n\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\tthis.#routeBuilder = routeBuilder;\r\n\r\n\t\t\t\t// NOTE: Configuring the observations AFTER the route builder is ready,\r\n\t\t\t\t// otherwise there is a race condition and `#collectionContext.items` tends to win. [LK]\r\n\t\t\t\tthis.#observeCollectionItems();\r\n\t\t\t});\r\n\t}\r\n\r\n\t#observeCollectionItems() {\r\n\t\tif (!this.#collectionContext) return;\r\n\t\tthis.observe(this.#collectionContext.items, (items) => this.#createTableItems(items), 'umbCollectionItemsObserver');\r\n\t}\r\n\r\n\t#createTableItems(items: Array<UmbDocumentTypeTreeItemModel>) {\r\n\t\tconst routeBuilder = this.#routeBuilder;\r\n\t\tif (!routeBuilder) throw new Error('Route builder not ready');\r\n\r\n\t\tthis._tableItems = items.map((item) => {\r\n\t\t\tconst modalEditPath =\r\n\t\t\t\trouteBuilder({ entityType: item.entityType }) +\r\n\t\t\t\tUMB_EDIT_DOCUMENT_TYPE_WORKSPACE_PATH_PATTERN.generateLocal({ unique: item.unique });\r\n\t\t\tconst inlineEditPath = UMB_EDIT_DOCUMENT_TYPE_FOLDER_WORKSPACE_PATH_PATTERN.generateAbsolute({\r\n\t\t\t\tunique: item.unique,\r\n\t\t\t});\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid: item.unique,\r\n\t\t\t\ticon: item.isFolder && !item.icon ? 'icon-folder' : item.icon,\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'name',\r\n\t\t\t\t\t\tvalue: html`<uui-button\r\n\t\t\t\t\t\t\thref=${item.isFolder ? inlineEditPath : modalEditPath}\r\n\t\t\t\t\t\t\tlabel=${item.name}></uui-button>`,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'isElementType',\r\n\t\t\t\t\t\tvalue: html`<umb-boolean-table-column-view .value=${item.isElement}></umb-boolean-table-column-view>`,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'entityActions',\r\n\t\t\t\t\t\tvalue: html`<umb-entity-actions-table-column-view\r\n\t\t\t\t\t\t\t.value=${{\r\n\t\t\t\t\t\t\t\tentityType: item.entityType,\r\n\t\t\t\t\t\t\t\tunique: item.unique,\r\n\t\t\t\t\t\t\t\tname: item.name,\r\n\t\t\t\t\t\t\t}}></umb-entity-actions-table-column-view>`,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-table .config=${this._tableConfig} .columns=${this._tableColumns} .items=${this._tableItems}></umb-table>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport { UmbDocumentTypeTreeItemTableCollectionViewElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t[elementName]: UmbDocumentTypeTreeItemTableCollectionViewElement;\r\n\t}\r\n}\r\n"],"names":["_collectionContext","_routeBuilder","_UmbDocumentTypeTreeItemTableCollectionViewElement_instances","registerModalRoute_fn","observeCollectionItems_fn","createTableItems_fn","elementName","UmbDocumentTypeTreeItemTableCollectionViewElement","UmbLitElement","__privateAdd","UMB_COLLECTION_CONTEXT","instance","__privateSet","__privateMethod","html","UmbModalRouteRegistrationController","UMB_WORKSPACE_MODAL","params","routeBuilder","__privateGet","items","item","modalEditPath","UMB_EDIT_DOCUMENT_TYPE_WORKSPACE_PATH_PATTERN","inlineEditPath","UMB_EDIT_DOCUMENT_TYPE_FOLDER_WORKSPACE_PATH_PATTERN","UmbTextStyles","css","__decorateClass","state","customElement"],"mappings":"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"}