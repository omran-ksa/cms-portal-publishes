{"version":3,"file":"document-blueprint-workspace.context-CUNmuG1N.js","sources":["../../../src/packages/documents/document-blueprints/property-dataset-context/document-blueprint-property-dataset-context.ts","../../../src/packages/documents/document-blueprints/workspace/document-blueprint-workspace.context.ts"],"sourcesContent":["import type { UmbDocumentBlueprintDetailModel, UmbDocumentBlueprintVariantModel } from '../types.js';\r\nimport { UmbContentPropertyDatasetContext } from '@umbraco-cms/backoffice/content';\r\nimport type { UmbDocumentTypeDetailModel } from '@umbraco-cms/backoffice/document-type';\r\n\r\nexport class UmbDocumentBlueprintPropertyDatasetContext extends UmbContentPropertyDatasetContext<\r\n\tUmbDocumentBlueprintDetailModel,\r\n\tUmbDocumentTypeDetailModel,\r\n\tUmbDocumentBlueprintVariantModel\r\n> {}\r\n","import { UmbDocumentBlueprintPropertyDatasetContext } from '../property-dataset-context/document-blueprint-property-dataset-context.js';\r\nimport { UMB_DOCUMENT_BLUEPRINT_ENTITY_TYPE } from '../entity.js';\r\nimport type { UmbDocumentBlueprintDetailRepository } from '../repository/index.js';\r\nimport { UMB_DOCUMENT_BLUEPRINT_DETAIL_REPOSITORY_ALIAS } from '../constants.js';\r\nimport type { UmbDocumentBlueprintDetailModel, UmbDocumentBlueprintVariantModel } from '../types.js';\r\nimport { UMB_CREATE_DOCUMENT_BLUEPRINT_WORKSPACE_PATH_PATTERN } from '../paths.js';\r\nimport { UMB_DOCUMENT_BLUEPRINT_WORKSPACE_ALIAS } from './constants.js';\r\nimport {\r\n\tUmbWorkspaceIsNewRedirectController,\r\n\tUmbWorkspaceIsNewRedirectControllerAlias,\r\n} from '@umbraco-cms/backoffice/workspace';\r\nimport {\r\n\ttype UmbDocumentTypeDetailModel,\r\n\tUmbDocumentTypeDetailRepository,\r\n} from '@umbraco-cms/backoffice/document-type';\r\nimport type { UmbVariantId } from '@umbraco-cms/backoffice/variant';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UmbContentDetailWorkspaceContextBase, type UmbContentWorkspaceContext } from '@umbraco-cms/backoffice/content';\r\nimport {\r\n\tUMB_DOCUMENT_COLLECTION_ALIAS,\r\n\tUMB_DOCUMENT_DETAIL_MODEL_VARIANT_SCAFFOLD,\r\n\tUMB_EDIT_DOCUMENT_WORKSPACE_PATH_PATTERN,\r\n} from '@umbraco-cms/backoffice/document';\r\nimport type { UmbEntityModel } from '@umbraco-cms/backoffice/entity';\r\n\r\ntype ContentModel = UmbDocumentBlueprintDetailModel;\r\ntype ContentTypeModel = UmbDocumentTypeDetailModel;\r\n\r\nexport class UmbDocumentBlueprintWorkspaceContext\r\n\textends UmbContentDetailWorkspaceContextBase<\r\n\t\tContentModel,\r\n\t\tUmbDocumentBlueprintDetailRepository,\r\n\t\tContentTypeModel,\r\n\t\tUmbDocumentBlueprintVariantModel\r\n\t>\r\n\timplements UmbContentWorkspaceContext<ContentModel, UmbDocumentTypeDetailModel, UmbDocumentBlueprintVariantModel>\r\n{\r\n\treadonly contentTypeUnique = this._data.createObservablePartOfCurrent((data) => data?.documentType.unique);\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, {\r\n\t\t\tentityType: UMB_DOCUMENT_BLUEPRINT_ENTITY_TYPE,\r\n\t\t\tworkspaceAlias: UMB_DOCUMENT_BLUEPRINT_WORKSPACE_ALIAS,\r\n\t\t\tdetailRepositoryAlias: UMB_DOCUMENT_BLUEPRINT_DETAIL_REPOSITORY_ALIAS,\r\n\t\t\tcontentTypeDetailRepository: UmbDocumentTypeDetailRepository,\r\n\t\t\tcontentVariantScaffold: UMB_DOCUMENT_DETAIL_MODEL_VARIANT_SCAFFOLD,\r\n\t\t\tcontentTypePropertyName: 'documentType',\r\n\t\t});\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.contentTypeUnique,\r\n\t\t\t(unique) => {\r\n\t\t\t\tif (unique) {\r\n\t\t\t\t\tthis.structure.loadType(unique);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\r\n\t\tthis.routes.setRoutes([\r\n\t\t\t{\r\n\t\t\t\tpath: UMB_CREATE_DOCUMENT_BLUEPRINT_WORKSPACE_PATH_PATTERN.toString(),\r\n\t\t\t\tcomponent: () => import('./document-blueprint-workspace-editor.element.js'),\r\n\t\t\t\tsetup: async (_component, info) => {\r\n\t\t\t\t\tconst parentEntityType = info.match.params.parentEntityType;\r\n\t\t\t\t\tconst parentUnique = info.match.params.parentUnique === 'null' ? null : info.match.params.parentUnique;\r\n\t\t\t\t\tconst documentTypeUnique = info.match.params.documentTypeUnique;\r\n\t\t\t\t\tawait this.create({ entityType: parentEntityType, unique: parentUnique }, documentTypeUnique);\r\n\r\n\t\t\t\t\tnew UmbWorkspaceIsNewRedirectController(\r\n\t\t\t\t\t\tthis,\r\n\t\t\t\t\t\tthis,\r\n\t\t\t\t\t\tthis.getHostElement().shadowRoot!.querySelector('umb-router-slot')!,\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tpath: UMB_EDIT_DOCUMENT_WORKSPACE_PATH_PATTERN.toString(),\r\n\t\t\t\tcomponent: () => import('./document-blueprint-workspace-editor.element.js'),\r\n\t\t\t\tsetup: (_component, info) => {\r\n\t\t\t\t\tthis.removeUmbControllerByAlias(UmbWorkspaceIsNewRedirectControllerAlias);\r\n\t\t\t\t\tconst unique = info.match.params.unique;\r\n\t\t\t\t\tthis.load(unique);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t]);\r\n\t}\r\n\r\n\tasync create(parent: UmbEntityModel, documentTypeUnique: string) {\r\n\t\treturn this.createScaffold({\r\n\t\t\tparent,\r\n\t\t\tpreset: {\r\n\t\t\t\tdocumentType: {\r\n\t\t\t\t\tunique: documentTypeUnique,\r\n\t\t\t\t\tcollection: null,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\tgetCollectionAlias() {\r\n\t\treturn UMB_DOCUMENT_COLLECTION_ALIAS;\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the unique identifier of the content type.\r\n\t * @deprecated Use `getContentTypeUnique` instead.\r\n\t * @returns { string | undefined} The unique identifier of the content type.\r\n\t * @memberof UmbDocumentWorkspaceContext\r\n\t */\r\n\tgetContentTypeId(): string | undefined {\r\n\t\treturn this.getContentTypeUnique();\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the unique identifier of the content type.\r\n\t * @returns { string | undefined} The unique identifier of the content type.\r\n\t * @memberof UmbDocumentWorkspaceContext\r\n\t */\r\n\tgetContentTypeUnique(): string | undefined {\r\n\t\treturn this.getData()?.documentType.unique;\r\n\t}\r\n\r\n\tpublic createPropertyDatasetContext(\r\n\t\thost: UmbControllerHost,\r\n\t\tvariantId: UmbVariantId,\r\n\t): UmbDocumentBlueprintPropertyDatasetContext {\r\n\t\treturn new UmbDocumentBlueprintPropertyDatasetContext(host, this, variantId);\r\n\t}\r\n}\r\n\r\nexport { UmbDocumentBlueprintWorkspaceContext as api };\r\n"],"names":["UmbDocumentBlueprintPropertyDatasetContext","UmbContentPropertyDatasetContext","UmbDocumentBlueprintWorkspaceContext","UmbContentDetailWorkspaceContextBase","host","UMB_DOCUMENT_BLUEPRINT_ENTITY_TYPE","UMB_DOCUMENT_BLUEPRINT_WORKSPACE_ALIAS","UMB_DOCUMENT_BLUEPRINT_DETAIL_REPOSITORY_ALIAS","UmbDocumentTypeDetailRepository","UMB_DOCUMENT_DETAIL_MODEL_VARIANT_SCAFFOLD","data","unique","UMB_CREATE_DOCUMENT_BLUEPRINT_WORKSPACE_PATH_PATTERN","_component","info","parentEntityType","parentUnique","documentTypeUnique","UmbWorkspaceIsNewRedirectController","UMB_EDIT_DOCUMENT_WORKSPACE_PATH_PATTERN","UmbWorkspaceIsNewRedirectControllerAlias","parent","UMB_DOCUMENT_COLLECTION_ALIAS","variantId"],"mappings":";;;;;AAIO,MAAMA,UAAmDC,EAI9D;AAAC;ACoBI,MAAMC,UACJC,EAOT;AAAA,EAGC,YAAYC,GAAyB;AACpC,UAAMA,GAAM;AAAA,MACX,YAAYC;AAAA,MACZ,gBAAgBC;AAAA,MAChB,uBAAuBC;AAAA,MACvB,6BAA6BC;AAAA,MAC7B,wBAAwBC;AAAA,MACxB,yBAAyB;AAAA,IAAA,CACzB,GAVO,KAAA,oBAAoB,KAAK,MAAM,8BAA8B,CAACC,MAASA,GAAM,aAAa,MAAM,GAYnG,KAAA;AAAA,MACJ,KAAK;AAAA,MACL,CAACC,MAAW;AACX,QAAIA,KACE,KAAA,UAAU,SAASA,CAAM;AAAA,MAEhC;AAAA,MACA;AAAA,IACD,GAEA,KAAK,OAAO,UAAU;AAAA,MACrB;AAAA,QACC,MAAMC,EAAqD,SAAS;AAAA,QACpE,WAAW,MAAM,OAAO,2DAAkD;AAAA,QAC1E,OAAO,OAAOC,GAAYC,MAAS;AAC5B,gBAAAC,IAAmBD,EAAK,MAAM,OAAO,kBACrCE,IAAeF,EAAK,MAAM,OAAO,iBAAiB,SAAS,OAAOA,EAAK,MAAM,OAAO,cACpFG,IAAqBH,EAAK,MAAM,OAAO;AACvC,gBAAA,KAAK,OAAO,EAAE,YAAYC,GAAkB,QAAQC,KAAgBC,CAAkB,GAExF,IAAAC;AAAA,YACH;AAAA,YACA;AAAA,YACA,KAAK,eAAA,EAAiB,WAAY,cAAc,iBAAiB;AAAA,UAClE;AAAA,QAAA;AAAA,MAEF;AAAA,MACA;AAAA,QACC,MAAMC,EAAyC,SAAS;AAAA,QACxD,WAAW,MAAM,OAAO,2DAAkD;AAAA,QAC1E,OAAO,CAACN,GAAYC,MAAS;AAC5B,eAAK,2BAA2BM,CAAwC;AAClE,gBAAAT,IAASG,EAAK,MAAM,OAAO;AACjC,eAAK,KAAKH,CAAM;AAAA,QAAA;AAAA,MACjB;AAAA,IACD,CACA;AAAA,EAAA;AAAA,EAGF,MAAM,OAAOU,GAAwBJ,GAA4B;AAChE,WAAO,KAAK,eAAe;AAAA,MAC1B,QAAAI;AAAA,MACA,QAAQ;AAAA,QACP,cAAc;AAAA,UACb,QAAQJ;AAAA,UACR,YAAY;AAAA,QAAA;AAAA,MACb;AAAA,IACD,CACA;AAAA,EAAA;AAAA,EAGF,qBAAqB;AACb,WAAAK;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASR,mBAAuC;AACtC,WAAO,KAAK,qBAAqB;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQlC,uBAA2C;AACnC,WAAA,KAAK,WAAW,aAAa;AAAA,EAAA;AAAA,EAG9B,6BACNlB,GACAmB,GAC6C;AAC7C,WAAO,IAAIvB,EAA2CI,GAAM,MAAMmB,CAAS;AAAA,EAAA;AAE7E;"}