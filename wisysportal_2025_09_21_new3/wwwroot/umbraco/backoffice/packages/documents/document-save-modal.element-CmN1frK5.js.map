{"version":3,"file":"document-save-modal.element-CmN1frK5.js","sources":["../../../src/packages/documents/documents/modals/save-modal/document-save-modal.element.ts"],"sourcesContent":["import type { UmbDocumentVariantOptionModel } from '../../types.js';\r\nimport type { UmbDocumentSaveModalData, UmbDocumentSaveModalValue } from './document-save-modal.token.js';\r\nimport { css, customElement, html, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbSelectionManager } from '@umbraco-cms/backoffice/utils';\r\n\r\nimport '../shared/document-variant-language-picker.element.js';\r\n\r\n@customElement('umb-document-save-modal')\r\nexport class UmbDocumentSaveModalElement extends UmbModalBaseElement<\r\n\tUmbDocumentSaveModalData,\r\n\tUmbDocumentSaveModalValue\r\n> {\r\n\t#selectionManager = new UmbSelectionManager<string>(this);\r\n\r\n\t@state()\r\n\t_options: Array<UmbDocumentVariantOptionModel> = [];\r\n\r\n\t#pickableFilter = (option: UmbDocumentVariantOptionModel) => {\r\n\t\tif (!option.variant) {\r\n\t\t\t// If not data present, then its not pickable.\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn this.data?.pickableFilter ? this.data.pickableFilter(option) : true;\r\n\t};\r\n\r\n\toverride firstUpdated() {\r\n\t\tthis.#configureSelectionManager();\r\n\t}\r\n\r\n\tasync #configureSelectionManager() {\r\n\t\tthis.#selectionManager.setMultiple(true);\r\n\t\tthis.#selectionManager.setSelectable(true);\r\n\r\n\t\t// Only display variants that are relevant to pick from, i.e. variants that are draft or published with pending changes:\r\n\t\tthis._options = this.data?.options ?? [];\r\n\r\n\t\tlet selected = this.value?.selection ?? [];\r\n\r\n\t\tconst validOptions = this._options.filter((o) => this.#pickableFilter!(o));\r\n\r\n\t\t// Filter selection based on options:\r\n\t\tselected = selected.filter((s) => validOptions.some((o) => o.unique === s));\r\n\r\n\t\tthis.#selectionManager.setSelection(selected);\r\n\t}\r\n\r\n\t#submit() {\r\n\t\tthis.value = { selection: this.#selectionManager.getSelection() };\r\n\t\tthis.modalContext?.submit();\r\n\t}\r\n\r\n\t#close() {\r\n\t\tthis.modalContext?.reject();\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`<uui-dialog-layout headline=${this.localize.term('content_saveModalTitle')}>\r\n\t\t\t<umb-document-variant-language-picker\r\n\t\t\t\t.selectionManager=${this.#selectionManager}\r\n\t\t\t\t.variantLanguageOptions=${this._options}\r\n\t\t\t\t.pickableFilter=${this.#pickableFilter}></umb-document-variant-language-picker>\r\n\r\n\t\t\t<div slot=\"actions\">\r\n\t\t\t\t<uui-button label=${this.localize.term('general_close')} @click=${this.#close}></uui-button>\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tlabel=\"${this.localize.term('buttons_save')}\"\r\n\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t@click=${this.#submit}></uui-button>\r\n\t\t\t</div>\r\n\t\t</uui-dialog-layout> `;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\twidth: 400px;\r\n\t\t\t\tmax-width: 90vw;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbDocumentSaveModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-document-save-modal': UmbDocumentSaveModalElement;\r\n\t}\r\n}\r\n"],"names":["_selectionManager","_pickableFilter","_UmbDocumentSaveModalElement_instances","configureSelectionManager_fn","submit_fn","close_fn","UmbDocumentSaveModalElement","UmbModalBaseElement","__privateAdd","UmbSelectionManager","option","__privateMethod","html","__privateGet","selected","validOptions","o","s","UmbTextStyles","css","__decorateClass","state","customElement","UmbDocumentSaveModalElement$1"],"mappings":";;;;;;;;;;;+TAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAUa,IAAAC,IAAN,cAA0CC,EAG/C;AAAA,EAHK,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAN,CAAA,GAIcM,EAAA,MAAAR,GAAA,IAAIS,EAA4B,IAAI,CAAA,GAGxD,KAAA,WAAiD,CAAC,GAElDD,EAAA,MAAAP,GAAkB,CAACS,MACbA,EAAO,UAIL,KAAK,MAAM,iBAAiB,KAAK,KAAK,eAAeA,CAAM,IAAI,KAF9D,EAGT;AAAA,EAAA;AAAA,EAES,eAAe;AACvB,IAAAC,EAAA,MAAKT,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,EAAA;AAAA,EA6BQ,SAAS;AACjB,WAAOS,gCAAmC,KAAK,SAAS,KAAK,wBAAwB,CAAC;AAAA;AAAA,wBAEhEC,QAAKb,CAAiB,CAAA;AAAA,8BAChB,KAAK,QAAQ;AAAA,sBACrBa,QAAKZ,CAAe,CAAA;AAAA;AAAA;AAAA,wBAGlB,KAAK,SAAS,KAAK,eAAe,CAAC,WAAWU,QAAKT,GAAMG,CAAA,CAAA;AAAA;AAAA,cAEnE,KAAK,SAAS,KAAK,cAAc,CAAC;AAAA;AAAA;AAAA,cAGlCM,QAAKT,GAAOE,CAAA,CAAA;AAAA;AAAA;AAAA,EAAA;AAe1B;AAvECJ,IAAA,oBAAA,QAAA;AAKAC,IAAA,oBAAA,QAAA;AATMC,IAAA,oBAAA,QAAA;AAqBAC,IAA0B,iBAAG;AAC7B,EAAAU,EAAA,MAAAb,CAAA,EAAkB,YAAY,EAAI,GAClCa,EAAA,MAAAb,CAAA,EAAkB,cAAc,EAAI,GAGzC,KAAK,WAAW,KAAK,MAAM,WAAW,CAAC;AAEvC,MAAIc,IAAW,KAAK,OAAO,aAAa,CAAC;AAEnC,QAAAC,IAAe,KAAK,SAAS,OAAO,CAACC,MAAMH,EAAA,MAAKZ,CAAL,EAAA,KAAA,MAAsBe,CAAE,CAAA;AAG9D,EAAAF,IAAAA,EAAS,OAAO,CAACG,MAAMF,EAAa,KAAK,CAACC,MAAMA,EAAE,WAAWC,CAAC,CAAC,GAErEJ,EAAA,MAAAb,CAAA,EAAkB,aAAac,CAAQ;AAC7C;AAEAV,IAAO,WAAG;AACT,OAAK,QAAQ,EAAE,WAAWS,EAAK,MAAAb,CAAA,EAAkB,eAAe,GAChE,KAAK,cAAc,OAAO;AAC3B;AAEAK,IAAM,WAAG;AACR,OAAK,cAAc,OAAO;AAC3B;AA7CYC,EAiEI,SAAS;AAAA,EACxBY;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOD;AAnEAC,EAAA;AAAA,EADCC,EAAM;AAAA,GANKf,EAOZ,WAAA,YAAA,CAAA;AAPYA,IAANc,EAAA;AAAA,EADNE,EAAc,yBAAyB;AAAA,GAC3BhB,CAAA;AA6Eb,MAAAiB,IAAejB;"}