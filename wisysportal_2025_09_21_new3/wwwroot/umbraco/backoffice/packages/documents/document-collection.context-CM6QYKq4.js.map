{"version":3,"file":"document-collection.context-CM6QYKq4.js","sources":["../../../src/packages/documents/documents/collection/document-collection.context.ts"],"sourcesContent":["import type { UmbDocumentCollectionFilterModel, UmbDocumentCollectionItemModel } from './types.js';\r\nimport { UMB_DOCUMENT_TABLE_COLLECTION_VIEW_ALIAS } from './constants.js';\r\nimport { UmbDefaultCollectionContext } from '@umbraco-cms/backoffice/collection';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UMB_VARIANT_CONTEXT } from '@umbraco-cms/backoffice/variant';\r\nimport { UmbStringState } from '@umbraco-cms/backoffice/observable-api';\r\n\r\nexport class UmbDocumentCollectionContext extends UmbDefaultCollectionContext<\r\n\tUmbDocumentCollectionItemModel,\r\n\tUmbDocumentCollectionFilterModel\r\n> {\r\n\t#variantContext?: typeof UMB_VARIANT_CONTEXT.TYPE;\r\n\t#displayCulture = new UmbStringState(undefined);\r\n\t#displayCultureObservable = this.#displayCulture.asObservable();\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, UMB_DOCUMENT_TABLE_COLLECTION_VIEW_ALIAS);\r\n\r\n\t\tthis.consumeContext(UMB_VARIANT_CONTEXT, async (variantContext) => {\r\n\t\t\tthis.#variantContext = variantContext;\r\n\t\t\tthis.#observeDisplayCulture();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeDisplayCulture() {\r\n\t\tthis.observe(\r\n\t\t\tthis.#variantContext?.displayCulture,\r\n\t\t\t(displayCulture) => {\r\n\t\t\t\tif (!displayCulture) return;\r\n\t\t\t\tif (this.#displayCulture.getValue() === displayCulture) return;\r\n\t\t\t\tthis.#displayCulture.setValue(displayCulture);\r\n\t\t\t\tthis.setFilter({ orderCulture: displayCulture });\r\n\t\t\t},\r\n\t\t\t'umbDocumentCollectionDisplayCultureObserver',\r\n\t\t);\r\n\t}\r\n\r\n\tpublic override async requestCollection() {\r\n\t\tawait this.observe(this.#displayCultureObservable)?.asPromise();\r\n\t\tawait super.requestCollection();\r\n\t}\r\n}\r\n\r\nexport { UmbDocumentCollectionContext as api };\r\n"],"names":["UmbDocumentCollectionContext","UmbDefaultCollectionContext","#variantContext","#displayCulture","UmbStringState","#displayCultureObservable","host","UMB_DOCUMENT_TABLE_COLLECTION_VIEW_ALIAS","UMB_VARIANT_CONTEXT","variantContext","#observeDisplayCulture","displayCulture"],"mappings":";;;;AAOO,MAAMA,UAAqCC,EAGhD;AAAA,EACDC;AAAA,EACAC,KAAkB,IAAIC,EAAe,MAAS;AAAA,EAC9CC,KAA4B,KAAKF,GAAgB,aAAa;AAAA,EAE9D,YAAYG,GAAyB;AACpC,UAAMA,GAAMC,CAAwC,GAE/C,KAAA,eAAeC,GAAqB,OAAOC,MAAmB;AAClE,WAAKP,KAAkBO,GACvB,KAAKC,GAAuB;AAAA,IAAA,CAC5B;AAAA,EAAA;AAAA,EAGFA,KAAyB;AACnB,SAAA;AAAA,MACJ,KAAKR,IAAiB;AAAA,MACtB,CAACS,MAAmB;AACnB,QAAKA,KACD,KAAKR,GAAgB,SAAS,MAAMQ,MACnC,KAAAR,GAAgB,SAASQ,CAAc,GAC5C,KAAK,UAAU,EAAE,cAAcA,EAAA,CAAgB;AAAA,MAChD;AAAA,MACA;AAAA,IACD;AAAA,EAAA;AAAA,EAGD,MAAsB,oBAAoB;AACzC,UAAM,KAAK,QAAQ,KAAKN,EAAyB,GAAG,UAAU,GAC9D,MAAM,MAAM,kBAAkB;AAAA,EAAA;AAEhC;"}