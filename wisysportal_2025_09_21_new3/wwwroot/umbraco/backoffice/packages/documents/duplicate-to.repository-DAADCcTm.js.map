{"version":3,"file":"duplicate-to.repository-DAADCcTm.js","sources":["../../../src/packages/documents/documents/entity-bulk-actions/duplicate-to/repository/duplicate-to.repository.ts"],"sourcesContent":["import { UmbDuplicateDocumentServerDataSource } from '../../../entity-actions/duplicate/repository/document-duplicate.server.data-source.js';\r\nimport type { UmbBulkDuplicateToDocumentRequestArgs } from './types.js';\r\nimport { UmbRepositoryBase } from '@umbraco-cms/backoffice/repository';\r\nimport { UMB_NOTIFICATION_CONTEXT } from '@umbraco-cms/backoffice/notification';\r\nimport type { UmbBulkDuplicateToRepository } from '@umbraco-cms/backoffice/entity-bulk-action';\r\nimport type { UmbRepositoryErrorResponse } from '@umbraco-cms/backoffice/repository';\r\n\r\nexport class UmbBulkDuplicateToDocumentRepository extends UmbRepositoryBase implements UmbBulkDuplicateToRepository {\r\n\t#duplicateSource = new UmbDuplicateDocumentServerDataSource(this);\r\n\r\n\tasync requestBulkDuplicateTo(args: UmbBulkDuplicateToDocumentRequestArgs): Promise<UmbRepositoryErrorResponse> {\r\n\t\tlet count = 0;\r\n\r\n\t\tconst notificationContext = await this.getContext(UMB_NOTIFICATION_CONTEXT);\r\n\r\n\t\tfor (const unique of args.uniques) {\r\n\t\t\tconst { error } = await this.#duplicateSource.duplicate({\r\n\t\t\t\tunique,\r\n\t\t\t\tdestination: args.destination,\r\n\t\t\t\trelateToOriginal: args.relateToOriginal,\r\n\t\t\t\tincludeDescendants: args.includeDescendants,\r\n\t\t\t});\r\n\r\n\t\t\tif (error) {\r\n\t\t\t\tconst notification = { data: { message: error.message } };\r\n\t\t\t\tnotificationContext?.peek('danger', notification);\r\n\t\t\t} else {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (count > 0) {\r\n\t\t\tconst notification = { data: { message: `Duplicated ${count} ${count === 1 ? 'document' : 'documents'}` } };\r\n\t\t\tnotificationContext?.peek('positive', notification);\r\n\t\t}\r\n\r\n\t\treturn {};\r\n\t}\r\n}\r\n\r\nexport { UmbBulkDuplicateToDocumentRepository as api };\r\n"],"names":["UmbBulkDuplicateToDocumentRepository","UmbRepositoryBase","#duplicateSource","UmbDuplicateDocumentServerDataSource","args","count","notificationContext","UMB_NOTIFICATION_CONTEXT","unique","error","notification"],"mappings":";;;AAOO,MAAMA,UAA6CC,EAA0D;AAAA,EACnHC,KAAmB,IAAIC,EAAqC,IAAI;AAAA,EAEhE,MAAM,uBAAuBC,GAAkF;AAC9G,QAAIC,IAAQ;AAEZ,UAAMC,IAAsB,MAAM,KAAK,WAAWC,CAAwB;AAE/D,eAAAC,KAAUJ,EAAK,SAAS;AAClC,YAAM,EAAE,OAAAK,EAAM,IAAI,MAAM,KAAKP,GAAiB,UAAU;AAAA,QACvD,QAAAM;AAAA,QACA,aAAaJ,EAAK;AAAA,QAClB,kBAAkBA,EAAK;AAAA,QACvB,oBAAoBA,EAAK;AAAA,MAAA,CACzB;AAED,UAAIK,GAAO;AACV,cAAMC,IAAe,EAAE,MAAM,EAAE,SAASD,EAAM,UAAU;AACnC,QAAAH,GAAA,KAAK,UAAUI,CAAY;AAAA,MAAA;AAEhD,QAAAL;AAAA,IACD;AAGD,QAAIA,IAAQ,GAAG;AACd,YAAMK,IAAe,EAAE,MAAM,EAAE,SAAS,cAAcL,CAAK,IAAIA,MAAU,IAAI,aAAa,WAAW,KAAK;AACrF,MAAAC,GAAA,KAAK,YAAYI,CAAY;AAAA,IAAA;AAGnD,WAAO,CAAC;AAAA,EAAA;AAEV;"}