{"version":3,"file":"document-type-workspace-view-templates.element-BMZId_af.js","sources":["../../../src/packages/documents/document-types/workspace/document-type/views/templates/document-type-workspace-view-templates.element.ts"],"sourcesContent":["import type { UmbDocumentTypeWorkspaceContext } from '../../document-type-workspace.context.js';\r\nimport { UMB_DOCUMENT_TYPE_WORKSPACE_CONTEXT } from '../../document-type-workspace.context-token.js';\r\nimport type { UmbInputTemplateElement } from '@umbraco-cms/backoffice/template';\r\nimport { css, html, customElement, state, when } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbWorkspaceViewElement } from '@umbraco-cms/backoffice/workspace';\r\n\r\nimport '@umbraco-cms/backoffice/template'; // TODO: This is needed to register the <umb-input-template> element, but it should be done in a better way without importing the whole module.\r\n\r\n@customElement('umb-document-type-workspace-view-templates')\r\nexport class UmbDocumentTypeWorkspaceViewTemplatesElement extends UmbLitElement implements UmbWorkspaceViewElement {\r\n\t#workspaceContext?: UmbDocumentTypeWorkspaceContext;\r\n\r\n\t@state()\r\n\tprivate _isElementType = false;\r\n\r\n\t@state()\r\n\tprivate _defaultTemplateId: string | null = null;\r\n\r\n\t@state()\r\n\tprivate _allowedTemplateIds?: Array<string>;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.consumeContext(UMB_DOCUMENT_TYPE_WORKSPACE_CONTEXT, (documentTypeContext) => {\r\n\t\t\tthis.#workspaceContext = documentTypeContext as UmbDocumentTypeWorkspaceContext;\r\n\t\t\tthis._observeDocumentType();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _observeDocumentType() {\r\n\t\tif (!this.#workspaceContext) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.isElement,\r\n\t\t\t(isElement) => {\r\n\t\t\t\tthis._isElementType = isElement ?? false;\r\n\t\t\t},\r\n\t\t\t'_observeIsElement',\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.defaultTemplate,\r\n\t\t\t(defaultTemplate) => {\r\n\t\t\t\tconst oldValue = this._defaultTemplateId;\r\n\t\t\t\tthis._defaultTemplateId = defaultTemplate ? defaultTemplate.id : null;\r\n\t\t\t\tthis.requestUpdate('_defaultTemplateId', oldValue);\r\n\t\t\t},\r\n\t\t\t'_observeDefaultTemplate',\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.allowedTemplateIds,\r\n\t\t\t(allowedTemplateIds) => {\r\n\t\t\t\tconst oldValue = this._allowedTemplateIds;\r\n\t\t\t\tthis._allowedTemplateIds = allowedTemplateIds?.map((template) => template.id);\r\n\t\t\t\tthis.requestUpdate('_allowedTemplateIds', oldValue);\r\n\t\t\t},\r\n\t\t\t'_observeAllowedTemplateIds',\r\n\t\t);\r\n\t}\r\n\r\n\t#templateInputChange(e: CustomEvent) {\r\n\t\t// save new allowed ids\r\n\t\tconst input = e.target as UmbInputTemplateElement;\r\n\t\tconst idsWithoutRoot =\r\n\t\t\tinput.selection\r\n\t\t\t\t?.filter((id) => id !== null)\r\n\t\t\t\t.map((id) => {\r\n\t\t\t\t\treturn { id };\r\n\t\t\t\t}) ?? [];\r\n\t\tthis.#workspaceContext?.setAllowedTemplateIds(idsWithoutRoot);\r\n\t\tthis.#workspaceContext?.setDefaultTemplate(input.defaultUnique ? { id: input.defaultUnique } : null);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn this._isElementType ? this.#renderUnsupported() : this.#renderTemplates();\r\n\t}\r\n\r\n\t#renderUnsupported() {\r\n\t\treturn html`\r\n\t\t\t<div class=\"empty-state\">\r\n\t\t\t\t<h2>\r\n\t\t\t\t\t<umb-localize key=\"contentTypeEditor_elementDoesNotSupport\">\r\n\t\t\t\t\t\tThis is not applicable for an Element type.\r\n\t\t\t\t\t</umb-localize>\r\n\t\t\t\t</h2>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderTemplates() {\r\n\t\treturn html`\r\n\t\t\t<uui-box headline=${this.localize.term('treeHeaders_templates')}>\r\n\t\t\t\t${when(\r\n\t\t\t\t\tthis.#workspaceContext?.createTemplateMode,\r\n\t\t\t\t\t() => html`<p><em>The default template will be created once this document type has been saved.</em></p>`,\r\n\t\t\t\t)}\r\n\t\t\t\t<umb-property-layout alias=\"Templates\" label=${this.localize.term('contentTypeEditor_allowedTemplatesHeading')}>\r\n\t\t\t\t\t<div slot=\"description\">${this.localize.term('contentTypeEditor_allowedTemplatesDescription')}</div>\r\n\t\t\t\t\t<div id=\"templates\" slot=\"editor\">\r\n\t\t\t\t\t\t<umb-input-template\r\n\t\t\t\t\t\t\t.defaultUnique=${this._defaultTemplateId ?? ''}\r\n\t\t\t\t\t\t\t.selection=${this._allowedTemplateIds}\r\n\t\t\t\t\t\t\t@change=${this.#templateInputChange}>\r\n\t\t\t\t\t\t</umb-input-template>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tpadding: var(--uui-size-layout-1);\r\n\t\t\t}\r\n\r\n\t\t\t#templates {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t}\r\n\r\n\t\t\t#template-card-wrapper {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t\talign-items: stretch;\r\n\t\t\t}\r\n\r\n\t\t\tumb-property-layout {\r\n\t\t\t\tborder-top: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\t\t\tumb-property-layout:first-child {\r\n\t\t\t\tpadding-top: 0;\r\n\t\t\t\tborder: none;\r\n\t\t\t}\r\n\t\t\t.empty-state {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-around;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\t\t\t.empty-state h2 {\r\n\t\t\t\tcolor: var(--uui-color-border-emphasis);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbDocumentTypeWorkspaceViewTemplatesElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-document-type-workspace-view-templates': UmbDocumentTypeWorkspaceViewTemplatesElement;\r\n\t}\r\n}\r\n"],"names":["_workspaceContext","_UmbDocumentTypeWorkspaceViewTemplatesElement_instances","templateInputChange_fn","renderUnsupported_fn","renderTemplates_fn","UmbDocumentTypeWorkspaceViewTemplatesElement","UmbLitElement","__privateAdd","UMB_DOCUMENT_TYPE_WORKSPACE_CONTEXT","documentTypeContext","__privateSet","__privateGet","isElement","defaultTemplate","oldValue","allowedTemplateIds","template","__privateMethod","input","idsWithoutRoot","id","html","when","UmbTextStyles","css","__decorateClass","state","customElement","UmbDocumentTypeWorkspaceViewTemplatesElement$1"],"mappings":"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"}