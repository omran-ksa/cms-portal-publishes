{"version":3,"file":"style-menu.tiptap-toolbar-api-h6DTODfp.js","sources":["../../../src/packages/tiptap/components/toolbar/style-menu.tiptap-toolbar-api.ts"],"sourcesContent":["import { UmbTiptapToolbarElementApiBase } from '../../extensions/base.js';\r\nimport type { MetaTiptapToolbarStyleMenuItem } from '../../extensions/types.js';\r\nimport type { ChainedCommands, Editor } from '@umbraco-cms/backoffice/external/tiptap';\r\n\r\ntype UmbTiptapToolbarStyleMenuCommandType = {\r\n\ttype: string;\r\n\tcommand: (chain: ChainedCommands) => ChainedCommands;\r\n\tisActive?: (editor?: Editor) => boolean | undefined;\r\n};\r\n\r\nexport default class UmbTiptapToolbarStyleMenuApi extends UmbTiptapToolbarElementApiBase {\r\n\t#headingCommand(level: 1 | 2 | 3 | 4 | 5 | 6): UmbTiptapToolbarStyleMenuCommandType {\r\n\t\treturn {\r\n\t\t\ttype: 'heading',\r\n\t\t\tcommand: (chain) => chain.toggleHeading({ level }),\r\n\t\t\tisActive: (editor) => editor?.isActive('heading', { level }),\r\n\t\t};\r\n\t}\r\n\r\n\t#commands: Record<string, UmbTiptapToolbarStyleMenuCommandType> = {\r\n\t\th1: this.#headingCommand(1),\r\n\t\th2: this.#headingCommand(2),\r\n\t\th3: this.#headingCommand(3),\r\n\t\th4: this.#headingCommand(4),\r\n\t\th5: this.#headingCommand(5),\r\n\t\th6: this.#headingCommand(6),\r\n\t\tp: { type: 'paragraph', command: (chain) => chain.setParagraph() },\r\n\t\tblockquote: { type: 'blockquote', command: (chain) => chain.toggleBlockquote() },\r\n\t\tcode: { type: 'code', command: (chain) => chain.toggleCode() },\r\n\t\tcodeBlock: { type: 'codeBlock', command: (chain) => chain.toggleCodeBlock() },\r\n\t\tdiv: { type: 'div', command: (chain) => chain.toggleNode('div', 'paragraph') },\r\n\t\tem: { type: 'italic', command: (chain) => chain.toggleItalic() },\r\n\t\tol: { type: 'orderedList', command: (chain) => chain.toggleOrderedList() },\r\n\t\tstrong: { type: 'bold', command: (chain) => chain.toggleBold() },\r\n\t\ts: { type: 'strike', command: (chain) => chain.toggleStrike() },\r\n\t\tspan: { type: 'span', command: (chain) => chain.toggleMark('span') },\r\n\t\tu: { type: 'underline', command: (chain) => chain.toggleUnderline() },\r\n\t\tul: { type: 'bulletList', command: (chain) => chain.toggleBulletList() },\r\n\t};\r\n\r\n\toverride isActive(editor?: Editor, item?: MetaTiptapToolbarStyleMenuItem) {\r\n\t\tif (!editor || !item?.data) return false;\r\n\r\n\t\tconst { tag, id, class: className } = item.data;\r\n\t\tconst ext = tag ? this.#commands[tag] : null;\r\n\t\tconst attrs = editor?.getAttributes(ext?.type ?? 'paragraph');\r\n\r\n\t\tconst tagMatch = !tag ? true : ext ? (ext.isActive?.(editor) ?? editor?.isActive(ext.type) ?? false) : false;\r\n\t\tconst idMatch = !id ? true : attrs.id === id;\r\n\t\tconst classMatch = !className ? true : attrs.class?.includes(className) === true;\r\n\r\n\t\treturn tagMatch && idMatch && classMatch;\r\n\t}\r\n\r\n\toverride execute(editor?: Editor, item?: MetaTiptapToolbarStyleMenuItem) {\r\n\t\tif (!editor || !item?.data) return;\r\n\t\tconst { tag, id, class: className } = item.data;\r\n\t\tconst focus = editor.chain().focus();\r\n\t\tconst ext = tag ? this.#commands[tag] : null;\r\n\t\t(ext?.command?.(focus) ?? focus).toggleId(id, ext?.type).toggleClassName(className, ext?.type).run();\r\n\t}\r\n}\r\n"],"names":["UmbTiptapToolbarStyleMenuApi","UmbTiptapToolbarElementApiBase","#headingCommand","level","chain","editor","#commands","item","tag","id","className","ext","attrs","tagMatch","idMatch","classMatch","focus"],"mappings":";AAUA,MAAqBA,UAAqCC,EAA+B;AAAA,EACxFC,GAAgBC,GAAoE;AAC5E,WAAA;AAAA,MACN,MAAM;AAAA,MACN,SAAS,CAACC,MAAUA,EAAM,cAAc,EAAE,OAAAD,GAAO;AAAA,MACjD,UAAU,CAACE,MAAWA,GAAQ,SAAS,WAAW,EAAE,OAAAF,EAAO,CAAA;AAAA,IAC5D;AAAA,EAAA;AAAA,EAGDG,KAAkE;AAAA,IACjE,IAAI,KAAKJ,GAAgB,CAAC;AAAA,IAC1B,IAAI,KAAKA,GAAgB,CAAC;AAAA,IAC1B,IAAI,KAAKA,GAAgB,CAAC;AAAA,IAC1B,IAAI,KAAKA,GAAgB,CAAC;AAAA,IAC1B,IAAI,KAAKA,GAAgB,CAAC;AAAA,IAC1B,IAAI,KAAKA,GAAgB,CAAC;AAAA,IAC1B,GAAG,EAAE,MAAM,aAAa,SAAS,CAACE,MAAUA,EAAM,eAAe;AAAA,IACjE,YAAY,EAAE,MAAM,cAAc,SAAS,CAACA,MAAUA,EAAM,mBAAmB;AAAA,IAC/E,MAAM,EAAE,MAAM,QAAQ,SAAS,CAACA,MAAUA,EAAM,aAAa;AAAA,IAC7D,WAAW,EAAE,MAAM,aAAa,SAAS,CAACA,MAAUA,EAAM,kBAAkB;AAAA,IAC5E,KAAK,EAAE,MAAM,OAAO,SAAS,CAACA,MAAUA,EAAM,WAAW,OAAO,WAAW,EAAE;AAAA,IAC7E,IAAI,EAAE,MAAM,UAAU,SAAS,CAACA,MAAUA,EAAM,eAAe;AAAA,IAC/D,IAAI,EAAE,MAAM,eAAe,SAAS,CAACA,MAAUA,EAAM,oBAAoB;AAAA,IACzE,QAAQ,EAAE,MAAM,QAAQ,SAAS,CAACA,MAAUA,EAAM,aAAa;AAAA,IAC/D,GAAG,EAAE,MAAM,UAAU,SAAS,CAACA,MAAUA,EAAM,eAAe;AAAA,IAC9D,MAAM,EAAE,MAAM,QAAQ,SAAS,CAACA,MAAUA,EAAM,WAAW,MAAM,EAAE;AAAA,IACnE,GAAG,EAAE,MAAM,aAAa,SAAS,CAACA,MAAUA,EAAM,kBAAkB;AAAA,IACpE,IAAI,EAAE,MAAM,cAAc,SAAS,CAACA,MAAUA,EAAM,iBAAmB,EAAA;AAAA,EACxE;AAAA,EAES,SAASC,GAAiBE,GAAuC;AACzE,QAAI,CAACF,KAAU,CAACE,GAAM,KAAa,QAAA;AAEnC,UAAM,EAAE,KAAAC,GAAK,IAAAC,GAAI,OAAOC,EAAA,IAAcH,EAAK,MACrCI,IAAMH,IAAM,KAAKF,GAAUE,CAAG,IAAI,MAClCI,IAAQP,GAAQ,cAAcM,GAAK,QAAQ,WAAW,GAEtDE,IAAYL,IAAaG,IAAOA,EAAI,WAAWN,CAAM,KAAKA,GAAQ,SAASM,EAAI,IAAI,KAAK,KAAS,KAA/E,IAClBG,IAAWL,IAAYG,EAAM,OAAOH,IAApB,IAChBM,IAAcL,IAAmBE,EAAM,OAAO,SAASF,CAAS,MAAM,KAA5C;AAEhC,WAAOG,KAAYC,KAAWC;AAAA,EAAA;AAAA,EAGtB,QAAQV,GAAiBE,GAAuC;AACxE,QAAI,CAACF,KAAU,CAACE,GAAM,KAAM;AAC5B,UAAM,EAAE,KAAAC,GAAK,IAAAC,GAAI,OAAOC,EAAA,IAAcH,EAAK,MACrCS,IAAQX,EAAO,MAAM,EAAE,MAAM,GAC7BM,IAAMH,IAAM,KAAKF,GAAUE,CAAG,IAAI;AACxC,KAACG,GAAK,UAAUK,CAAK,KAAKA,GAAO,SAASP,GAAIE,GAAK,IAAI,EAAE,gBAAgBD,GAAWC,GAAK,IAAI,EAAE,IAAI;AAAA,EAAA;AAErG;"}