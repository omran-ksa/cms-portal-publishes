{"version":3,"file":"media-type-workspace-view-structure.element-Cjtb2TxK.js","sources":["../../../src/packages/media/media-types/workspace/views/structure/media-type-workspace-view-structure.element.ts"],"sourcesContent":["import type { UmbMediaTypeWorkspaceContext } from '../../media-type-workspace.context.js';\r\nimport type { UmbInputMediaTypeElement } from '../../../components/input-media-type/input-media-type.element.js';\r\nimport { UMB_MEDIA_TYPE_WORKSPACE_CONTEXT } from '../../media-type-workspace.context-token.js';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type {\r\n\tUmbContentTypeSortModel,\r\n\tUmbInputContentTypeCollectionConfigurationElement,\r\n} from '@umbraco-cms/backoffice/content-type';\r\nimport type { UmbWorkspaceViewElement } from '@umbraco-cms/backoffice/workspace';\r\nimport type { UUIToggleElement } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n@customElement('umb-media-type-workspace-view-structure')\r\nexport class UmbMediaTypeWorkspaceViewStructureElement extends UmbLitElement implements UmbWorkspaceViewElement {\r\n\t#workspaceContext?: UmbMediaTypeWorkspaceContext;\r\n\r\n\t@state()\r\n\tprivate _allowedAtRoot?: boolean;\r\n\r\n\t@state()\r\n\tprivate _allowedContentTypeIDs?: Array<string>;\r\n\r\n\t@state()\r\n\tprivate _collection?: string;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\t// TODO: Figure out if this is the best way to consume the context or if it can be strongly typed with an UmbContextToken\r\n\t\tthis.consumeContext(UMB_MEDIA_TYPE_WORKSPACE_CONTEXT, (context) => {\r\n\t\t\tthis.#workspaceContext = context;\r\n\t\t\tthis._observeMediaType();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _observeMediaType() {\r\n\t\tif (!this.#workspaceContext) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.allowedAtRoot,\r\n\t\t\t(allowedAtRoot) => (this._allowedAtRoot = allowedAtRoot),\r\n\t\t\t'_allowedAtRootObserver',\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.allowedContentTypes,\r\n\t\t\t(allowedContentTypes) => {\r\n\t\t\t\tconst oldValue = this._allowedContentTypeIDs;\r\n\t\t\t\tthis._allowedContentTypeIDs = allowedContentTypes\r\n\t\t\t\t\t?.map((x) => x.contentType.unique)\r\n\t\t\t\t\t.filter((x) => x !== undefined) as Array<string>;\r\n\t\t\t\tthis.requestUpdate('_allowedContentTypeIDs', oldValue);\r\n\t\t\t},\r\n\t\t\t'_allowedContentTypesObserver',\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.collection,\r\n\t\t\t(collection) => {\r\n\t\t\t\tthis._collection = collection?.unique;\r\n\t\t\t},\r\n\t\t\t'_collectionObserver',\r\n\t\t);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<uui-box headline=${this.localize.term('contentTypeEditor_structure')}>\r\n\t\t\t\t<umb-property-layout alias=\"Root\" label=${this.localize.term('contentTypeEditor_allowAtRootHeading')}>\r\n\t\t\t\t\t<div slot=\"description\">${this.localize.term('contentTypeEditor_allowAtRootDescription')}</div>\r\n\t\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t\t<uui-toggle\r\n\t\t\t\t\t\t\tlabel=${this.localize.term('contentTypeEditor_allowAtRootHeading')}\r\n\t\t\t\t\t\t\t?checked=${this._allowedAtRoot}\r\n\t\t\t\t\t\t\t@change=${(e: CustomEvent) => {\r\n\t\t\t\t\t\t\t\tthis.#workspaceContext?.setAllowedAtRoot((e.target as UUIToggleElement).checked);\r\n\t\t\t\t\t\t\t}}></uui-toggle>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t\t<umb-property-layout alias=\"ChildNodeType\" label=${this.localize.term('contentTypeEditor_childNodesHeading')}>\r\n\t\t\t\t\t<div slot=\"description\">${this.localize.term('contentTypeEditor_childNodesDescription')}</div>\r\n\t\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t\t<!-- TODO: maybe we want to somehow display the hierarchy, but not necessary in the same way as old backoffice? -->\r\n\t\t\t\t\t\t<umb-input-media-type\r\n\t\t\t\t\t\t\t.selection=${this._allowedContentTypeIDs ?? []}\r\n\t\t\t\t\t\t\t@change=\"${(e: CustomEvent & { target: UmbInputMediaTypeElement }) => {\r\n\t\t\t\t\t\t\t\tconst sortedContentTypesList: Array<UmbContentTypeSortModel> = e.target.selection.map((id, index) => ({\r\n\t\t\t\t\t\t\t\t\tcontentType: { unique: id },\r\n\t\t\t\t\t\t\t\t\tsortOrder: index,\r\n\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\tthis.#workspaceContext?.setAllowedContentTypes(sortedContentTypesList);\r\n\t\t\t\t\t\t\t}}\">\r\n\t\t\t\t\t\t</umb-input-media-type>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t</uui-box>\r\n\t\t\t<uui-box headline=${this.localize.term('contentTypeEditor_presentation')}>\r\n\t\t\t\t<umb-property-layout alias=\"collection\" label=\"${this.localize.term('contentTypeEditor_collections')}\">\r\n\t\t\t\t\t<div slot=\"description\">${this.localize.term('contentTypeEditor_collectionsDescription')}</div>\r\n\t\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t\t<umb-input-content-type-collection-configuration\r\n\t\t\t\t\t\t\tdefault-value=\"3a0156c4-3b8c-4803-bdc1-6871faa83fff\"\r\n\t\t\t\t\t\t\t.value=${this._collection}\r\n\t\t\t\t\t\t\t@change=${(e: CustomEvent) => {\r\n\t\t\t\t\t\t\t\tconst unique = (e.target as UmbInputContentTypeCollectionConfigurationElement).value as string;\r\n\t\t\t\t\t\t\t\tthis.#workspaceContext?.setCollection({ unique });\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t</umb-input-content-type-collection-configuration>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tmargin: var(--uui-size-layout-1);\r\n\t\t\t\tpadding-bottom: var(--uui-size-layout-1); // To enforce some distance to the bottom of the scroll-container.\r\n\t\t\t}\r\n\t\t\tuui-box {\r\n\t\t\t\tmargin-top: var(--uui-size-layout-1);\r\n\t\t\t}\r\n\t\t\tuui-label,\r\n\t\t\tumb-property-editor-ui-number {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\r\n\t\t\t// TODO: is this necessary?\r\n\t\t\tuui-toggle {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbMediaTypeWorkspaceViewStructureElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-media-type-workspace-view-structure': UmbMediaTypeWorkspaceViewStructureElement;\r\n\t}\r\n}\r\n"],"names":["_workspaceContext","UmbMediaTypeWorkspaceViewStructureElement","UmbLitElement","__privateAdd","UMB_MEDIA_TYPE_WORKSPACE_CONTEXT","context","__privateSet","__privateGet","allowedAtRoot","allowedContentTypes","oldValue","x","collection","html","sortedContentTypesList","id","index","unique","UmbTextStyles","css","__decorateClass","state","customElement","UmbMediaTypeWorkspaceViewStructureElement$1"],"mappings":"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"}