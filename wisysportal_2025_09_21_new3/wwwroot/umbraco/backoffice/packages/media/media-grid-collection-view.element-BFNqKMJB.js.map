{"version":3,"file":"media-grid-collection-view.element-BFNqKMJB.js","sources":["../../../src/packages/media/media/collection/views/grid/media-grid-collection-view.element.ts"],"sourcesContent":["import { UMB_EDIT_MEDIA_WORKSPACE_PATH_PATTERN } from '../../../paths.js';\r\nimport type { UmbMediaCollectionItemModel } from '../../types.js';\r\nimport type { UmbMediaCollectionContext } from '../../media-collection.context.js';\r\nimport { UMB_MEDIA_COLLECTION_CONTEXT } from '../../media-collection.context-token.js';\r\nimport { UMB_MEDIA_PLACEHOLDER_ENTITY_TYPE } from '../../../entity.js';\r\nimport { css, customElement, html, ifDefined, repeat, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbFileDropzoneItemStatus } from '@umbraco-cms/backoffice/dropzone';\r\n\r\nimport '@umbraco-cms/backoffice/imaging';\r\nimport type { UmbModalRouteBuilder } from '@umbraco-cms/backoffice/router';\r\n\r\n@customElement('umb-media-grid-collection-view')\r\nexport class UmbMediaGridCollectionViewElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _workspacePathBuilder?: UmbModalRouteBuilder;\r\n\r\n\t@state()\r\n\tprivate _items: Array<UmbMediaCollectionItemModel> = [];\r\n\r\n\t@state()\r\n\tprivate _selection: Array<string | null> = [];\r\n\r\n\t#collectionContext?: UmbMediaCollectionContext;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.consumeContext(UMB_MEDIA_COLLECTION_CONTEXT, (collectionContext) => {\r\n\t\t\tthis.#collectionContext = collectionContext;\r\n\t\t\tcollectionContext?.setupView(this);\r\n\t\t\tthis.observe(\r\n\t\t\t\tcollectionContext?.workspacePathBuilder,\r\n\t\t\t\t(builder) => {\r\n\t\t\t\t\tthis._workspacePathBuilder = builder;\r\n\t\t\t\t},\r\n\t\t\t\t'observePath',\r\n\t\t\t);\r\n\t\t\tthis.#observeCollectionContext();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeCollectionContext() {\r\n\t\tif (!this.#collectionContext) return;\r\n\r\n\t\tthis.observe(this.#collectionContext.items, (items) => (this._items = items), '_observeItems');\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#collectionContext.selection.selection,\r\n\t\t\t(selection) => (this._selection = selection),\r\n\t\t\t'_observeSelection',\r\n\t\t);\r\n\t}\r\n\r\n\t#onSelect(item: UmbMediaCollectionItemModel) {\r\n\t\tif (item.unique) {\r\n\t\t\tthis.#collectionContext?.selection.select(item.unique);\r\n\t\t}\r\n\t}\r\n\r\n\t#onDeselect(item: UmbMediaCollectionItemModel) {\r\n\t\tif (item.unique) {\r\n\t\t\tthis.#collectionContext?.selection.deselect(item.unique);\r\n\t\t}\r\n\t}\r\n\r\n\t#isSelected(item: UmbMediaCollectionItemModel) {\r\n\t\treturn this.#collectionContext?.selection.isSelected(item.unique);\r\n\t}\r\n\r\n\t#getEditUrl(item: UmbMediaCollectionItemModel) {\r\n\t\treturn item.unique && this._workspacePathBuilder\r\n\t\t\t? this._workspacePathBuilder({ entityType: item.entityType }) +\r\n\t\t\t\t\tUMB_EDIT_MEDIA_WORKSPACE_PATH_PATTERN.generateLocal({\r\n\t\t\t\t\t\tunique: item.unique,\r\n\t\t\t\t\t})\r\n\t\t\t: '';\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<div id=\"media-grid\">\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tthis._items,\r\n\t\t\t\t\t(item) => item.unique + item.status,\r\n\t\t\t\t\t(item) => this.#renderItem(item),\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(item: UmbMediaCollectionItemModel) {\r\n\t\tif (item.entityType === UMB_MEDIA_PLACEHOLDER_ENTITY_TYPE) {\r\n\t\t\treturn this.#renderPlaceholder(item);\r\n\t\t}\r\n\t\treturn html`\r\n\t\t\t<uui-card-media\r\n\t\t\t\tname=${ifDefined(item.name)}\r\n\t\t\t\tdata-mark=\"${item.entityType}:${item.unique}\"\r\n\t\t\t\tselectable\r\n\t\t\t\t?select-only=${this._selection.length > 0}\r\n\t\t\t\t?selected=${this.#isSelected(item)}\r\n\t\t\t\thref=${this.#getEditUrl(item)}\r\n\t\t\t\t@selected=${() => this.#onSelect(item)}\r\n\t\t\t\t@deselected=${() => this.#onDeselect(item)}>\r\n\t\t\t\t<umb-imaging-thumbnail\r\n\t\t\t\t\tunique=${item.unique}\r\n\t\t\t\t\talt=${ifDefined(item.name)}\r\n\t\t\t\t\ticon=${ifDefined(item.icon)}></umb-imaging-thumbnail>\r\n\t\t\t</uui-card-media>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderPlaceholder(item: UmbMediaCollectionItemModel) {\r\n\t\tconst complete = item.status === UmbFileDropzoneItemStatus.COMPLETE;\r\n\t\tconst error = item.status !== UmbFileDropzoneItemStatus.WAITING && !complete;\r\n\t\treturn html`<uui-card-media disabled class=\"media-placeholder-item\" name=${ifDefined(item.name)}>\r\n\t\t\t<umb-temporary-file-badge\r\n\t\t\t\t.progress=${item.progress ?? 0}\r\n\t\t\t\t?complete=${complete}\r\n\t\t\t\t?error=${error}></umb-temporary-file-badge>\r\n\t\t</uui-card-media>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\r\n\t\t\t.container {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\t#media-grid {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n\t\t\t\tgrid-auto-rows: 200px;\r\n\t\t\t\tgap: var(--uui-size-space-5);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbMediaGridCollectionViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-media-grid-collection-view': UmbMediaGridCollectionViewElement;\r\n\t}\r\n}\r\n"],"names":["_collectionContext","_UmbMediaGridCollectionViewElement_instances","observeCollectionContext_fn","onSelect_fn","onDeselect_fn","isSelected_fn","getEditUrl_fn","renderItem_fn","renderPlaceholder_fn","UmbMediaGridCollectionViewElement","UmbLitElement","__privateAdd","UMB_MEDIA_COLLECTION_CONTEXT","collectionContext","__privateSet","builder","__privateMethod","html","repeat","item","__privateGet","items","selection","UMB_EDIT_MEDIA_WORKSPACE_PATH_PATTERN","UMB_MEDIA_PLACEHOLDER_ENTITY_TYPE","ifDefined","complete","UmbFileDropzoneItemStatus","error","UmbTextStyles","css","__decorateClass","state","customElement","UmbMediaGridCollectionViewElement$1"],"mappings":"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"}