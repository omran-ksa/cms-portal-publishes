{"version":3,"file":"user-picker-modal.element-AMd6yLO_.js","sources":["../../../src/packages/user/user/modals/user-picker/user-picker-modal.element.ts"],"sourcesContent":["import { UmbUserCollectionRepository } from '../../collection/repository/user-collection.repository.js';\r\nimport type { UmbUserItemModel } from '../../repository/item/index.js';\r\nimport type { UmbUserPickerModalData, UmbUserPickerModalValue } from './user-picker-modal.token.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { PropertyValueMap } from '@umbraco-cms/backoffice/external/lit';\r\nimport { css, html, customElement, state, ifDefined } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbSelectionManager } from '@umbraco-cms/backoffice/utils';\r\n\r\n@customElement('umb-user-picker-modal')\r\nexport class UmbUserPickerModalElement extends UmbModalBaseElement<UmbUserPickerModalData, UmbUserPickerModalValue> {\r\n\t@state()\r\n\tprivate _users: Array<UmbUserItemModel> = [];\r\n\r\n\t#selectionManager = new UmbSelectionManager(this);\r\n\t#userCollectionRepository = new UmbUserCollectionRepository(this);\r\n\r\n\toverride connectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\r\n\t\t// TODO: in theory this config could change during the lifetime of the modal, so we could observe it\r\n\t\tthis.#selectionManager.setMultiple(this.data?.multiple ?? false);\r\n\t\tthis.#selectionManager.setSelection(this.value?.selection ?? []);\r\n\t}\r\n\r\n\tprotected override firstUpdated(_changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>): void {\r\n\t\tsuper.firstUpdated(_changedProperties);\r\n\t\tthis.#requestUsers();\r\n\t}\r\n\r\n\tasync #requestUsers() {\r\n\t\tif (!this.#userCollectionRepository) return;\r\n\t\tconst { data } = await this.#userCollectionRepository.requestCollection();\r\n\r\n\t\tif (data) {\r\n\t\t\tthis._users = data.items;\r\n\t\t}\r\n\t}\r\n\r\n\t#submit() {\r\n\t\tthis.value = { selection: this.#selectionManager.getSelection() };\r\n\t\tthis.modalContext?.submit();\r\n\t}\r\n\r\n\t#close() {\r\n\t\tthis.modalContext?.reject();\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=${this.localize.term('defaultdialogs_chooseUsers')}>\r\n\t\t\t\t<uui-box>\r\n\t\t\t\t\t${this._users.map(\r\n\t\t\t\t\t\t(user) => html`\r\n\t\t\t\t\t\t\t<uui-menu-item\r\n\t\t\t\t\t\t\t\tlabel=${ifDefined(user.name)}\r\n\t\t\t\t\t\t\t\tselectable\r\n\t\t\t\t\t\t\t\t@selected=${() => this.#selectionManager.select(user.unique)}\r\n\t\t\t\t\t\t\t\t@deselected=${() => this.#selectionManager.deselect(user.unique)}\r\n\t\t\t\t\t\t\t\t?selected=${this.#selectionManager.isSelected(user.unique)}>\r\n\t\t\t\t\t\t\t\t<umb-user-avatar\r\n\t\t\t\t\t\t\t\t\tslot=\"icon\"\r\n\t\t\t\t\t\t\t\t\t.name=${user.name}\r\n\t\t\t\t\t\t\t\t\t.kind=${user.kind}\r\n\t\t\t\t\t\t\t\t\t.imgUrls=${user.avatarUrls}></umb-user-avatar>\r\n\t\t\t\t\t\t\t</uui-menu-item>\r\n\t\t\t\t\t\t`,\r\n\t\t\t\t\t)}\r\n\t\t\t\t</uui-box>\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button label=${this.localize.term('general_close')} @click=${this.#close}></uui-button>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlabel=${this.localize.term('general_choose')}\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t@click=${this.#submit}></uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\tumb-user-avatar {\r\n\t\t\t\tfont-size: 12px;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbUserPickerModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-user-picker-modal': UmbUserPickerModalElement;\r\n\t}\r\n}\r\n"],"names":["_selectionManager","_userCollectionRepository","_UmbUserPickerModalElement_instances","requestUsers_fn","submit_fn","close_fn","UmbUserPickerModalElement","UmbModalBaseElement","__privateAdd","UmbSelectionManager","UmbUserCollectionRepository","__privateGet","_changedProperties","__privateMethod","html","user","ifDefined","data","UmbTextStyles","css","__decorateClass","state","customElement","UmbUserPickerModalElement$1"],"mappings":";;;;;;;;;;;+TAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAUa,IAAAC,IAAN,cAAwCC,EAAqE;AAAA,EAA7G,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAN,CAAA,GAEN,KAAQ,SAAkC,CAAC,GAEvBM,EAAA,MAAAR,GAAA,IAAIS,EAAoB,IAAI,CAAA,GACpBD,EAAA,MAAAP,GAAA,IAAIS,EAA4B,IAAI,CAAA;AAAA,EAAA;AAAA,EAEvD,oBAA0B;AAClC,UAAM,kBAAkB,GAGxBC,EAAA,MAAKX,CAAkB,EAAA,YAAY,KAAK,MAAM,YAAY,EAAK,GAC/DW,EAAA,MAAKX,GAAkB,aAAa,KAAK,OAAO,aAAa,EAAE;AAAA,EAAA;AAAA,EAG7C,aAAaY,GAA6E;AAC5G,UAAM,aAAaA,CAAkB,GACrCC,EAAA,MAAKX,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,EAAA;AAAA,EAqBQ,SAAS;AACV,WAAAW;AAAA,+BACsB,KAAK,SAAS,KAAK,4BAA4B,CAAC;AAAA;AAAA,OAExE,KAAK,OAAO;AAAA,MACb,CAACC,MAASD;AAAA;AAAA,gBAEAE,EAAUD,EAAK,IAAI,CAAC;AAAA;AAAA,oBAEhB,MAAMJ,EAAK,MAAAX,CAAA,EAAkB,OAAOe,EAAK,MAAM,CAAC;AAAA,sBAC9C,MAAMJ,EAAK,MAAAX,CAAA,EAAkB,SAASe,EAAK,MAAM,CAAC;AAAA,oBACpDJ,EAAK,MAAAX,CAAA,EAAkB,WAAWe,EAAK,MAAM,CAAC;AAAA;AAAA;AAAA,iBAGjDA,EAAK,IAAI;AAAA,iBACTA,EAAK,IAAI;AAAA,oBACNA,EAAK,UAAU;AAAA;AAAA;AAAA,IAG7B,CAAA;AAAA;AAAA;AAAA,yBAGmB,KAAK,SAAS,KAAK,eAAe,CAAC,WAAWF,QAAKX,GAAMG,CAAA,CAAA;AAAA;AAAA,cAEpE,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA;AAAA;AAAA,eAGnCQ,QAAKX,GAAOE,CAAA,CAAA;AAAA;AAAA;AAAA;AAAA,EAAA;AAc3B;AA3ECJ,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AALMC,IAAA,oBAAA,QAAA;AAoBAC,IAAa,iBAAG;AACjB,MAAA,CAACQ,QAAKV,CAA2B,EAAA;AACrC,QAAM,EAAE,MAAAgB,EAAK,IAAI,MAAMN,EAAA,MAAKV,GAA0B,kBAAkB;AAExE,EAAIgB,MACH,KAAK,SAASA,EAAK;AAErB;AAEAb,IAAO,WAAG;AACT,OAAK,QAAQ,EAAE,WAAWO,EAAK,MAAAX,CAAA,EAAkB,eAAe,GAChE,KAAK,cAAc,OAAO;AAC3B;AAEAK,IAAM,WAAG;AACR,OAAK,cAAc,OAAO;AAC3B;AApCYC,EAuEI,SAAS;AAAA,EACxBY;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAKD;AA5EQC,EAAA;AAAA,EADPC,EAAM;AAAA,GADKf,EAEJ,WAAA,UAAA,CAAA;AAFIA,IAANc,EAAA;AAAA,EADNE,EAAc,uBAAuB;AAAA,GACzBhB,CAAA;AAiFb,MAAAiB,IAAejB;"}