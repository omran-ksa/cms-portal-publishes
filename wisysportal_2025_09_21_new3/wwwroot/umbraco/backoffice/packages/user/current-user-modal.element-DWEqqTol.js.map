{"version":3,"file":"current-user-modal.element-DWEqqTol.js","sources":["../../../src/packages/user/current-user/modals/current-user/current-user-modal.element.ts"],"sourcesContent":["import { UMB_CURRENT_USER_CONTEXT } from '../../current-user.context.token.js';\r\nimport type { UmbCurrentUserModel } from '../../types.js';\r\nimport { UMB_AUTH_CONTEXT } from '@umbraco-cms/backoffice/auth';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { CSSResultGroup } from '@umbraco-cms/backoffice/external/lit';\r\nimport { css, html, customElement, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UmbModalContext } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UUIButtonState } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n@customElement('umb-current-user-modal')\r\nexport class UmbCurrentUserModalElement extends UmbLitElement {\r\n\t@property({ attribute: false })\r\n\tmodalContext?: UmbModalContext;\r\n\r\n\t@state()\r\n\tprivate _currentUser?: UmbCurrentUserModel;\r\n\r\n\t@state()\r\n\tprivate _logOutButtonState?: UUIButtonState;\r\n\r\n\t#authContext?: typeof UMB_AUTH_CONTEXT.TYPE;\r\n\t#currentUserContext?: typeof UMB_CURRENT_USER_CONTEXT.TYPE;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_CURRENT_USER_CONTEXT, (instance) => {\r\n\t\t\tthis.#currentUserContext = instance;\r\n\t\t\tthis._observeCurrentUser();\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_AUTH_CONTEXT, (instance) => {\r\n\t\t\tthis.#authContext = instance;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate async _observeCurrentUser() {\r\n\t\tif (!this.#currentUserContext) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#currentUserContext.currentUser,\r\n\t\t\t(currentUser) => {\r\n\t\t\t\tthis._currentUser = currentUser;\r\n\t\t\t},\r\n\t\t\t'umbCurrentUserObserver',\r\n\t\t);\r\n\t}\r\n\r\n\tprivate _close() {\r\n\t\tthis.modalContext?.submit();\r\n\t}\r\n\r\n\tprivate async _logout() {\r\n\t\tif (!this.#authContext) return;\r\n\t\tthis._logOutButtonState = 'waiting';\r\n\t\tawait this.#authContext.signOut();\r\n\t\tthis._logOutButtonState = 'success';\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=\"${this._currentUser?.name || ''}\">\r\n\t\t\t\t<div id=\"main\">\r\n\t\t\t\t\t<umb-extension-slot id=\"userProfileApps\" type=\"userProfileApp\"></umb-extension-slot>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button @click=${this._close} look=\"secondary\" .label=${this.localize.term('general_close')}>\r\n\t\t\t\t\t\t${this.localize.term('general_close')}\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t@click=${this._logout}\r\n\t\t\t\t\t\t.state=${this._logOutButtonState}\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"danger\"\r\n\t\t\t\t\t\t.label=${this.localize.term('general_logout')}>\r\n\t\t\t\t\t\t${this.localize.term('general_logout')}\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles: CSSResultGroup = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\t\t\t#main {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t}\r\n\t\t\t#umbraco-id-buttons {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t}\r\n\t\t\t#userProfileApps {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbCurrentUserModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-current-user-modal': UmbCurrentUserModalElement;\r\n\t}\r\n}\r\n"],"names":["_authContext","_currentUserContext","UmbCurrentUserModalElement","UmbLitElement","__privateAdd","UMB_CURRENT_USER_CONTEXT","instance","__privateSet","UMB_AUTH_CONTEXT","__privateGet","currentUser","html","UmbTextStyles","css","__decorateClass","property","state","customElement","UmbCurrentUserModalElement$1"],"mappings":";;;;;;;;;;;gUAAAA,GAAAC;AAWa,IAAAC,IAAN,cAAyCC,EAAc;AAAA,EAa7D,cAAc;AACP,UAAA,GAJPC,EAAA,MAAAJ,CAAA,GACAI,EAAA,MAAAH,CAAA,GAKM,KAAA,eAAeI,GAA0B,CAACC,MAAa;AAC3D,MAAAC,EAAA,MAAKN,GAAsBK,CAAA,GAC3B,KAAK,oBAAoB;AAAA,IAAA,CACzB,GAEI,KAAA,eAAeE,GAAkB,CAACF,MAAa;AACnD,MAAAC,EAAA,MAAKP,GAAeM,CAAA;AAAA,IAAA,CACpB;AAAA,EAAA;AAAA,EAGF,MAAc,sBAAsB;AAC/B,IAACG,QAAKR,CAAqB,KAE1B,KAAA;AAAA,MACJQ,QAAKR,CAAoB,EAAA;AAAA,MACzB,CAACS,MAAgB;AAChB,aAAK,eAAeA;AAAA,MACrB;AAAA,MACA;AAAA,IACD;AAAA,EAAA;AAAA,EAGO,SAAS;AAChB,SAAK,cAAc,OAAO;AAAA,EAAA;AAAA,EAG3B,MAAc,UAAU;AACnB,IAACD,QAAKT,CAAc,MACxB,KAAK,qBAAqB,WACpB,MAAAS,EAAA,MAAKT,GAAa,QAAQ,GAChC,KAAK,qBAAqB;AAAA,EAAA;AAAA,EAGlB,SAAS;AACV,WAAAW;AAAA,gCACuB,KAAK,cAAc,QAAQ,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA,0BAKnC,KAAK,MAAM,4BAA4B,KAAK,SAAS,KAAK,eAAe,CAAC;AAAA,QAC5F,KAAK,SAAS,KAAK,eAAe,CAAC;AAAA;AAAA;AAAA,eAG5B,KAAK,OAAO;AAAA,eACZ,KAAK,kBAAkB;AAAA;AAAA;AAAA,eAGvB,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA,QAC3C,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,EAAA;AA8B5C;AArFCX,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AAXYC,EAwEI,SAAyB;AAAA,EACxCU;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBD;AA5FAC,EAAA;AAAA,EADCC,EAAS,EAAE,WAAW,GAAO,CAAA;AAAA,GADlBb,EAEZ,WAAA,gBAAA,CAAA;AAGQY,EAAA;AAAA,EADPE,EAAM;AAAA,GAJKd,EAKJ,WAAA,gBAAA,CAAA;AAGAY,EAAA;AAAA,EADPE,EAAM;AAAA,GAPKd,EAQJ,WAAA,sBAAA,CAAA;AARIA,IAANY,EAAA;AAAA,EADNG,EAAc,wBAAwB;AAAA,GAC1Bf,CAAA;AAiGb,MAAAgB,IAAehB;"}