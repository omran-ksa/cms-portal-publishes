{"version":3,"file":"user-entity-create-option-action-base-CWwarEkx.js","sources":["../../../src/packages/user/user/entity-actions/create/user-entity-create-option-action-base.ts"],"sourcesContent":["import type { UmbUserKindType } from '../../utils/index.js';\r\nimport { UMB_CREATE_USER_MODAL } from './modal/create-user-modal.token.js';\r\nimport { UMB_ACTION_EVENT_CONTEXT } from '@umbraco-cms/backoffice/action';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UmbRequestReloadChildrenOfEntityEvent } from '@umbraco-cms/backoffice/entity-action';\r\nimport {\r\n\tUmbEntityCreateOptionActionBase,\r\n\ttype MetaEntityCreateOptionAction,\r\n\ttype UmbEntityCreateOptionActionArgs,\r\n} from '@umbraco-cms/backoffice/entity-create-option-action';\r\nimport { umbOpenModal } from '@umbraco-cms/backoffice/modal';\r\n\r\nexport interface UmbUserEntityCreateOptionActionBaseArgs\r\n\textends UmbEntityCreateOptionActionArgs<MetaEntityCreateOptionAction> {\r\n\tkind: UmbUserKindType;\r\n}\r\n\r\nexport abstract class UmbUserEntityCreateOptionActionBase extends UmbEntityCreateOptionActionBase {\r\n\t#kind: UmbUserKindType;\r\n\r\n\tconstructor(host: UmbControllerHost, args: UmbUserEntityCreateOptionActionBaseArgs) {\r\n\t\tsuper(host, args);\r\n\t\tthis.#kind = args.kind;\r\n\t}\r\n\r\n\toverride async execute() {\r\n\t\tawait umbOpenModal(this, UMB_CREATE_USER_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\tuser: {\r\n\t\t\t\t\tkind: this.#kind,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t})\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.#requestReloadChildrenOfEntity();\r\n\t\t\t})\r\n\t\t\t.catch(async () => {\r\n\t\t\t\t// modal is closed after creation instead of navigating to the new user.\r\n\t\t\t\t// We therefore need to reload the children of the entity\r\n\t\t\t\tthis.#requestReloadChildrenOfEntity();\r\n\t\t\t});\r\n\t}\r\n\r\n\tasync #requestReloadChildrenOfEntity() {\r\n\t\tconst eventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\r\n\t\tif (!eventContext) throw new Error('Event context not found');\r\n\t\tconst event = new UmbRequestReloadChildrenOfEntityEvent({\r\n\t\t\tentityType: this.args.entityType,\r\n\t\t\tunique: this.args.unique,\r\n\t\t});\r\n\r\n\t\teventContext.dispatchEvent(event);\r\n\t}\r\n}\r\n"],"names":["UmbUserEntityCreateOptionActionBase","UmbEntityCreateOptionActionBase","#kind","host","args","umbOpenModal","UMB_CREATE_USER_MODAL","#requestReloadChildrenOfEntity","eventContext","UMB_ACTION_EVENT_CONTEXT","event","UmbRequestReloadChildrenOfEntityEvent"],"mappings":";;;;;AAiBO,MAAeA,UAA4CC,EAAgC;AAAA,EACjGC;AAAA,EAEA,YAAYC,GAAyBC,GAA+C;AACnF,UAAMD,GAAMC,CAAI,GAChB,KAAKF,KAAQE,EAAK;AAAA,EAAA;AAAA,EAGnB,MAAe,UAAU;AAClB,UAAAC,EAAa,MAAMC,GAAuB;AAAA,MAC/C,MAAM;AAAA,QACL,MAAM;AAAA,UACL,MAAM,KAAKJ;AAAA,QAAA;AAAA,MACZ;AAAA,IACD,CACA,EACC,KAAK,MAAM;AACX,WAAKK,GAA+B;AAAA,IAAA,CACpC,EACA,MAAM,YAAY;AAGlB,WAAKA,GAA+B;AAAA,IAAA,CACpC;AAAA,EAAA;AAAA,EAGH,MAAMA,KAAiC;AACtC,UAAMC,IAAe,MAAM,KAAK,WAAWC,CAAwB;AACnE,QAAI,CAACD,EAAoB,OAAA,IAAI,MAAM,yBAAyB;AACtD,UAAAE,IAAQ,IAAIC,EAAsC;AAAA,MACvD,YAAY,KAAK,KAAK;AAAA,MACtB,QAAQ,KAAK,KAAK;AAAA,IAAA,CAClB;AAED,IAAAH,EAAa,cAAcE,CAAK;AAAA,EAAA;AAElC;"}