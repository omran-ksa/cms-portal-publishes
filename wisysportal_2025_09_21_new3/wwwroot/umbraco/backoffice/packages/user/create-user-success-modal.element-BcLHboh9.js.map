{"version":3,"file":"create-user-success-modal.element-BcLHboh9.js","sources":["../../../src/packages/user/user/entity-actions/create/modal/create-user-success-modal.element.ts"],"sourcesContent":["import { UmbUserItemRepository } from '../../../repository/item/index.js';\r\nimport { UmbNewUserPasswordRepository } from '../../../repository/new-password/index.js';\r\nimport type { UmbUserItemModel } from '../../../repository/item/index.js';\r\nimport { UMB_USER_WORKSPACE_PATH } from '../../../paths.js';\r\nimport type {\r\n\tUmbCreateUserSuccessModalData,\r\n\tUmbCreateUserSuccessModalValue,\r\n} from './create-user-success-modal.token.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UUIInputPasswordElement } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { UmbNotificationDefaultData, UmbNotificationContext } from '@umbraco-cms/backoffice/notification';\r\nimport { UMB_NOTIFICATION_CONTEXT } from '@umbraco-cms/backoffice/notification';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\n\r\n@customElement('umb-create-user-success-modal')\r\nexport class UmbCreateUserSuccessModalElement extends UmbModalBaseElement<\r\n\tUmbCreateUserSuccessModalData,\r\n\tUmbCreateUserSuccessModalValue\r\n> {\r\n\t@state()\r\n\t_userItem?: UmbUserItemModel;\r\n\r\n\t@state()\r\n\t_initialPassword: string = '';\r\n\r\n\t#userItemRepository = new UmbUserItemRepository(this);\r\n\t#userNewPasswordRepository = new UmbNewUserPasswordRepository(this);\r\n\t#notificationContext?: UmbNotificationContext;\r\n\r\n\toverride connectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\t\tthis.consumeContext(UMB_NOTIFICATION_CONTEXT, (instance) => (this.#notificationContext = instance));\r\n\t}\r\n\r\n\tprotected override async firstUpdated(): Promise<void> {\r\n\t\tconst unique = this.data?.user.unique;\r\n\t\tif (!unique) throw new Error('No user unique is provided');\r\n\r\n\t\tconst [userItemResponse, newPasswordResponse] = await Promise.all([\r\n\t\t\tthis.#userItemRepository.requestItems([unique]),\r\n\t\t\tthis.#userNewPasswordRepository.requestNewPassword(unique),\r\n\t\t]);\r\n\r\n\t\tif (userItemResponse.data) {\r\n\t\t\tthis._userItem = userItemResponse.data[0];\r\n\t\t}\r\n\r\n\t\tif (newPasswordResponse.data?.resetPassword) {\r\n\t\t\tthis._initialPassword = newPasswordResponse.data.resetPassword;\r\n\t\t}\r\n\t}\r\n\r\n\t#copyPassword() {\r\n\t\tconst passwordInput = this.shadowRoot?.querySelector('#password') as UUIInputPasswordElement;\r\n\t\tif (!passwordInput || typeof passwordInput.value !== 'string') return;\r\n\r\n\t\tnavigator.clipboard.writeText(passwordInput.value);\r\n\t\tconst data: UmbNotificationDefaultData = { message: 'Password copied' };\r\n\t\tthis.#notificationContext?.peek('positive', { data });\r\n\t}\r\n\r\n\t#onCloseModal = (event: Event) => {\r\n\t\tevent.stopPropagation();\r\n\t\tthis._rejectModal();\r\n\t};\r\n\r\n\t#onCreateAnotherUser = (event: Event) => {\r\n\t\tevent.stopPropagation();\r\n\t\tthis._rejectModal({ type: 'createAnotherUser' });\r\n\t};\r\n\r\n\t#onGoToProfile = () => {\r\n\t\tthis._submitModal();\r\n\t};\r\n\r\n\toverride render() {\r\n\t\treturn html`<uui-dialog-layout headline=\"${this._userItem?.name} has been created\">\r\n\t\t\t<p>The new user has successfully been created. To log in to Umbraco use the password below</p>\r\n\t\t\t<uui-form-layout-item>\r\n\t\t\t\t<uui-label slot=\"label\" for=\"password\">Password</uui-label>\r\n\t\t\t\t<div id=\"password-control\">\r\n\t\t\t\t\t<uui-input-password id=\"password\" label=\"password\" name=\"password\" value=\"${this._initialPassword}\" readonly>\r\n\t\t\t\t\t</uui-input-password>\r\n\t\t\t\t\t<uui-button compact label=\"Copy\" @click=${this.#copyPassword} look=\"outline\"></uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</uui-form-layout-item>\r\n\r\n\t\t\t<uui-button @click=${this.#onCloseModal} slot=\"actions\" label=\"Close\" look=\"secondary\"></uui-button>\r\n\t\t\t<uui-button\r\n\t\t\t\t@click=${this.#onCreateAnotherUser}\r\n\t\t\t\tslot=\"actions\"\r\n\t\t\t\tlabel=\"Create another user\"\r\n\t\t\t\tlook=\"secondary\"></uui-button>\r\n\t\t\t<uui-button\r\n\t\t\t\t@click=${this.#onGoToProfile}\r\n\t\t\t\tslot=\"actions\"\r\n\t\t\t\tlabel=\"Go to profile\"\r\n\t\t\t\tlook=\"primary\"\r\n\t\t\t\tcolor=\"positive\"\r\n\t\t\t\thref=${UMB_USER_WORKSPACE_PATH + '/edit/' + this.data?.user.unique}></uui-button>\r\n\t\t</uui-dialog-layout>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\tp {\r\n\t\t\t\twidth: 580px;\r\n\t\t\t}\r\n\r\n\t\t\t#password {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#password-control {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbCreateUserSuccessModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-create-user-success-modal': UmbCreateUserSuccessModalElement;\r\n\t}\r\n}\r\n"],"names":["_userItemRepository","_userNewPasswordRepository","_notificationContext","_UmbCreateUserSuccessModalElement_instances","copyPassword_fn","_onCloseModal","_onCreateAnotherUser","_onGoToProfile","UmbCreateUserSuccessModalElement","UmbModalBaseElement","__privateAdd","UmbUserItemRepository","UmbNewUserPasswordRepository","event","UMB_NOTIFICATION_CONTEXT","instance","__privateSet","unique","userItemResponse","newPasswordResponse","__privateGet","html","__privateMethod","UMB_USER_WORKSPACE_PATH","passwordInput","data","UmbTextStyles","css","__decorateClass","state","customElement","UmbCreateUserSuccessModalElement$1"],"mappings":"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"}