{"version":3,"file":"member-table-collection-view.element-DAZmQyxa.js","sources":["../../../src/packages/members/member/collection/views/table/member-table-collection-view.element.ts"],"sourcesContent":["import type { UmbMemberCollectionModel } from '../../types.js';\r\nimport { UMB_MEMBER_COLLECTION_CONTEXT } from '../../member-collection.context-token.js';\r\nimport type { UmbMemberCollectionContext } from '../../member-collection.context.js';\r\nimport { UmbMemberKind } from '../../../utils/index.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { UmbTableColumn, UmbTableConfig, UmbTableItem } from '@umbraco-cms/backoffice/components';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbMemberTypeItemRepository } from '@umbraco-cms/backoffice/member-type';\r\n\r\n@customElement('umb-member-table-collection-view')\r\nexport class UmbMemberTableCollectionViewElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _tableConfig: UmbTableConfig = {\r\n\t\tallowSelection: false,\r\n\t};\r\n\r\n\t@state()\r\n\tprivate _tableColumns: Array<UmbTableColumn> = [\r\n\t\t{\r\n\t\t\tname: this.localize.term('general_name'),\r\n\t\t\talias: 'memberName',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: this.localize.term('general_username'),\r\n\t\t\talias: 'memberUsername',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: this.localize.term('general_email'),\r\n\t\t\talias: 'memberEmail',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: this.localize.term('content_membertype'),\r\n\t\t\talias: 'memberType',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: this.localize.term('member_kind'),\r\n\t\t\talias: 'memberKind',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '',\r\n\t\t\talias: 'entityActions',\r\n\t\t\talign: 'right',\r\n\t\t},\r\n\t];\r\n\r\n\t@state()\r\n\tprivate _tableItems: Array<UmbTableItem> = [];\r\n\r\n\t#collectionContext?: UmbMemberCollectionContext;\r\n\t#memberTypeItemRepository = new UmbMemberTypeItemRepository(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_MEMBER_COLLECTION_CONTEXT, (instance) => {\r\n\t\t\tthis.#collectionContext = instance;\r\n\t\t\tthis.#observeCollectionItems();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeCollectionItems() {\r\n\t\tif (!this.#collectionContext) return;\r\n\t\tthis.observe(this.#collectionContext.items, (items) => this.#createTableItems(items), 'umbCollectionItemsObserver');\r\n\t}\r\n\r\n\tasync #createTableItems(members: Array<UmbMemberCollectionModel>) {\r\n\t\tconst memberTypeUniques = members.map((member) => member.memberType.unique);\r\n\t\tconst { data: memberTypes } = await this.#memberTypeItemRepository.requestItems(memberTypeUniques);\r\n\r\n\t\tthis._tableItems = members.map((member) => {\r\n\t\t\t// TODO: get correct variant name\r\n\t\t\tconst name = member.variants[0].name;\r\n\t\t\tconst kind =\r\n\t\t\t\tmember.kind === UmbMemberKind.API\r\n\t\t\t\t\t? this.localize.term('member_memberKindApi')\r\n\t\t\t\t\t: this.localize.term('member_memberKindDefault');\r\n\r\n\t\t\tconst memberType = memberTypes?.find((type) => type.unique === member.memberType.unique);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid: member.unique,\r\n\t\t\t\ticon: memberType?.icon,\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'memberName',\r\n\t\t\t\t\t\tvalue: html`<a href=${'section/member-management/workspace/member/edit/' + member.unique}>${name}</a>`,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'memberUsername',\r\n\t\t\t\t\t\tvalue: member.username,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'memberEmail',\r\n\t\t\t\t\t\tvalue: member.email,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'memberType',\r\n\t\t\t\t\t\tvalue: memberType?.name,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'memberKind',\r\n\t\t\t\t\t\tvalue: kind,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'entityActions',\r\n\t\t\t\t\t\tvalue: html`<umb-entity-actions-table-column-view\r\n\t\t\t\t\t\t\t.value=${{\r\n\t\t\t\t\t\t\t\tentityType: member.entityType,\r\n\t\t\t\t\t\t\t\tunique: member.unique,\r\n\t\t\t\t\t\t\t\tname: member.variants[0].name,\r\n\t\t\t\t\t\t\t}}></umb-entity-actions-table-column-view>`,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-table .config=${this._tableConfig} .columns=${this._tableColumns} .items=${this._tableItems}></umb-table>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbMemberTableCollectionViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-member-table-collection-view': UmbMemberTableCollectionViewElement;\r\n\t}\r\n}\r\n"],"names":["_collectionContext","_memberTypeItemRepository","_UmbMemberTableCollectionViewElement_instances","observeCollectionItems_fn","createTableItems_fn","UmbMemberTableCollectionViewElement","UmbLitElement","__privateAdd","UmbMemberTypeItemRepository","UMB_MEMBER_COLLECTION_CONTEXT","instance","__privateSet","__privateMethod","html","__privateGet","items","members","memberTypeUniques","member","memberTypes","name","kind","UmbMemberKind","memberType","type","UmbTextStyles","css","__decorateClass","state","customElement","UmbMemberTableCollectionViewElement$1"],"mappings":"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"}