{"version":3,"file":"content-collection-workspace-view.element-D4uBnTzf.js","sources":["../../../src/packages/content/content/collection/content-collection-workspace-view.element.ts"],"sourcesContent":["import { UMB_CONTENT_COLLECTION_WORKSPACE_CONTEXT } from './content-collection-workspace.context-token.js';\r\nimport { customElement, html, nothing, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbDataTypeDetailRepository } from '@umbraco-cms/backoffice/data-type';\r\nimport { UmbPropertyEditorConfigCollection } from '@umbraco-cms/backoffice/property-editor';\r\nimport type { UmbDataTypeDetailModel } from '@umbraco-cms/backoffice/data-type';\r\nimport type { UmbWorkspaceViewElement } from '@umbraco-cms/backoffice/workspace';\r\nimport type { UmbCollectionConfiguration } from '@umbraco-cms/backoffice/collection';\r\n\r\nconst elementName = 'umb-content-collection-workspace-view';\r\n@customElement('umb-content-collection-workspace-view')\r\nexport class UmbContentCollectionWorkspaceViewElement extends UmbLitElement implements UmbWorkspaceViewElement {\r\n\t@state()\r\n\tprivate _loading = true;\r\n\r\n\t@state()\r\n\tprivate _config?: UmbCollectionConfiguration;\r\n\r\n\t@state()\r\n\tprivate _collectionAlias?: string;\r\n\r\n\t@state()\r\n\tprivate _documentUnique?: string;\r\n\r\n\t#dataTypeDetailRepository = new UmbDataTypeDetailRepository(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.#observeConfig();\r\n\t}\r\n\r\n\tasync #observeConfig() {\r\n\t\tthis.consumeContext(UMB_CONTENT_COLLECTION_WORKSPACE_CONTEXT, (workspaceContext) => {\r\n\t\t\tthis._collectionAlias = workspaceContext?.getCollectionAlias();\r\n\t\t\tthis._documentUnique = workspaceContext?.getUnique() ?? '';\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tworkspaceContext?.structure.ownerContentType,\r\n\t\t\t\tasync (contentType) => {\r\n\t\t\t\t\tif (!contentType || !contentType.collection) return;\r\n\r\n\t\t\t\t\tconst dataTypeUnique = contentType.collection.unique;\r\n\r\n\t\t\t\t\tif (dataTypeUnique) {\r\n\t\t\t\t\t\tawait this.#dataTypeDetailRepository.requestByUnique(dataTypeUnique);\r\n\t\t\t\t\t\tthis.observe(\r\n\t\t\t\t\t\t\tawait this.#dataTypeDetailRepository.byUnique(dataTypeUnique),\r\n\t\t\t\t\t\t\t(dataType) => {\r\n\t\t\t\t\t\t\t\tif (!dataType) return;\r\n\t\t\t\t\t\t\t\tthis._config = this.#mapDataTypeConfigToCollectionConfig(dataType);\r\n\t\t\t\t\t\t\t\tthis._loading = false;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t'_observeConfigDataType',\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t'_observeConfigContentType',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t#mapDataTypeConfigToCollectionConfig(dataType: UmbDataTypeDetailModel): UmbCollectionConfiguration {\r\n\t\tconst config = new UmbPropertyEditorConfigCollection(dataType.values);\r\n\t\tconst pageSize = Number(config.getValueByAlias('pageSize'));\r\n\t\treturn {\r\n\t\t\tunique: this._documentUnique,\r\n\t\t\tlayouts: config?.getValueByAlias('layouts'),\r\n\t\t\torderBy: config?.getValueByAlias('orderBy') ?? 'updateDate',\r\n\t\t\torderDirection: config?.getValueByAlias('orderDirection') ?? 'asc',\r\n\t\t\tpageSize: isNaN(pageSize) ? 50 : pageSize,\r\n\t\t\tuserDefinedProperties: config?.getValueByAlias('includeProperties'),\r\n\t\t};\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (this._loading) return nothing;\r\n\t\treturn html`<umb-collection .alias=${this._collectionAlias} .config=${this._config}></umb-collection>`;\r\n\t}\r\n}\r\n\r\nexport { UmbContentCollectionWorkspaceViewElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t[elementName]: UmbContentCollectionWorkspaceViewElement;\r\n\t}\r\n}\r\n"],"names":["_dataTypeDetailRepository","_UmbContentCollectionWorkspaceViewElement_instances","observeConfig_fn","mapDataTypeConfigToCollectionConfig_fn","UmbContentCollectionWorkspaceViewElement","UmbLitElement","__privateAdd","UmbDataTypeDetailRepository","__privateMethod","nothing","html","UMB_CONTENT_COLLECTION_WORKSPACE_CONTEXT","workspaceContext","contentType","dataTypeUnique","__privateGet","dataType","config","UmbPropertyEditorConfigCollection","pageSize","__decorateClass","state","customElement"],"mappings":";;;;;;;;;;;+TAAAA,GAAAC,GAAAC,GAAAC;AAWa,IAAAC,IAAN,cAAuDC,EAAiD;AAAA,EAe9G,cAAc;AACP,UAAA,GAhBDC,EAAA,MAAAL,CAAA,GAEN,KAAQ,WAAW,IAWSK,EAAA,MAAAN,GAAA,IAAIO,EAA4B,IAAI,CAAA,GAI/DC,EAAA,MAAKP,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,EAAA;AAAA,EA8CQ,SAAS;AACb,WAAA,KAAK,WAAiBO,IACnBC,2BAA8B,KAAK,gBAAgB,YAAY,KAAK,OAAO;AAAA,EAAA;AAEpF;AAtDCV,IAAA,oBAAA,QAAA;AAbMC,IAAA,oBAAA,QAAA;AAoBAC,IAAc,iBAAG;AACjB,OAAA,eAAeS,GAA0C,CAACC,MAAqB;AAC9E,SAAA,mBAAmBA,GAAkB,mBAAmB,GACxD,KAAA,kBAAkBA,GAAkB,UAAe,KAAA,IAEnD,KAAA;AAAA,MACJA,GAAkB,UAAU;AAAA,MAC5B,OAAOC,MAAgB;AACtB,YAAI,CAACA,KAAe,CAACA,EAAY,WAAY;AAEvC,cAAAC,IAAiBD,EAAY,WAAW;AAE9C,QAAIC,MACG,MAAAC,EAAA,MAAKf,CAA0B,EAAA,gBAAgBc,CAAc,GAC9D,KAAA;AAAA,UACJ,MAAMC,EAAA,MAAKf,CAA0B,EAAA,SAASc,CAAc;AAAA,UAC5D,CAACE,MAAa;AACb,YAAKA,MACA,KAAA,UAAUR,EAAK,MAAAP,GAAAE,CAAA,EAAL,KAA0C,MAAAa,CAAA,GACzD,KAAK,WAAW;AAAA,UACjB;AAAA,UACA;AAAA,QACD;AAAA,MAEF;AAAA,MACA;AAAA,IACD;AAAA,EAAA,CACA;AACF;AAEAb,IAAoC,SAACa,GAA8D;AAClG,QAAMC,IAAS,IAAIC,EAAkCF,EAAS,MAAM,GAC9DG,IAAW,OAAOF,EAAO,gBAAgB,UAAU,CAAC;AACnD,SAAA;AAAA,IACN,QAAQ,KAAK;AAAA,IACb,SAASA,GAAQ,gBAAgB,SAAS;AAAA,IAC1C,SAASA,GAAQ,gBAAgB,SAAS,KAAK;AAAA,IAC/C,gBAAgBA,GAAQ,gBAAgB,gBAAgB,KAAK;AAAA,IAC7D,UAAU,MAAME,CAAQ,IAAI,KAAKA;AAAA,IACjC,uBAAuBF,GAAQ,gBAAgB,mBAAmB;AAAA,EACnE;AACD;AA3DQG,EAAA;AAAA,EADPC,EAAM;AAAA,GADKjB,EAEJ,WAAA,YAAA,CAAA;AAGAgB,EAAA;AAAA,EADPC,EAAM;AAAA,GAJKjB,EAKJ,WAAA,WAAA,CAAA;AAGAgB,EAAA;AAAA,EADPC,EAAM;AAAA,GAPKjB,EAQJ,WAAA,oBAAA,CAAA;AAGAgB,EAAA;AAAA,EADPC,EAAM;AAAA,GAVKjB,EAWJ,WAAA,mBAAA,CAAA;AAXIA,IAANgB,EAAA;AAAA,EADNE,EAAc,uCAAuC;AAAA,GACzClB,CAAA;"}