{"version":3,"file":"content-type-design-editor-tab.element-BlPF0LYA.js","sources":["../../../src/packages/content/content-type/workspace/views/design/content-type-design-editor-property.context.ts","../../../src/packages/content/content-type/workspace/views/design/content-type-design-editor-property.element.ts","../../../src/packages/content/content-type/workspace/views/design/content-type-design-editor-properties.element.ts","../../../src/packages/content/content-type/workspace/views/design/content-type-design-editor-group.element.ts","../../../src/packages/content/content-type/workspace/views/design/content-type-design-editor-tab.element.ts"],"sourcesContent":["import { UMB_PROPERTY_TYPE_CONTEXT } from './content-type-design-editor-property.context-token.js';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UmbContextBase } from '@umbraco-cms/backoffice/class-api';\r\nimport { UmbStringState } from '@umbraco-cms/backoffice/observable-api';\r\n\r\nexport class UmbPropertyTypeContext extends UmbContextBase {\r\n\t#alias = new UmbStringState(undefined);\r\n\tpublic readonly alias = this.#alias.asObservable();\r\n\t#label = new UmbStringState(undefined);\r\n\tpublic readonly label = this.#label.asObservable();\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, UMB_PROPERTY_TYPE_CONTEXT);\r\n\t}\r\n\r\n\tpublic setAlias(alias: string | undefined): void {\r\n\t\tthis.#alias.setValue(alias);\r\n\t}\r\n\tpublic getAlias(): string | undefined {\r\n\t\treturn this.#alias.getValue();\r\n\t}\r\n\tpublic setLabel(label: string | undefined): void {\r\n\t\tthis.#label.setValue(label);\r\n\t}\r\n\tpublic getLabel(): string | undefined {\r\n\t\treturn this.#label.getValue();\r\n\t}\r\n\r\n\tpublic override destroy(): void {\r\n\t\tsuper.destroy();\r\n\t\tthis.#alias.destroy();\r\n\t\tthis.#label.destroy();\r\n\t}\r\n}\r\n","import type { UmbContentTypePropertyStructureHelper } from '../../../structure/index.js';\r\nimport type { UmbContentTypeModel, UmbPropertyTypeModel, UmbPropertyTypeScaffoldModel } from '../../../types.js';\r\nimport { UmbPropertyTypeContext } from './content-type-design-editor-property.context.js';\r\nimport { css, html, customElement, property, state, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { generateAlias } from '@umbraco-cms/backoffice/utils';\r\nimport { umbConfirmModal } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbDataTypeDetailRepository } from '@umbraco-cms/backoffice/data-type';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UMB_EDIT_PROPERTY_TYPE_WORKSPACE_PATH_PATTERN } from '@umbraco-cms/backoffice/property-type';\r\nimport type { UUIInputElement, UUIInputLockElement, UUIInputEvent } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n/**\r\n *  @element umb-content-type-design-editor-property\r\n *  @description - Element for displaying a property in an workspace.\r\n *  @slot editor - Slot for rendering the Property Editor\r\n */\r\n@customElement('umb-content-type-design-editor-property')\r\nexport class UmbContentTypeDesignEditorPropertyElement extends UmbLitElement {\r\n\t#context = new UmbPropertyTypeContext(this);\r\n\t#dataTypeDetailRepository = new UmbDataTypeDetailRepository(this);\r\n\t#dataTypeUnique?: string;\r\n\t#propertyUnique?: string;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic set propertyStructureHelper(value: UmbContentTypePropertyStructureHelper<UmbContentTypeModel> | undefined) {\r\n\t\tif (value === this._propertyStructureHelper) return;\r\n\t\tthis._propertyStructureHelper = value;\r\n\t\tthis.#checkInherited();\r\n\t}\r\n\tpublic get propertyStructureHelper(): UmbContentTypePropertyStructureHelper<UmbContentTypeModel> | undefined {\r\n\t\treturn this._propertyStructureHelper;\r\n\t}\r\n\tprivate _propertyStructureHelper?: UmbContentTypePropertyStructureHelper<UmbContentTypeModel> | undefined;\r\n\r\n\t/**\r\n\t * Property, the data object for the property.\r\n\t * @type {UmbPropertyTypeModel | UmbPropertyTypeScaffoldModel | undefined}\r\n\t * @attr\r\n\t * @default\r\n\t */\r\n\t@property({ type: Object })\r\n\tpublic get property(): UmbPropertyTypeModel | UmbPropertyTypeScaffoldModel | undefined {\r\n\t\treturn this._property;\r\n\t}\r\n\tpublic set property(value: UmbPropertyTypeModel | UmbPropertyTypeScaffoldModel | undefined) {\r\n\t\tconst oldValue = this._property;\r\n\t\tif (value === oldValue) return;\r\n\t\tthis._property = value;\r\n\t\tthis.#context.setAlias(value?.alias);\r\n\t\tthis.#context.setLabel(value?.name);\r\n\t\tthis.#checkAliasAutoGenerate(this._property?.unique);\r\n\t\tthis.#checkInherited();\r\n\t\tthis.#setDataType(this._property?.dataType?.unique);\r\n\t\tthis.requestUpdate('property', oldValue);\r\n\t}\r\n\tprivate _property?: UmbPropertyTypeModel | UmbPropertyTypeScaffoldModel | undefined;\r\n\r\n\t@property({ type: Boolean, reflect: true, attribute: 'sort-mode-active' })\r\n\tpublic sortModeActive = false;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic editContentTypePath?: string;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic ownerVariesByCulture?: boolean;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic ownerVariesBySegment?: boolean;\r\n\r\n\t@property({ type: Boolean, reflect: true, attribute: '_inherited' })\r\n\tpublic _inherited?: boolean;\r\n\r\n\t@state()\r\n\tpublic _inheritedContentTypeId?: string;\r\n\r\n\t@state()\r\n\tpublic _inheritedContentTypeName?: string;\r\n\r\n\t@property({ type: String, reflect: false })\r\n\tprotected editPropertyTypePath?: string;\r\n\r\n\t@state()\r\n\tprivate _dataTypeName?: string;\r\n\r\n\t@state()\r\n\tprivate _aliasLocked = true;\r\n\r\n\t#autoGenerateAlias = true;\r\n\r\n\t#checkAliasAutoGenerate(unique: string | undefined) {\r\n\t\tif (unique === this.#propertyUnique) return;\r\n\t\tthis.#propertyUnique = unique;\r\n\r\n\t\tif (this.#context.getAlias()) {\r\n\t\t\tthis.#autoGenerateAlias = false;\r\n\t\t}\r\n\t}\r\n\r\n\tasync #checkInherited() {\r\n\t\tif (this._propertyStructureHelper && this._property) {\r\n\t\t\t// We can first match with something if we have a name [NL]\r\n\t\t\tthis.observe(\r\n\t\t\t\tawait this._propertyStructureHelper!.contentTypeOfProperty(this._property.unique),\r\n\t\t\t\t(contentType) => {\r\n\t\t\t\t\tthis._inherited =\r\n\t\t\t\t\t\tthis._propertyStructureHelper?.getStructureManager()?.getOwnerContentTypeUnique() !== contentType?.unique;\r\n\t\t\t\t\tthis._inheritedContentTypeId = contentType?.unique;\r\n\t\t\t\t\tthis._inheritedContentTypeName = contentType?.name;\r\n\t\t\t\t},\r\n\t\t\t\t'observeIsOwnerProperty',\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\t#partialUpdate(partialObject: UmbPropertyTypeModel) {\r\n\t\tif (!this._property || !this._propertyStructureHelper) return;\r\n\t\tthis._propertyStructureHelper.partialUpdateProperty(this._property.unique, partialObject);\r\n\t}\r\n\r\n\t#singleValueUpdate<PropertyNameType extends keyof UmbPropertyTypeModel>(\r\n\t\tpropertyName: PropertyNameType,\r\n\t\tvalue: UmbPropertyTypeModel[PropertyNameType],\r\n\t) {\r\n\t\tif (!this._property || !this._propertyStructureHelper) return;\r\n\t\tconst partialObject: Partial<UmbPropertyTypeModel> = {};\r\n\t\tpartialObject[propertyName] = value === null ? undefined : value;\r\n\t\tthis._propertyStructureHelper.partialUpdateProperty(this._property.unique, partialObject);\r\n\t}\r\n\r\n\t#onToggleAliasLock(event: CustomEvent) {\r\n\t\tif (!this.property?.alias && (event.target as UUIInputLockElement).locked) {\r\n\t\t\tthis.#autoGenerateAlias = true;\r\n\t\t} else {\r\n\t\t\tthis.#autoGenerateAlias = false;\r\n\t\t}\r\n\r\n\t\tthis._aliasLocked = !this._aliasLocked;\r\n\t\tif (!this._aliasLocked) {\r\n\t\t\t(event.target as UUIInputElement)?.focus();\r\n\t\t}\r\n\t}\r\n\r\n\tasync #setDataType(dataTypeUnique: string | undefined) {\r\n\t\tif (!dataTypeUnique) {\r\n\t\t\tthis._dataTypeName = undefined;\r\n\t\t\tthis.#dataTypeUnique = undefined;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (dataTypeUnique === this.#dataTypeUnique) return;\r\n\t\tthis.#dataTypeUnique = dataTypeUnique;\r\n\t\tthis.#dataTypeDetailRepository.requestByUnique(dataTypeUnique).then((x) => (this._dataTypeName = x?.data?.name));\r\n\t}\r\n\r\n\tasync #requestRemove(e: Event) {\r\n\t\te.preventDefault();\r\n\t\te.stopImmediatePropagation();\r\n\t\tif (!this._property || !this._property.unique) return;\r\n\r\n\t\tconst unique = this._property.unique;\r\n\r\n\t\t// TODO: Do proper localization here: [NL]\r\n\t\tawait umbConfirmModal(this, {\r\n\t\t\theadline: `${this.localize.term('actions_delete')} property`,\r\n\t\t\tcontent: html`<umb-localize key=\"contentTypeEditor_confirmDeletePropertyMessage\" .args=${[this._property.name ?? unique]}>Are you sure you want to delete the property <strong>${this._property.name ?? unique}</strong></umb-localize></div>`,\r\n\t\t\tconfirmLabel: this.localize.term('actions_delete'),\r\n\t\t\tcolor: 'danger',\r\n\t\t});\r\n\r\n\t\tthis._propertyStructureHelper?.removeProperty(unique);\r\n\t}\r\n\r\n\t#onAliasChanged(event: UUIInputEvent) {\r\n\t\tthis.#singleValueUpdate('alias', event.target.value.toString());\r\n\t}\r\n\r\n\t#onNameChanged(event: UUIInputEvent) {\r\n\t\tconst newName = event.target.value.toString();\r\n\t\tif (this.#autoGenerateAlias) {\r\n\t\t\tthis.#singleValueUpdate('alias', generateAlias(newName ?? ''));\r\n\t\t}\r\n\t\tthis.#singleValueUpdate('name', newName);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\t// TODO: Only show alias on label if user has access to DocumentType within settings: [NL]\r\n\t\treturn this._inherited ? this.renderInheritedProperty() : this.renderEditableProperty();\r\n\t}\r\n\r\n\trenderInheritedProperty() {\r\n\t\tif (!this.property) return;\r\n\r\n\t\tif (this.sortModeActive) {\r\n\t\t\treturn this.renderSortableProperty();\r\n\t\t} else {\r\n\t\t\treturn html`\r\n\t\t\t\t<div id=\"header\">\r\n\t\t\t\t\t<b>${this.property.name}</b>\r\n\t\t\t\t\t<i>${this.property.alias}</i>\r\n\t\t\t\t\t<p>${this.property.description}</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div id=\"editor\">\r\n\t\t\t\t\t${this.renderPropertyTags()}\r\n\t\t\t\t\t${this._inherited\r\n\t\t\t\t\t\t? html`<uui-tag look=\"default\" class=\"inherited\">\r\n\t\t\t\t\t\t\t\t<uui-icon name=\"icon-merge\"></uui-icon>\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t>${this.localize.term('contentTypeEditor_inheritedFrom')}\r\n\t\t\t\t\t\t\t\t\t<a href=${this.editContentTypePath + 'edit/' + this._inheritedContentTypeId}>\r\n\t\t\t\t\t\t\t\t\t\t${this._inheritedContentTypeName ?? '??'}\r\n\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</uui-tag>`\r\n\t\t\t\t\t\t: nothing}\r\n\t\t\t\t</div>\r\n\t\t\t`;\r\n\t\t}\r\n\t}\r\n\r\n\trenderEditableProperty() {\r\n\t\tif (!this.property || !this.editPropertyTypePath) return;\r\n\r\n\t\tif (this.sortModeActive) {\r\n\t\t\treturn this.renderSortableProperty();\r\n\t\t} else {\r\n\t\t\treturn html`\r\n\t\t\t\t<div id=\"header\">\r\n\t\t\t\t\t<uui-input\r\n\t\t\t\t\t\tname=\"label\"\r\n\t\t\t\t\t\tid=\"label-input\"\r\n\t\t\t\t\t\tplaceholder=${this.localize.term('placeholders_label')}\r\n\t\t\t\t\t\tlabel=\"label\"\r\n\t\t\t\t\t\t.value=${this.property.name}\r\n\t\t\t\t\t\t@input=${this.#onNameChanged}></uui-input>\r\n\t\t\t\t\t${this.renderPropertyAlias()}\r\n\t\t\t\t\t<slot name=\"action-menu\"></slot>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<uui-textarea\r\n\t\t\t\t\t\t\tlabel=\"description\"\r\n\t\t\t\t\t\t\tname=\"description\"\r\n\t\t\t\t\t\t\tid=\"description-input\"\r\n\t\t\t\t\t\t\tplaceholder=${this.localize.term('placeholders_enterDescription')}\r\n\t\t\t\t\t\t\t.value=${this.property.description}\r\n\t\t\t\t\t\t\t@input=${(e: CustomEvent) => {\r\n\t\t\t\t\t\t\t\tif (e.target) this.#singleValueUpdate('description', (e.target as HTMLInputElement).value);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tauto-height></uui-textarea>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tid=\"editor\"\r\n\t\t\t\t\tlook=\"outline\"\r\n\t\t\t\t\tlabel=${this.localize.term('contentTypeEditor_editorSettings')}\r\n\t\t\t\t\thref=${this.editPropertyTypePath +\r\n\t\t\t\t\tUMB_EDIT_PROPERTY_TYPE_WORKSPACE_PATH_PATTERN.generateLocal({ unique: this.property.unique })}>\r\n\t\t\t\t\t${this.renderPropertyTags()}\r\n\t\t\t\t\t<uui-action-bar>\r\n\t\t\t\t\t\t<uui-button label=\"${this.localize.term('actions_delete')}\" @click=\"${this.#requestRemove}\">\r\n\t\t\t\t\t\t\t<uui-icon name=\"delete\"></uui-icon>\r\n\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t</uui-action-bar>\r\n\t\t\t\t</uui-button>\r\n\t\t\t`;\r\n\t\t}\r\n\t}\r\n\r\n\t#onPropertyOrderChanged = (e: UUIInputEvent) =>\r\n\t\tthis.#partialUpdate({ sortOrder: parseInt(e.target.value as string) ?? 0 } as UmbPropertyTypeModel);\r\n\r\n\trenderSortableProperty() {\r\n\t\tif (!this.property) return;\r\n\t\treturn html`\r\n\t\t\t<div class=\"sortable\">\r\n\t\t\t\t<uui-icon name=\"icon-grip\"></uui-icon>\r\n\t\t\t\t<span>${this.property.name}</span>\r\n\t\t\t\t<span style=\"color: var(--uui-color-disabled-contrast)\">(${this.property.alias})</span>\r\n\t\t\t</div>\r\n\t\t\t<uui-input\r\n\t\t\t\ttype=\"number\"\r\n\t\t\t\t?disabled=${this._inherited}\r\n\t\t\t\tlabel=\"sort order\"\r\n\t\t\t\t@change=${this.#onPropertyOrderChanged}\r\n\t\t\t\t.value=${(this.property.sortOrder ?? 0).toString()}></uui-input>\r\n\t\t`;\r\n\t}\r\n\r\n\trenderPropertyAlias() {\r\n\t\tif (!this.property) return;\r\n\t\treturn html`\r\n\t\t\t<uui-input-lock\r\n\t\t\t\tname=\"alias\"\r\n\t\t\t\tid=\"alias-input\"\r\n\t\t\t\tlabel=${this.localize.term('placeholders_enterAlias')}\r\n\t\t\t\tplaceholder=${this.localize.term('placeholders_enterAlias')}\r\n\t\t\t\t.value=${this.property.alias}\r\n\t\t\t\t?locked=${this._aliasLocked}\r\n\t\t\t\t@input=${this.#onAliasChanged}\r\n\t\t\t\t@lock-change=${this.#onToggleAliasLock}>\r\n\t\t\t</uui-input-lock>\r\n\t\t`;\r\n\t}\r\n\r\n\trenderPropertyTags() {\r\n\t\treturn this.property\r\n\t\t\t? html`<div class=\"types\">\r\n\t\t\t\t\t${this.property.dataType?.unique ? html`<uui-tag look=\"default\">${this._dataTypeName}</uui-tag>` : nothing}\r\n\t\t\t\t\t${this.#renderVariantTags()}\r\n\t\t\t\t\t${this.property.appearance?.labelOnTop == true\r\n\t\t\t\t\t\t? html`<uui-tag look=\"default\">\r\n\t\t\t\t\t\t\t\t<span>${this.localize.term('contentTypeEditor_displaySettingsLabelOnTop')}</span>\r\n\t\t\t\t\t\t\t</uui-tag>`\r\n\t\t\t\t\t\t: nothing}\r\n\t\t\t\t\t${this.property.validation.mandatory === true\r\n\t\t\t\t\t\t? html`<uui-tag look=\"default\">\r\n\t\t\t\t\t\t\t\t<span>* ${this.localize.term('general_mandatory')}</span>\r\n\t\t\t\t\t\t\t</uui-tag>`\r\n\t\t\t\t\t\t: nothing}\r\n\t\t\t\t\t${this.property.visibility?.memberCanView === true\r\n\t\t\t\t\t\t? html`<uui-tag look=\"default\">\r\n\t\t\t\t\t\t\t\t<uui-icon name=\"icon-eye\"></uui-icon> ${this.localize.term('contentTypeEditor_showOnMemberProfile')}\r\n\t\t\t\t\t\t\t</uui-tag>`\r\n\t\t\t\t\t\t: nothing}\r\n\t\t\t\t\t${this.property.visibility?.memberCanEdit === true\r\n\t\t\t\t\t\t? html`<uui-tag look=\"default\">\r\n\t\t\t\t\t\t\t\t<uui-icon name=\"icon-edit\"></uui-icon> ${this.localize.term('contentTypeEditor_memberCanEdit')}\r\n\t\t\t\t\t\t\t</uui-tag>`\r\n\t\t\t\t\t\t: nothing}\r\n\t\t\t\t\t${this.property.isSensitive === true\r\n\t\t\t\t\t\t? html`<uui-tag look=\"default\">\r\n\t\t\t\t\t\t\t\t<uui-icon name=\"icon-lock\"></uui-icon> ${this.localize.term('contentTypeEditor_isSensitiveData')}\r\n\t\t\t\t\t\t\t</uui-tag>`\r\n\t\t\t\t\t\t: nothing}\r\n\t\t\t\t</div>`\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\t#renderVariantTags() {\r\n\t\tif (!this.property) return nothing;\r\n\r\n\t\tif (\r\n\t\t\tthis.ownerVariesByCulture &&\r\n\t\t\tthis.ownerVariesBySegment &&\r\n\t\t\t!this.property.variesByCulture &&\r\n\t\t\t!this.property.variesBySegment\r\n\t\t) {\r\n\t\t\treturn html`\r\n\t\t\t\t<uui-tag look=\"default\">\r\n\t\t\t\t\t<uui-icon name=\"icon-shared-value\"></uui-icon> ${this.localize.term(\r\n\t\t\t\t\t\t'contentTypeEditor_cultureAndVariantInvariantLabel',\r\n\t\t\t\t\t)}\r\n\t\t\t\t</uui-tag>\r\n\t\t\t`;\r\n\t\t}\r\n\r\n\t\tif (this.ownerVariesByCulture && !this.property.variesByCulture) {\r\n\t\t\treturn html`<uui-tag look=\"default\">\r\n\t\t\t\t<uui-icon name=\"icon-shuffle\"></uui-icon> ${this.localize.term('contentTypeEditor_cultureInvariantLabel')}\r\n\t\t\t</uui-tag>`;\r\n\t\t}\r\n\r\n\t\tif (this.ownerVariesBySegment && !this.property.variesBySegment) {\r\n\t\t\treturn html`<uui-tag look=\"default\">\r\n\t\t\t\t<uui-icon name=\"icon-shuffle\"></uui-icon> ${this.localize.term('contentTypeEditor_segmentInvariantLabel')}\r\n\t\t\t</uui-tag>`;\r\n\t\t}\r\n\r\n\t\t// Not shared:\r\n\t\treturn nothing;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host(:not([sort-mode-active])) {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-template-columns: 200px auto;\r\n\t\t\t\tcolumn-gap: var(--uui-size-layout-2);\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-divider);\r\n\t\t\t\tpadding: var(--uui-size-layout-1) 0;\r\n\t\t\t\tcontainer-type: inline-size;\r\n\t\t\t}\r\n\r\n\t\t\t:host > div {\r\n\t\t\t\tgrid-column: span 2;\r\n\t\t\t}\r\n\r\n\t\t\t@container (width > 600px) {\r\n\t\t\t\t:host(:not([orientation='vertical'])) > div {\r\n\t\t\t\t\tgrid-column: span 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t:host(:first-of-type) {\r\n\t\t\t\tpadding-top: 0;\r\n\t\t\t}\r\n\t\t\t:host(:last-of-type) {\r\n\t\t\t\tborder-bottom: none;\r\n\t\t\t}\r\n\r\n\t\t\t:host([sort-mode-active]) {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tpadding: 0;\r\n\t\t\t\tmargin-bottom: var(--uui-size-3);\r\n\t\t\t}\r\n\r\n\t\t\t:host([sort-mode-active]:last-of-type) {\r\n\t\t\t\tmargin-bottom: 0;\r\n\t\t\t}\r\n\r\n\t\t\t:host([sort-mode-active]:not([_inherited])) {\r\n\t\t\t\tcursor: grab;\r\n\t\t\t}\r\n\r\n\t\t\t:host([sort-mode-active]) .sortable {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tpadding: 0 var(--uui-size-3);\r\n\t\t\t\tgap: var(--uui-size-3);\r\n\t\t\t}\r\n\t\t\t:host([sort-mode-active][_inherited]) .sortable {\r\n\t\t\t\tcolor: var(--uui-color-disabled-contrast);\r\n\t\t\t}\r\n\t\t\t:host([sort-mode-active]:not([_inherited])) .sortable {\r\n\t\t\t\tbackground-color: var(--uui-color-divider);\r\n\t\t\t}\r\n\r\n\t\t\t:host([sort-mode-active]) uui-input {\r\n\t\t\t\tmax-width: 75px;\r\n\t\t\t}\r\n\r\n\t\t\t/* Placeholder style, used when property is being dragged.*/\r\n\t\t\t:host(.--umb-sorter-placeholder) > * {\r\n\t\t\t\tvisibility: hidden;\r\n\t\t\t}\r\n\r\n\t\t\t:host(.--umb-sorter-placeholder)::after {\r\n\t\t\t\tcontent: '';\r\n\t\t\t\tinset: 0;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tborder: 1px dashed var(--uui-color-divider-emphasis);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t}\r\n\r\n\t\t\tp {\r\n\t\t\t\tmargin-bottom: 0;\r\n\t\t\t}\r\n\r\n\t\t\t#header {\r\n\t\t\t\tposition: sticky;\r\n\t\t\t\ttop: var(--uui-size-space-4);\r\n\t\t\t\theight: min-content;\r\n\t\t\t}\r\n\r\n\t\t\t#editor {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\t--uui-button-background-color: var(--uui-color-background);\r\n\t\t\t\t--uui-button-background-color-hover: var(--uui-color-background);\r\n\t\t\t}\r\n\t\t\t#editor uui-action-bar {\r\n\t\t\t\t--uui-button-background-color: var(--uui-color-surface);\r\n\t\t\t\t--uui-button-background-color-hover: var(--uui-color-surface);\r\n\t\t\t}\r\n\t\t\t#alias-input,\r\n\t\t\t#label-input,\r\n\t\t\t#description-input {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#alias-input {\r\n\t\t\t\tborder-color: transparent;\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t}\r\n\r\n\t\t\t#label-input {\r\n\t\t\t\tfont-weight: bold; /* TODO: UUI Input does not support bold text yet */\r\n\t\t\t\t--uui-input-border-color: transparent;\r\n\t\t\t}\r\n\t\t\t#label-input input {\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\t--uui-input-border-color: transparent;\r\n\t\t\t}\r\n\r\n\t\t\t#description-input {\r\n\t\t\t\t--uui-textarea-border-color: transparent;\r\n\t\t\t\tfont-weight: 0.5rem; /* TODO: Cant change font size of UUI textarea yet */\r\n\t\t\t}\r\n\r\n\t\t\t.types > div uui-icon,\r\n\t\t\t.inherited uui-icon {\r\n\t\t\t\tvertical-align: sub;\r\n\t\t\t\tmargin-right: var(--uui-size-space-1);\r\n\t\t\t}\r\n\r\n\t\t\t.inherited {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: var(--uui-size-space-2);\r\n\t\t\t\tright: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t.types {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: var(--uui-size-space-2);\r\n\t\t\t\tleft: var(--uui-size-space-2);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-flow: wrap;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t#editor uui-action-bar {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: var(--uui-size-space-2);\r\n\t\t\t\tright: var(--uui-size-space-2);\r\n\t\t\t\topacity: 0;\r\n\t\t\t}\r\n\r\n\t\t\t#editor:hover uui-action-bar,\r\n\t\t\t#editor:focus uui-action-bar,\r\n\t\t\t#editor:focus-within uui-action-bar {\r\n\t\t\t\topacity: 1;\r\n\t\t\t}\r\n\r\n\t\t\ta {\r\n\t\t\t\tcolor: inherit;\r\n\t\t\t}\r\n\r\n\t\t\t:host([drag-placeholder]) {\r\n\t\t\t\topacity: 0.5;\r\n\t\t\t}\r\n\t\t\t:host([drag-placeholder]) uui-input {\r\n\t\t\t\tvisibility: hidden;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-content-type-design-editor-property': UmbContentTypeDesignEditorPropertyElement;\r\n\t}\r\n}\r\n","import { UMB_CONTENT_TYPE_WORKSPACE_CONTEXT } from '../../content-type-workspace.context-token.js';\r\nimport type { UmbContentTypeModel, UmbPropertyTypeModel } from '../../../types.js';\r\nimport { UmbContentTypePropertyStructureHelper } from '../../../structure/index.js';\r\nimport type { UmbContentTypeDesignEditorPropertyElement } from './content-type-design-editor-property.element.js';\r\nimport { UMB_CONTENT_TYPE_DESIGN_EDITOR_CONTEXT } from './content-type-design-editor.context-token.js';\r\nimport {\r\n\tcss,\r\n\tcustomElement,\r\n\thtml,\r\n\tifDefined,\r\n\tproperty,\r\n\trepeat,\r\n\tstate,\r\n\twhen,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { type UmbSorterConfig, UmbSorterController } from '@umbraco-cms/backoffice/sorter';\r\nimport { UmbModalRouteRegistrationController } from '@umbraco-cms/backoffice/router';\r\nimport {\r\n\tUMB_CREATE_PROPERTY_TYPE_WORKSPACE_PATH_PATTERN,\r\n\tUMB_PROPERTY_TYPE_WORKSPACE_MODAL,\r\n} from '@umbraco-cms/backoffice/property-type';\r\n\r\nimport './content-type-design-editor-property.element.js';\r\n\r\nconst SORTER_CONFIG: UmbSorterConfig<UmbPropertyTypeModel, UmbContentTypeDesignEditorPropertyElement> = {\r\n\tgetUniqueOfElement: (element) => {\r\n\t\treturn element.getAttribute('data-umb-property-id');\r\n\t},\r\n\tgetUniqueOfModel: (modelEntry) => {\r\n\t\treturn modelEntry.unique;\r\n\t},\r\n\tidentifier: 'content-type-property-sorter',\r\n\titemSelector: 'umb-content-type-design-editor-property',\r\n\t//disabledItemSelector: '[inherited]',\r\n\t//TODO: Set the property list (sorter wrapper) to inherited, if its inherited\r\n\t// This is because we don't want to move local properties into an inherited group container.\r\n\t// Or maybe we do, but we still need to check if the group exists locally, if not, then it needs to be created before we move a property into it.\r\n\t// TODO: Fix bug where a local property turn into an inherited when moved to a new group container.\r\n\tcontainerSelector: '#property-list',\r\n};\r\n\r\n@customElement('umb-content-type-design-editor-properties')\r\nexport class UmbContentTypeDesignEditorPropertiesElement extends UmbLitElement {\r\n\t#sorter = new UmbSorterController<UmbPropertyTypeModel, UmbContentTypeDesignEditorPropertyElement>(this, {\r\n\t\t...SORTER_CONFIG,\r\n\t\tonChange: ({ model }) => {\r\n\t\t\tthis._properties = model;\r\n\t\t},\r\n\t\tonContainerChange: ({ item }) => {\r\n\t\t\tif (this._containerId === undefined) {\r\n\t\t\t\tthrow new Error('ContainerId is not set');\r\n\t\t\t}\r\n\t\t\tthis.#propertyStructureHelper.partialUpdateProperty(item.unique, {\r\n\t\t\t\tcontainer: this._containerId ? { id: this._containerId } : null,\r\n\t\t\t});\r\n\t\t},\r\n\t\tonEnd: ({ item }) => {\r\n\t\t\tif (this._containerId === undefined) {\r\n\t\t\t\tthrow new Error('ContainerId is not set.');\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t * Explanation: If the item is the first in list, we compare it to the item behind it to set a sortOrder.\r\n\t\t\t * If it's not the first in list, we will compare to the item in before it, and check the following item to see if it caused overlapping sortOrder, then update\r\n\t\t\t * the overlap if true, which may cause another overlap, so we loop through them till no more overlaps...\r\n\t\t\t */\r\n\t\t\tconst model = this._properties;\r\n\t\t\tconst newIndex = model.findIndex((entry) => entry.unique === item.unique);\r\n\r\n\t\t\t// Doesn't exist in model\r\n\t\t\tif (newIndex === -1) return;\r\n\r\n\t\t\t// As origin we set prev sort order to -1, so if no other then our item will become 0\r\n\t\t\tlet prevSortOrder = -1;\r\n\r\n\t\t\t// Not first in list\r\n\t\t\tif (newIndex > 0 && model.length > 0) {\r\n\t\t\t\tprevSortOrder = model[newIndex - 1].sortOrder;\r\n\t\t\t}\r\n\r\n\t\t\t// increase the prevSortOrder and use it for the moved item,\r\n\t\t\tthis.#propertyStructureHelper.partialUpdateProperty(item.unique, {\r\n\t\t\t\tsortOrder: ++prevSortOrder,\r\n\t\t\t});\r\n\r\n\t\t\t// Adjust everyone right after, meaning until there is a gap between the sortOrders:\r\n\t\t\tlet i = newIndex + 1;\r\n\t\t\tlet entry: UmbPropertyTypeModel | undefined;\r\n\t\t\t// As long as there is an item with the index & the sortOrder is less or equal to the prevSortOrder, we will update the sortOrder:\r\n\t\t\twhile ((entry = model[i]) !== undefined && entry.sortOrder <= prevSortOrder) {\r\n\t\t\t\t// Increase the prevSortOrder and use it for the item:\r\n\t\t\t\tthis.#propertyStructureHelper.partialUpdateProperty(entry.unique, {\r\n\t\t\t\t\tsortOrder: ++prevSortOrder,\r\n\t\t\t\t});\r\n\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonRequestDrop: async ({ unique }) => {\r\n\t\t\tconst context = await this.getContext(UMB_CONTENT_TYPE_WORKSPACE_CONTEXT);\r\n\t\t\tif (!context) {\r\n\t\t\t\tthrow new Error('Could not get Workspace Context');\r\n\t\t\t}\r\n\t\t\treturn context.structure.getOwnerPropertyById(unique);\r\n\t\t},\r\n\t\trequestExternalRemove: async ({ item }) => {\r\n\t\t\tconst context = await this.getContext(UMB_CONTENT_TYPE_WORKSPACE_CONTEXT);\r\n\t\t\tif (!context) {\r\n\t\t\t\tthrow new Error('Could not get Workspace Context');\r\n\t\t\t}\r\n\t\t\treturn await context.structure.removeProperty(null, item.unique).then(\r\n\t\t\t\t() => true,\r\n\t\t\t\t() => false,\r\n\t\t\t);\r\n\t\t},\r\n\t\trequestExternalInsert: async ({ item }) => {\r\n\t\t\tconst context = await this.getContext(UMB_CONTENT_TYPE_WORKSPACE_CONTEXT);\r\n\t\t\tif (!context) {\r\n\t\t\t\tthrow new Error('Could not get Workspace Context');\r\n\t\t\t}\r\n\t\t\tconst parent = this._containerId ? { id: this._containerId } : null;\r\n\t\t\tconst updatedItem = { ...item, parent };\r\n\t\t\treturn await context.structure.insertProperty(null, updatedItem).then(\r\n\t\t\t\t() => true,\r\n\t\t\t\t() => false,\r\n\t\t\t);\r\n\t\t},\r\n\t});\r\n\r\n\tprivate _containerId: string | null | undefined;\r\n\r\n\t@property({ type: String, attribute: 'container-id', reflect: false })\r\n\tpublic get containerId(): string | null | undefined {\r\n\t\treturn this._containerId;\r\n\t}\r\n\tpublic set containerId(value: string | null | undefined) {\r\n\t\tif (value === this._containerId) return;\r\n\t\tthis._containerId = value;\r\n\t\tthis.createPropertyTypeWorkspaceRoutes();\r\n\t\tthis.#propertyStructureHelper.setContainerId(value);\r\n\t\tthis.#addPropertyModal?.setUniquePathValue('container-id', value === null ? 'root' : value);\r\n\t\tthis.#editPropertyModal?.setUniquePathValue('container-id', value === null ? 'root' : value);\r\n\t}\r\n\r\n\t#addPropertyModal?: UmbModalRouteRegistrationController<\r\n\t\ttypeof UMB_PROPERTY_TYPE_WORKSPACE_MODAL.DATA,\r\n\t\ttypeof UMB_PROPERTY_TYPE_WORKSPACE_MODAL.VALUE\r\n\t>;\r\n\t#editPropertyModal?: UmbModalRouteRegistrationController<\r\n\t\ttypeof UMB_PROPERTY_TYPE_WORKSPACE_MODAL.DATA,\r\n\t\ttypeof UMB_PROPERTY_TYPE_WORKSPACE_MODAL.VALUE\r\n\t>;\r\n\r\n\t#propertyStructureHelper = new UmbContentTypePropertyStructureHelper<UmbContentTypeModel>(this);\r\n\r\n\t@property({ attribute: false })\r\n\teditContentTypePath?: string;\r\n\r\n\t@state()\r\n\tprivate _properties: Array<UmbPropertyTypeModel> = [];\r\n\r\n\t@state()\r\n\tprivate _ownerContentTypeUnique?: string;\r\n\r\n\t@state()\r\n\tprivate _ownerContentTypeVariesByCulture?: boolean;\r\n\r\n\t@state()\r\n\tprivate _ownerContentTypeVariesBySegment?: boolean;\r\n\r\n\t@state()\r\n\tprivate _newPropertyPath?: string;\r\n\r\n\t@state()\r\n\tprivate _editPropertyTypePath?: string;\r\n\r\n\t@state()\r\n\tprivate _sortModeActive?: boolean;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\t//this.#sorter.disable();\r\n\r\n\t\tthis.consumeContext(UMB_CONTENT_TYPE_DESIGN_EDITOR_CONTEXT, (context) => {\r\n\t\t\tthis.observe(\r\n\t\t\t\tcontext?.isSorting,\r\n\t\t\t\t(isSorting) => {\r\n\t\t\t\t\tthis._sortModeActive = isSorting;\r\n\t\t\t\t\tif (isSorting) {\r\n\t\t\t\t\t\t//this.#sorter.enable();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//this.#sorter.disable();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t'_observeIsSorting',\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_CONTENT_TYPE_WORKSPACE_CONTEXT, async (workspaceContext) => {\r\n\t\t\tif (workspaceContext) {\r\n\t\t\t\tthis.#propertyStructureHelper.setStructureManager(workspaceContext.structure);\r\n\t\t\t}\r\n\r\n\t\t\tthis._ownerContentTypeUnique = workspaceContext?.structure.getOwnerContentTypeUnique();\r\n\t\t\tthis.createPropertyTypeWorkspaceRoutes();\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tworkspaceContext?.variesByCulture,\r\n\t\t\t\t(variesByCulture) => {\r\n\t\t\t\t\tthis._ownerContentTypeVariesByCulture = variesByCulture;\r\n\t\t\t\t},\r\n\t\t\t\t'observeOwnerVariesByCulture',\r\n\t\t\t);\r\n\t\t\tthis.observe(\r\n\t\t\t\tworkspaceContext?.variesBySegment,\r\n\t\t\t\t(variesBySegment) => {\r\n\t\t\t\t\tthis._ownerContentTypeVariesBySegment = variesBySegment;\r\n\t\t\t\t},\r\n\t\t\t\t'observeOwnerVariesBySegment',\r\n\t\t\t);\r\n\t\t});\r\n\t\tthis.observe(this.#propertyStructureHelper.propertyStructure, (propertyStructure) => {\r\n\t\t\tthis._properties = propertyStructure;\r\n\t\t\tthis.#sorter.setModel(this._properties);\r\n\t\t});\r\n\t}\r\n\r\n\tcreatePropertyTypeWorkspaceRoutes() {\r\n\t\tif (!this._ownerContentTypeUnique || this._containerId === undefined) return;\r\n\r\n\t\t// Note: Route for adding a new property\r\n\t\tthis.#addPropertyModal?.destroy();\r\n\t\tthis.#addPropertyModal = new UmbModalRouteRegistrationController(\r\n\t\t\tthis,\r\n\t\t\tUMB_PROPERTY_TYPE_WORKSPACE_MODAL,\r\n\t\t\t'addPropertyModal',\r\n\t\t)\r\n\t\t\t.addUniquePaths(['container-id'])\r\n\t\t\t.addAdditionalPath('add-property/:sortOrder')\r\n\t\t\t.onSetup(async (params) => {\r\n\t\t\t\t// TODO: Make a onInit promise, that can be awaited here.\r\n\t\t\t\tif (!this._ownerContentTypeUnique || this._containerId === undefined) return false;\r\n\r\n\t\t\t\tconst preset: Partial<UmbPropertyTypeModel> = {};\r\n\t\t\t\tif (params.sortOrder !== undefined) {\r\n\t\t\t\t\tlet sortOrderInt = parseInt(params.sortOrder);\r\n\t\t\t\t\tif (sortOrderInt === -1) {\r\n\t\t\t\t\t\t// Find the highest sortOrder and add 1 to it:\r\n\t\t\t\t\t\tsortOrderInt = Math.max(...this._properties.map((x) => x.sortOrder), -1) + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreset.sortOrder = sortOrderInt;\r\n\t\t\t\t}\r\n\t\t\t\treturn { data: { contentTypeUnique: this._ownerContentTypeUnique, preset: preset } };\r\n\t\t\t})\r\n\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\tthis._newPropertyPath =\r\n\t\t\t\t\trouteBuilder({ sortOrder: '-1' }) +\r\n\t\t\t\t\tUMB_CREATE_PROPERTY_TYPE_WORKSPACE_PATH_PATTERN.generateLocal({\r\n\t\t\t\t\t\tcontainerUnique: this._containerId!,\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\tif (this._containerId !== undefined) {\r\n\t\t\tthis.#addPropertyModal?.setUniquePathValue(\r\n\t\t\t\t'container-id',\r\n\t\t\t\tthis._containerId === null ? 'root' : this._containerId,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.#editPropertyModal?.destroy();\r\n\t\tthis.#editPropertyModal = new UmbModalRouteRegistrationController(\r\n\t\t\tthis,\r\n\t\t\tUMB_PROPERTY_TYPE_WORKSPACE_MODAL,\r\n\t\t\t'editPropertyModal',\r\n\t\t)\r\n\t\t\t.addUniquePaths(['container-id'])\r\n\t\t\t.addAdditionalPath('edit-property')\r\n\t\t\t.onSetup(async () => {\r\n\t\t\t\tif (!this._ownerContentTypeUnique || this._containerId === undefined) return false;\r\n\t\t\t\treturn { data: { contentTypeUnique: this._ownerContentTypeUnique, preset: undefined } };\r\n\t\t\t})\r\n\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\tthis._editPropertyTypePath = routeBuilder(null);\r\n\t\t\t});\r\n\t\tif (this._containerId !== undefined) {\r\n\t\t\tthis.#editPropertyModal?.setUniquePathValue(\r\n\t\t\t\t'container-id',\r\n\t\t\t\tthis._containerId === null ? 'root' : this._containerId,\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn this._ownerContentTypeUnique\r\n\t\t\t? html`\r\n\t\t\t\t\t<div id=\"property-list\" ?sort-mode-active=${this._sortModeActive}>\r\n\t\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\t\tthis._properties,\r\n\t\t\t\t\t\t\t(property) => property.unique,\r\n\t\t\t\t\t\t\t(property) => {\r\n\t\t\t\t\t\t\t\treturn html`\r\n\t\t\t\t\t\t\t\t\t<umb-content-type-design-editor-property\r\n\t\t\t\t\t\t\t\t\t\tdata-umb-property-id=${property.unique}\r\n\t\t\t\t\t\t\t\t\t\tdata-mark=\"property-type:${property.name}\"\r\n\t\t\t\t\t\t\t\t\t\t.editContentTypePath=${this.editContentTypePath}\r\n\t\t\t\t\t\t\t\t\t\t.editPropertyTypePath=${this._editPropertyTypePath}\r\n\t\t\t\t\t\t\t\t\t\t?sort-mode-active=${this._sortModeActive}\r\n\t\t\t\t\t\t\t\t\t\t.propertyStructureHelper=${this.#propertyStructureHelper}\r\n\t\t\t\t\t\t\t\t\t\t.property=${property}\r\n\t\t\t\t\t\t\t\t\t\t.ownerVariesByCulture=${this._ownerContentTypeVariesByCulture}\r\n\t\t\t\t\t\t\t\t\t\t.ownerVariesBySegment=${this._ownerContentTypeVariesBySegment}>\r\n\t\t\t\t\t\t\t\t\t</umb-content-type-design-editor-property>\r\n\t\t\t\t\t\t\t\t`;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t${when(\r\n\t\t\t\t\t\t!this._sortModeActive,\r\n\t\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\tid=\"btn-add\"\r\n\t\t\t\t\t\t\t\thref=${ifDefined(this._newPropertyPath)}\r\n\t\t\t\t\t\t\t\tlabel=${this.localize.term('contentTypeEditor_addProperty')}\r\n\t\t\t\t\t\t\t\tlook=\"placeholder\"></uui-button>\r\n\t\t\t\t\t\t`,\r\n\t\t\t\t\t)}\r\n\t\t\t\t`\r\n\t\t\t: '';\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\r\n\t\t\t#property-list {\r\n\t\t\t\t/* enables dropping things into this despite it begin empty. */\r\n\t\t\t\tmargin-top: -20px;\r\n\t\t\t\tpadding-top: 20px;\r\n\t\t\t}\r\n\r\n\t\t\t#btn-add {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\t--uui-button-height: var(--uui-size-14);\r\n\t\t\t}\r\n\r\n\t\t\t#property-list[sort-mode-active]:not(:has(umb-content-type-design-editor-property)) {\r\n\t\t\t\t/* Some height so that the sorter can target the area if the group is empty*/\r\n\t\t\t\tmin-height: var(--uui-size-layout-1);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbContentTypeDesignEditorPropertiesElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-content-type-design-editor-properties': UmbContentTypeDesignEditorPropertiesElement;\r\n\t}\r\n}\r\n","import type { UmbContentTypeModel, UmbPropertyTypeContainerModel } from '../../../types.js';\r\nimport type { UmbContentTypeContainerStructureHelper } from '../../../structure/index.js';\r\nimport { css, customElement, html, nothing, property, repeat, state, when } from '@umbraco-cms/backoffice/external/lit';\r\nimport { umbConfirmModal } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbLitElement, umbFocus } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UUIBlinkAnimationValue, UUIBlinkKeyframes, type UUIInputEvent } from '@umbraco-cms/backoffice/external/uui';\r\n\r\nimport './content-type-design-editor-properties.element.js';\r\n\r\n@customElement('umb-content-type-design-editor-group')\r\nexport class UmbContentTypeWorkspaceViewEditGroupElement extends UmbLitElement {\r\n\t@property({ attribute: false })\r\n\tpublic set group(value: UmbPropertyTypeContainerModel | undefined) {\r\n\t\tif (value === this._group) return;\r\n\t\tthis._group = value;\r\n\t\tthis._groupId = value?.id;\r\n\t\tthis.#checkInherited();\r\n\t}\r\n\tpublic get group(): UmbPropertyTypeContainerModel | undefined {\r\n\t\treturn this._group;\r\n\t}\r\n\tprivate _group?: UmbPropertyTypeContainerModel | undefined;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic set groupStructureHelper(value: UmbContentTypeContainerStructureHelper<UmbContentTypeModel> | undefined) {\r\n\t\tif (value === this._groupStructureHelper) return;\r\n\t\tthis._groupStructureHelper = value;\r\n\t\tthis.#checkInherited();\r\n\t}\r\n\tpublic get groupStructureHelper(): UmbContentTypeContainerStructureHelper<UmbContentTypeModel> | undefined {\r\n\t\treturn this._groupStructureHelper;\r\n\t}\r\n\tprivate _groupStructureHelper?: UmbContentTypeContainerStructureHelper<UmbContentTypeModel> | undefined;\r\n\r\n\t@property({ type: Boolean, attribute: 'sort-mode-active', reflect: true })\r\n\tsortModeActive = false;\r\n\r\n\t@property({ attribute: false })\r\n\teditContentTypePath?: string;\r\n\r\n\t@state()\r\n\t_groupId?: string;\r\n\r\n\t@state()\r\n\t_hasOwnerContainer?: boolean;\r\n\r\n\t@state()\r\n\t_inherited?: boolean;\r\n\r\n\t@state()\r\n\t_inheritedFrom?: Array<UmbContentTypeModel>;\r\n\r\n\t#checkInherited() {\r\n\t\tif (this.groupStructureHelper && this.group) {\r\n\t\t\t// Check is this container matches with any other group. If so it is inherited aka. merged with others. [NL]\r\n\t\t\tif (this.group.name) {\r\n\t\t\t\t// We can first match with something if we have a name [NL]\r\n\t\t\t\tthis.observe(\r\n\t\t\t\t\tthis.groupStructureHelper.containersByNameAndType(this.group.name, 'Group'),\r\n\t\t\t\t\t(containers) => {\r\n\t\t\t\t\t\tconst ownerContainer = containers.find((con) => this.groupStructureHelper!.isOwnerChildContainer(con.id));\r\n\t\t\t\t\t\tconst hasAOwnerContainer = !!ownerContainer;\r\n\t\t\t\t\t\tconst pureOwnerContainer = hasAOwnerContainer && containers.length === 1;\r\n\r\n\t\t\t\t\t\tthis._hasOwnerContainer = hasAOwnerContainer;\r\n\t\t\t\t\t\tthis._inherited = !pureOwnerContainer;\r\n\t\t\t\t\t\tthis._inheritedFrom = containers\r\n\t\t\t\t\t\t\t.filter((con) => con.id !== ownerContainer?.id)\r\n\t\t\t\t\t\t\t.map((con) => this.groupStructureHelper!.getContentTypeOfContainer(con.id))\r\n\t\t\t\t\t\t\t.filter((contentType) => contentType !== undefined) as Array<UmbContentTypeModel>;\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'observeGroupContainers',\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\t// We use name match to determine inheritance, so no name cannot inherit.\r\n\t\t\t\tthis._inherited = false;\r\n\t\t\t\tthis._hasOwnerContainer = true;\r\n\t\t\t\tthis.removeUmbControllerByAlias('observeGroupContainers');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t_singleValueUpdate(propertyName: string, value: string | number | boolean | null | undefined) {\r\n\t\tif (!this._groupStructureHelper || !this.group) return;\r\n\r\n\t\tconst partialObject = {} as any;\r\n\t\tpartialObject[propertyName] = value;\r\n\r\n\t\tthis._groupStructureHelper.partialUpdateContainer(this.group.id, partialObject);\r\n\t}\r\n\r\n\t#renameGroup(e: InputEvent) {\r\n\t\tif (!this.groupStructureHelper || !this._group) return;\r\n\t\tlet newName = (e.target as HTMLInputElement).value;\r\n\t\tconst changedName = this.groupStructureHelper\r\n\t\t\t.getStructureManager()!\r\n\t\t\t.makeContainerNameUniqueForOwnerContentType(this._group.id, newName, 'Group', this._group.parent?.id ?? null);\r\n\t\tif (changedName) {\r\n\t\t\tnewName = changedName;\r\n\t\t}\r\n\t\tthis._singleValueUpdate('name', newName);\r\n\t\t(e.target as HTMLInputElement).value = newName;\r\n\t}\r\n\r\n\t#blurGroup(e: InputEvent) {\r\n\t\tif (!this.groupStructureHelper || !this._group) return;\r\n\t\tconst newName = (e.target as HTMLInputElement).value;\r\n\t\tif (newName === '') {\r\n\t\t\tconst changedName = this.groupStructureHelper\r\n\t\t\t\t.getStructureManager()!\r\n\t\t\t\t.makeEmptyContainerName(this._group.id, 'Group', this._group.parent?.id ?? null);\r\n\t\t\tthis._singleValueUpdate('name', changedName);\r\n\t\t\t(e.target as HTMLInputElement).value = changedName;\r\n\t\t}\r\n\t}\r\n\r\n\tasync #requestRemove(e: Event) {\r\n\t\te.preventDefault();\r\n\t\te.stopImmediatePropagation();\r\n\t\tif (!this.groupStructureHelper || !this._group) return;\r\n\r\n\t\t// TODO: Do proper localization here: [NL]\r\n\t\tawait umbConfirmModal(this, {\r\n\t\t\theadline: `${this.localize.term('actions_delete')} group`,\r\n\t\t\tcontent: html`<umb-localize key=\"contentTypeEditor_confirmDeleteGroupMessage\" .args=${[\r\n\t\t\t\tthis._group.name ?? this._group.id,\r\n\t\t\t]}>\r\n\t\t\t\t\tAre you sure you want to delete the group <strong>${this._group.name ?? this._group.id}</strong>\r\n\t\t\t\t</umb-localize>\r\n\t\t\t\t</div>`,\r\n\t\t\tconfirmLabel: this.localize.term('actions_delete'),\r\n\t\t\tcolor: 'danger',\r\n\t\t});\r\n\r\n\t\tthis.groupStructureHelper.removeContainer(this._group.id);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (this._inherited === undefined || !this._groupId) return nothing;\r\n\t\treturn html`\r\n\t\t\t<uui-box>\r\n\t\t\t\t${this.#renderContainerHeader()}\r\n\t\t\t\t<umb-content-type-design-editor-properties\r\n\t\t\t\t\t.editContentTypePath=${this.editContentTypePath}\r\n\t\t\t\t\t.containerId=${this._groupId}></umb-content-type-design-editor-properties>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\t// TODO: impl UMB_EDIT_DOCUMENT_TYPE_PATH_PATTERN, but we need either a generic type or a way to get the path pattern.... [NL]\r\n\t#renderContainerHeader() {\r\n\t\treturn html`\r\n\t\t\t<div slot=\"header\" class=\"drag-handle\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t${when(this.sortModeActive && this._hasOwnerContainer, () => html`<uui-icon name=\"icon-grip\"></uui-icon>`)}\r\n\t\t\t\t\t<uui-input\r\n\t\t\t\t\t\tid=\"group-name\"\r\n\t\t\t\t\t\tlabel=${this.localize.term('contentTypeEditor_group')}\r\n\t\t\t\t\t\tplaceholder=${this.localize.term('placeholders_entername')}\r\n\t\t\t\t\t\t.value=${this._group!.name}\r\n\t\t\t\t\t\t?disabled=${!this._hasOwnerContainer}\r\n\t\t\t\t\t\t@blur=${this.#blurGroup}\r\n\t\t\t\t\t\t@change=${this.#renameGroup}\r\n\t\t\t\t\t\t${this._group!.name === '' ? umbFocus() : nothing}\r\n\t\t\t\t\t\tauto-width></uui-input>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div slot=\"header-actions\">\r\n\t\t\t\t${when(\r\n\t\t\t\t\tthis._hasOwnerContainer === false && this._inheritedFrom && this._inheritedFrom.length > 0,\r\n\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t<uui-tag look=\"default\" class=\"inherited\">\r\n\t\t\t\t\t\t\t<uui-icon name=\"icon-merge\"></uui-icon>\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t>${this.localize.term('contentTypeEditor_inheritedFrom')}\r\n\t\t\t\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\t\t\t\tthis._inheritedFrom!,\r\n\t\t\t\t\t\t\t\t\t(inherited) => inherited.unique,\r\n\t\t\t\t\t\t\t\t\t(inherited) => html`\r\n\t\t\t\t\t\t\t\t\t\t<a href=${this.editContentTypePath + 'edit/' + inherited.unique}>${inherited.name}</a>\r\n\t\t\t\t\t\t\t\t\t`,\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</uui-tag>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t\t${when(\r\n\t\t\t\t\t!this._inherited && !this.sortModeActive,\r\n\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t<uui-button compact label=${this.localize.term('actions_delete')} @click=${this.#requestRemove}>\r\n\t\t\t\t\t\t\t<uui-icon name=\"delete\"></uui-icon>\r\n\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t\t${when(\r\n\t\t\t\t\tthis.sortModeActive,\r\n\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t<uui-input\r\n\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\tlabel=${this.localize.term('sort_sortOrder')}\r\n\t\t\t\t\t\t\t.value=${this.group!.sortOrder.toString()}\r\n\t\t\t\t\t\t\t?disabled=${!this._hasOwnerContainer}\r\n\t\t\t\t\t\t\t@change=${(e: UUIInputEvent) =>\r\n\t\t\t\t\t\t\t\tthis._singleValueUpdate('sortOrder', parseInt(e.target.value as string) ?? 0)}></uui-input>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tUUIBlinkKeyframes,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tposition: relative;\r\n\t\t\t}\r\n\r\n\t\t\t:host([drag-placeholder]) {\r\n\t\t\t\topacity: 0.5;\r\n\t\t\t}\r\n\r\n\t\t\t:host::before,\r\n\t\t\t:host::after {\r\n\t\t\t\tcontent: '';\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t\tinset: 0;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\topacity: 0;\r\n\t\t\t\ttransition:\r\n\t\t\t\t\topacity 60ms linear 1ms,\r\n\t\t\t\t\tborder-color,\r\n\t\t\t\t\t10ms;\r\n\t\t\t}\r\n\r\n\t\t\t:host::after {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tz-index: 1;\r\n\t\t\t\tborder: 2px solid transparent;\r\n\t\t\t}\r\n\r\n\t\t\t:host([drag-placeholder])::after {\r\n\t\t\t\topacity: 1;\r\n\t\t\t\tborder-color: var(--uui-color-interactive-emphasis);\r\n\t\t\t\tanimation: ${UUIBlinkAnimationValue};\r\n\t\t\t}\r\n\t\t\t:host([drag-placeholder])::before {\r\n\t\t\t\tbackground-color: var(--uui-color-interactive-emphasis);\r\n\t\t\t\topacity: 0.12;\r\n\t\t\t}\r\n\r\n\t\t\t:host([drag-placeholder]) uui-box {\r\n\t\t\t\t--uui-box-default-padding: 0;\r\n\t\t\t}\r\n\t\t\t:host([drag-placeholder]) div[slot='header'],\r\n\t\t\t:host([drag-placeholder]) div[slot='header-actions'] {\r\n\t\t\t\ttransition: opacity 60ms linear 1ms;\r\n\t\t\t\topacity: 0;\r\n\t\t\t}\r\n\t\t\t:host([drag-placeholder]) umb-content-type-design-editor-properties {\r\n\t\t\t\tvisibility: hidden;\r\n\t\t\t\tdisplay: none;\r\n\t\t\t}\r\n\r\n\t\t\tuui-box {\r\n\t\t\t\t--uui-box-header-padding: 0;\r\n\t\t\t}\r\n\r\n\t\t\tdiv[slot='header'] {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\tcursor: grab;\r\n\t\t\t\tpadding: var(--uui-size-space-4) var(--uui-size-space-5);\r\n\t\t\t}\r\n\r\n\t\t\tdiv[slot='header'] > div {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-3);\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#group-name {\r\n\t\t\t\t--uui-input-border-color: transparent;\r\n\t\t\t\tmin-width: 200px;\r\n\t\t\t}\r\n\r\n\t\t\tuui-input[type='number'] {\r\n\t\t\t\tmax-width: 75px;\r\n\t\t\t}\r\n\r\n\t\t\t.inherited uui-icon {\r\n\t\t\t\tvertical-align: sub;\r\n\t\t\t}\r\n\r\n\t\t\tdiv[slot='header-actions'] {\r\n\t\t\t\tpadding: var(--uui-size-space-4) var(--uui-size-space-5);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbContentTypeWorkspaceViewEditGroupElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-content-type-design-editor-group': UmbContentTypeWorkspaceViewEditGroupElement;\r\n\t}\r\n}\r\n","import { UMB_CONTENT_TYPE_WORKSPACE_CONTEXT } from '../../content-type-workspace.context-token.js';\r\nimport type { UmbContentTypeModel, UmbPropertyTypeContainerModel } from '../../../types.js';\r\nimport { UmbContentTypeContainerStructureHelper } from '../../../structure/index.js';\r\nimport { UMB_CONTENT_TYPE_DESIGN_EDITOR_CONTEXT } from './content-type-design-editor.context-token.js';\r\nimport type { UmbContentTypeWorkspaceViewEditGroupElement } from './content-type-design-editor-group.element.js';\r\nimport { css, customElement, html, nothing, property, repeat, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbModalRouteRegistrationController } from '@umbraco-cms/backoffice/router';\r\nimport { UmbSorterController } from '@umbraco-cms/backoffice/sorter';\r\nimport { UMB_WORKSPACE_MODAL } from '@umbraco-cms/backoffice/workspace';\r\nimport type { UmbSorterConfig } from '@umbraco-cms/backoffice/sorter';\r\n\r\nimport './content-type-design-editor-properties.element.js';\r\nimport './content-type-design-editor-group.element.js';\r\n\r\nconst SORTER_CONFIG: UmbSorterConfig<UmbPropertyTypeContainerModel, UmbContentTypeWorkspaceViewEditGroupElement> = {\r\n\tgetUniqueOfElement: (element) => element.group?.id,\r\n\tgetUniqueOfModel: (modelEntry) => modelEntry.id,\r\n\t// TODO: Make specific to the current owner document. [NL]\r\n\tidentifier: 'content-type-container-sorter',\r\n\titemSelector: 'umb-content-type-design-editor-group',\r\n\thandleSelector: '.drag-handle',\r\n\tcontainerSelector: '.container-list',\r\n};\r\n\r\n@customElement('umb-content-type-design-editor-tab')\r\nexport class UmbContentTypeDesignEditorTabElement extends UmbLitElement {\r\n\t#sorter = new UmbSorterController<UmbPropertyTypeContainerModel, UmbContentTypeWorkspaceViewEditGroupElement>(this, {\r\n\t\t...SORTER_CONFIG,\r\n\t\tonChange: ({ model }) => {\r\n\t\t\tthis._groups = model;\r\n\t\t},\r\n\t\tonEnd: ({ item }) => {\r\n\t\t\t/*if (this._inherited === undefined) {\r\n\t\t\t\tthrow new Error('OwnerTabId is not set, we have not made a local duplicated of this container.');\r\n\t\t\t\treturn;\r\n\t\t\t}*/\r\n\t\t\t/**\r\n\t\t\t * Explanation: If the item is the first in list, we compare it to the item behind it to set a sortOrder.\r\n\t\t\t * If it's not the first in list, we will compare to the item in before it, and check the following item to see if it caused overlapping sortOrder, then update\r\n\t\t\t * the overlap if true, which may cause another overlap, so we loop through them till no more overlaps...\r\n\t\t\t */\r\n\t\t\tconst model = this._groups;\r\n\t\t\tconst newIndex = model.findIndex((entry) => entry.id === item.id);\r\n\r\n\t\t\t// Doesn't exist in model\r\n\t\t\tif (newIndex === -1) return;\r\n\r\n\t\t\t// As origin we set prev sort order to -1, so if no other then our item will become 0\r\n\t\t\tlet prevSortOrder = -1;\r\n\r\n\t\t\t// Not first in list\r\n\t\t\tif (newIndex > 0 && model.length > 0) {\r\n\t\t\t\tprevSortOrder = model[newIndex - 1].sortOrder;\r\n\t\t\t}\r\n\r\n\t\t\t// increase the prevSortOrder and use it for the moved item,\r\n\t\t\tthis.#groupStructureHelper.partialUpdateContainer(item.id, {\r\n\t\t\t\tsortOrder: ++prevSortOrder,\r\n\t\t\t});\r\n\r\n\t\t\t// Adjust everyone right after, meaning until there is a gap between the sortOrders:\r\n\t\t\tlet i = newIndex + 1;\r\n\t\t\tlet entry: UmbPropertyTypeContainerModel | undefined;\r\n\t\t\t// As long as there is an item with the index & the sortOrder is less or equal to the prevSortOrder, we will update the sortOrder:\r\n\t\t\twhile ((entry = model[i]) !== undefined && entry.sortOrder <= prevSortOrder) {\r\n\t\t\t\t// Increase the prevSortOrder and use it for the item:\r\n\t\t\t\tthis.#groupStructureHelper.partialUpdateContainer(entry.id, {\r\n\t\t\t\t\tsortOrder: ++prevSortOrder,\r\n\t\t\t\t});\r\n\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonRequestDrop: async ({ unique }) => {\r\n\t\t\tconst context = await this.getContext(UMB_CONTENT_TYPE_WORKSPACE_CONTEXT);\r\n\t\t\tif (!context) {\r\n\t\t\t\tthrow new Error('Could not get Workspace Context');\r\n\t\t\t}\r\n\t\t\treturn context.structure.getOwnerContainerById(unique);\r\n\t\t},\r\n\t\trequestExternalRemove: async ({ item }) => {\r\n\t\t\tconst context = await this.getContext(UMB_CONTENT_TYPE_WORKSPACE_CONTEXT);\r\n\t\t\tif (!context) {\r\n\t\t\t\tthrow new Error('Could not get Workspace Context');\r\n\t\t\t}\r\n\t\t\treturn await context.structure.removeContainer(null, item.id, { preventRemovingProperties: true }).then(\r\n\t\t\t\t() => true,\r\n\t\t\t\t() => false,\r\n\t\t\t);\r\n\t\t},\r\n\t\trequestExternalInsert: async ({ item }) => {\r\n\t\t\tconst context = await this.getContext(UMB_CONTENT_TYPE_WORKSPACE_CONTEXT);\r\n\t\t\tif (!context) {\r\n\t\t\t\tthrow new Error('Could not get Workspace Context');\r\n\t\t\t}\r\n\t\t\tconst parent = this.#containerId ? { id: this.#containerId } : null;\r\n\t\t\tconst updatedItem = { ...item, parent };\r\n\t\t\treturn await context.structure.insertContainer(null, updatedItem).then(\r\n\t\t\t\t() => true,\r\n\t\t\t\t() => false,\r\n\t\t\t);\r\n\t\t},\r\n\t});\r\n\r\n\t#workspaceModal?: UmbModalRouteRegistrationController<\r\n\t\ttypeof UMB_WORKSPACE_MODAL.DATA,\r\n\t\ttypeof UMB_WORKSPACE_MODAL.VALUE\r\n\t>;\r\n\t#containerId?: string | null;\r\n\r\n\t@property({ type: String })\r\n\tpublic get containerId(): string | null | undefined {\r\n\t\treturn this.#containerId;\r\n\t}\r\n\tpublic set containerId(value: string | null | undefined) {\r\n\t\tconst oldValue = this.#containerId;\r\n\t\tif (value === this.#containerId) return;\r\n\t\tthis.#containerId = value;\r\n\t\tthis.#groupStructureHelper.setContainerId(value);\r\n\t\tthis.requestUpdate('containerId', oldValue);\r\n\t}\r\n\r\n\t@state()\r\n\t_groups: Array<UmbPropertyTypeContainerModel> = [];\r\n\r\n\t@state()\r\n\t_hasProperties = false;\r\n\r\n\t@state()\r\n\t_sortModeActive?: boolean;\r\n\r\n\t@state()\r\n\t_editContentTypePath?: string;\r\n\r\n\t#groupStructureHelper = new UmbContentTypeContainerStructureHelper<UmbContentTypeModel>(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_CONTENT_TYPE_WORKSPACE_CONTEXT, (context) => {\r\n\t\t\tthis.#groupStructureHelper.setStructureManager(context?.structure);\r\n\r\n\t\t\tconst entityType = context?.getEntityType();\r\n\r\n\t\t\tthis.#workspaceModal?.destroy();\r\n\t\t\tthis.#workspaceModal = new UmbModalRouteRegistrationController(this, UMB_WORKSPACE_MODAL)\r\n\t\t\t\t.addAdditionalPath(entityType ?? 'unknown')\r\n\t\t\t\t.onSetup(async () => {\r\n\t\t\t\t\treturn { data: { entityType: entityType, preset: {} } };\r\n\t\t\t\t})\r\n\t\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\t\tthis._editContentTypePath = routeBuilder({});\r\n\t\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_CONTENT_TYPE_DESIGN_EDITOR_CONTEXT, (context) => {\r\n\t\t\tthis.observe(\r\n\t\t\t\tcontext?.isSorting,\r\n\t\t\t\t(isSorting) => {\r\n\t\t\t\t\tthis._sortModeActive = isSorting;\r\n\t\t\t\t\tif (isSorting) {\r\n\t\t\t\t\t\tthis.#sorter.enable();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.#sorter.disable();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t'_observeIsSorting',\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#groupStructureHelper.mergedContainers,\r\n\t\t\t(groups) => {\r\n\t\t\t\tthis._groups = groups;\r\n\t\t\t\tthis.#sorter.setModel(this._groups);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#groupStructureHelper.hasProperties,\r\n\t\t\t(hasProperties) => {\r\n\t\t\t\tthis._hasProperties = hasProperties;\r\n\t\t\t\tthis.requestUpdate('_hasProperties');\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t}\r\n\r\n\t#onAddGroup = () => {\r\n\t\t// Idea, maybe we can gather the sortOrder from the last group rendered and add 1 to it?\r\n\t\tconst len = this._groups.length;\r\n\t\tconst sortOrder = len === 0 ? 0 : this._groups[len - 1].sortOrder + 1;\r\n\t\tthis.#groupStructureHelper.addContainer(this.#containerId, sortOrder);\r\n\t};\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t${\r\n\t\t\t\tthis.#containerId\r\n\t\t\t\t\t? html`\r\n\t\t\t\t\t\t\t<uui-box class=\"${this._hasProperties ? '' : 'opaque'}\">\r\n\t\t\t\t\t\t\t\t<umb-content-type-design-editor-properties\r\n\t\t\t\t\t\t\t\t\t.containerId=${this.containerId}\r\n\t\t\t\t\t\t\t\t\t.editContentTypePath=${this._editContentTypePath}></umb-content-type-design-editor-properties>\r\n\t\t\t\t\t\t\t</uui-box>\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t: nothing\r\n\t\t\t}\r\n\r\n\t\t\t\t<div class=\"container-list\" ?sort-mode-active=${this._sortModeActive}>\r\n\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\tthis._groups,\r\n\t\t\t\t\t\t(group) => group.id,\r\n\t\t\t\t\t\t(group) => html`\r\n\t\t\t\t\t\t\t<umb-content-type-design-editor-group\r\n\t\t\t\t\t\t\t\t?sort-mode-active=${this._sortModeActive}\r\n\t\t\t\t\t\t\t\t.editContentTypePath=${this._editContentTypePath}\r\n\t\t\t\t\t\t\t\t.group=${group}\r\n\t\t\t\t\t\t\t\t.groupStructureHelper=${this.#groupStructureHelper as any}\r\n\t\t\t\t\t\t\t\tdata-umb-group-id=${group.id}\r\n\t\t\t\t\t\t\t\tdata-mark=\"group:${group.name}\">\r\n\t\t\t\t\t\t\t</umb-content-type-design-editor-group>\r\n\t\t\t\t\t\t`,\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t${this.#renderAddGroupButton()}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderAddGroupButton() {\r\n\t\tif (this._sortModeActive) return;\r\n\t\treturn html`\r\n\t\t\t<uui-button\r\n\t\t\t\tid=\"btn-add\"\r\n\t\t\t\tlabel=${this.localize.term('contentTypeEditor_addGroup')}\r\n\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t@click=${this.#onAddGroup}></uui-button>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t#btn-add {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\t--uui-button-height: var(--uui-size-24);\r\n\t\t\t}\r\n\r\n\t\t\tuui-box,\r\n\t\t\tumb-content-type-design-editor-group {\r\n\t\t\t\tmargin-bottom: var(--uui-size-layout-1);\r\n\t\t\t}\r\n\t\t\tuui-box.opaque {\r\n\t\t\t\tbackground-color: transparent;\r\n\t\t\t\tborder-color: transparent;\r\n\t\t\t}\r\n\r\n\t\t\t.container-list {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgap: 10px;\r\n\t\t\t\talign-content: start;\r\n\t\t\t}\r\n\r\n\t\t\t.container-list #convert-to-tab {\r\n\t\t\t\tmargin-bottom: var(--uui-size-layout-1);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbContentTypeDesignEditorTabElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-content-type-design-editor-tab': UmbContentTypeDesignEditorTabElement;\r\n\t}\r\n}\r\n"],"names":["UmbPropertyTypeContext","UmbContextBase","host","UMB_PROPERTY_TYPE_CONTEXT","#alias","UmbStringState","#label","alias","label","_context","_dataTypeDetailRepository","_dataTypeUnique","_propertyUnique","_autoGenerateAlias","_UmbContentTypeDesignEditorPropertyElement_instances","checkAliasAutoGenerate_fn","checkInherited_fn","partialUpdate_fn","singleValueUpdate_fn","onToggleAliasLock_fn","setDataType_fn","requestRemove_fn","onAliasChanged_fn","onNameChanged_fn","_onPropertyOrderChanged","renderVariantTags_fn","UmbContentTypeDesignEditorPropertyElement","UmbLitElement","__privateAdd","UmbDataTypeDetailRepository","e","__privateMethod","value","oldValue","__privateGet","html","nothing","UMB_EDIT_PROPERTY_TYPE_WORKSPACE_PATH_PATTERN","unique","__privateSet","contentType","partialObject","propertyName","event","dataTypeUnique","x","umbConfirmModal","newName","generateAlias","UmbTextStyles","css","__decorateClass","property","state","customElement","_sorter","_addPropertyModal","_editPropertyModal","_propertyStructureHelper","SORTER_CONFIG","element","modelEntry","UmbContentTypeDesignEditorPropertiesElement","UmbSorterController","model","item","newIndex","entry","prevSortOrder","context","UMB_CONTENT_TYPE_WORKSPACE_CONTEXT","parent","updatedItem","UmbContentTypePropertyStructureHelper","UMB_CONTENT_TYPE_DESIGN_EDITOR_CONTEXT","isSorting","workspaceContext","variesByCulture","variesBySegment","propertyStructure","UmbModalRouteRegistrationController","UMB_PROPERTY_TYPE_WORKSPACE_MODAL","params","preset","sortOrderInt","routeBuilder","UMB_CREATE_PROPERTY_TYPE_WORKSPACE_PATH_PATTERN","repeat","when","ifDefined","_UmbContentTypeWorkspaceViewEditGroupElement_instances","renameGroup_fn","blurGroup_fn","renderContainerHeader_fn","UmbContentTypeWorkspaceViewEditGroupElement","containers","ownerContainer","con","hasAOwnerContainer","pureOwnerContainer","changedName","umbFocus","inherited","UUIBlinkKeyframes","UUIBlinkAnimationValue","_workspaceModal","_containerId","_groupStructureHelper","_onAddGroup","_UmbContentTypeDesignEditorTabElement_instances","renderAddGroupButton_fn","UmbContentTypeDesignEditorTabElement","UmbContentTypeContainerStructureHelper","len","sortOrder","entityType","UMB_WORKSPACE_MODAL","groups","hasProperties","group","UmbContentTypeDesignEditorTabElement$1"],"mappings":"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"}