{"version":3,"file":"property-editor-ui-collection.element-Bl-RVdoS.js","sources":["../../../src/packages/property-editors/collection/property-editor-ui-collection.element.ts"],"sourcesContent":["import type {\r\n\tUmbPropertyEditorConfigCollection,\r\n\tUmbPropertyEditorUiElement,\r\n} from '@umbraco-cms/backoffice/property-editor';\r\nimport { html, customElement, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UMB_DOCUMENT_COLLECTION_ALIAS } from '@umbraco-cms/backoffice/document';\r\nimport { UMB_PROPERTY_CONTEXT } from '@umbraco-cms/backoffice/property';\r\nimport { UMB_CONTENT_COLLECTION_WORKSPACE_CONTEXT } from '@umbraco-cms/backoffice/content';\r\nimport type { UmbCollectionConfiguration } from '@umbraco-cms/backoffice/collection';\r\n\r\n/**\r\n * @element umb-property-editor-ui-collection\r\n */\r\n@customElement('umb-property-editor-ui-collection')\r\nexport class UmbPropertyEditorUICollectionElement extends UmbLitElement implements UmbPropertyEditorUiElement {\r\n\t@property()\r\n\tvalue?: string;\r\n\r\n\t@state()\r\n\tprivate _collectionAlias: string = UMB_DOCUMENT_COLLECTION_ALIAS;\r\n\r\n\t@state()\r\n\tprivate _config?: UmbCollectionConfiguration;\r\n\r\n\tpublic set config(config: UmbPropertyEditorConfigCollection | undefined) {\r\n\t\tthis._config = this.#mapDataTypeConfigToCollectionConfig(config);\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_CONTENT_COLLECTION_WORKSPACE_CONTEXT, (workspaceContext) => {\r\n\t\t\tthis._collectionAlias = workspaceContext?.getCollectionAlias() ?? UMB_DOCUMENT_COLLECTION_ALIAS;\r\n\r\n\t\t\tthis.consumeContext(UMB_PROPERTY_CONTEXT, (propertyContext) => {\r\n\t\t\t\tthis.observe(propertyContext?.alias, async (propertyAlias) => {\r\n\t\t\t\t\tif (propertyAlias) {\r\n\t\t\t\t\t\t// Gets the Data Type ID for the current property.\r\n\t\t\t\t\t\tconst property = await workspaceContext!.structure.getPropertyStructureByAlias(propertyAlias);\r\n\t\t\t\t\t\tconst unique = workspaceContext!.getUnique();\r\n\t\t\t\t\t\tif (unique && property && this._config) {\r\n\t\t\t\t\t\t\tthis._config.unique = unique;\r\n\t\t\t\t\t\t\tthis._config.dataTypeId = property.dataType.unique;\r\n\t\t\t\t\t\t\tthis.requestUpdate('_config');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t#mapDataTypeConfigToCollectionConfig(\r\n\t\tconfig: UmbPropertyEditorConfigCollection | undefined,\r\n\t): UmbCollectionConfiguration {\r\n\t\tconst pageSize = Number(config?.getValueByAlias('pageSize'));\r\n\t\treturn {\r\n\t\t\tlayouts: config?.getValueByAlias('layouts'),\r\n\t\t\torderBy: config?.getValueByAlias('orderBy') ?? 'updateDate',\r\n\t\t\torderDirection: config?.getValueByAlias('orderDirection') ?? 'asc',\r\n\t\t\tpageSize: isNaN(pageSize) ? 50 : pageSize,\r\n\t\t\tuserDefinedProperties: config?.getValueByAlias('includeProperties'),\r\n\t\t};\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (!this._config?.unique || !this._config?.dataTypeId) return html`<uui-loader></uui-loader>`;\r\n\t\treturn html`<umb-collection .alias=${this._collectionAlias} .config=${this._config}></umb-collection>`;\r\n\t}\r\n}\r\n\r\nexport default UmbPropertyEditorUICollectionElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-property-editor-ui-collection': UmbPropertyEditorUICollectionElement;\r\n\t}\r\n}\r\n"],"names":["_UmbPropertyEditorUICollectionElement_instances","mapDataTypeConfigToCollectionConfig_fn","UmbPropertyEditorUICollectionElement","UmbLitElement","__privateAdd","UMB_DOCUMENT_COLLECTION_ALIAS","UMB_CONTENT_COLLECTION_WORKSPACE_CONTEXT","workspaceContext","UMB_PROPERTY_CONTEXT","propertyContext","propertyAlias","property","unique","config","__privateMethod","html","pageSize","__decorateClass","state","customElement","UmbPropertyEditorUICollectionElement$1"],"mappings":";;;;;;;;;;;8OAAAA,GAAAC;AAea,IAAAC,IAAN,cAAmDC,EAAoD;AAAA,EAc7G,cAAc;AACP,UAAA,GAfDC,EAAA,MAAAJ,CAAA,GAKN,KAAQ,mBAA2BK,GAY7B,KAAA,eAAeC,GAA0C,CAACC,MAAqB;AAC9E,WAAA,mBAAmBA,GAAkB,mBAAwB,KAAAF,GAE7D,KAAA,eAAeG,GAAsB,CAACC,MAAoB;AAC9D,aAAK,QAAQA,GAAiB,OAAO,OAAOC,MAAkB;AAC7D,cAAIA,GAAe;AAElB,kBAAMC,IAAW,MAAMJ,EAAkB,UAAU,4BAA4BG,CAAa,GACtFE,IAASL,EAAkB,UAAU;AACvC,YAAAK,KAAUD,KAAY,KAAK,YAC9B,KAAK,QAAQ,SAASC,GACjB,KAAA,QAAQ,aAAaD,EAAS,SAAS,QAC5C,KAAK,cAAc,SAAS;AAAA,UAC7B;AAAA,QACD,CACA;AAAA,MAAA,CACD;AAAA,IAAA,CACD;AAAA,EAAA;AAAA,EAxBF,IAAW,OAAOE,GAAuD;AACnE,SAAA,UAAUC,EAAK,MAAAd,GAAAC,CAAA,EAAL,KAA0C,MAAAY,CAAA;AAAA,EAAA;AAAA,EAuCjD,SAAS;AACb,WAAA,CAAC,KAAK,SAAS,UAAU,CAAC,KAAK,SAAS,aAAmBE,+BACxDA,2BAA8B,KAAK,gBAAgB,YAAY,KAAK,OAAO;AAAA,EAAA;AAEpF;AAtDOf,IAAA,oBAAA,QAAA;AAqCNC,IAAoC,SACnCY,GAC6B;AAC7B,QAAMG,IAAW,OAAOH,GAAQ,gBAAgB,UAAU,CAAC;AACpD,SAAA;AAAA,IACN,SAASA,GAAQ,gBAAgB,SAAS;AAAA,IAC1C,SAASA,GAAQ,gBAAgB,SAAS,KAAK;AAAA,IAC/C,gBAAgBA,GAAQ,gBAAgB,gBAAgB,KAAK;AAAA,IAC7D,UAAU,MAAMG,CAAQ,IAAI,KAAKA;AAAA,IACjC,uBAAuBH,GAAQ,gBAAgB,mBAAmB;AAAA,EACnE;AACD;AA9CAI,EAAA;AAAA,EADCN,EAAS;AAAA,GADET,EAEZ,WAAA,SAAA,CAAA;AAGQe,EAAA;AAAA,EADPC,EAAM;AAAA,GAJKhB,EAKJ,WAAA,oBAAA,CAAA;AAGAe,EAAA;AAAA,EADPC,EAAM;AAAA,GAPKhB,EAQJ,WAAA,WAAA,CAAA;AARIA,IAANe,EAAA;AAAA,EADNE,EAAc,mCAAmC;AAAA,GACrCjB,CAAA;AAwDb,MAAAkB,IAAelB;"}