{"version":3,"file":"input-content.element-ChvwYNyr.js","sources":["../../../src/packages/property-editors/content-picker/components/input-content/input-content.element.ts"],"sourcesContent":["import type { UmbContentPickerSource } from '../../types.js';\r\nimport { css, html, customElement, property } from '@umbraco-cms/backoffice/external/lit';\r\nimport { splitStringToArray } from '@umbraco-cms/backoffice/utils';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport { UmbFormControlMixin } from '@umbraco-cms/backoffice/validation';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbReferenceByUniqueAndType } from '@umbraco-cms/backoffice/models';\r\nimport type { UmbTreeStartNode } from '@umbraco-cms/backoffice/tree';\r\n\r\n@customElement('umb-input-content')\r\nexport class UmbInputContentElement extends UmbFormControlMixin<string | undefined, typeof UmbLitElement>(\r\n\tUmbLitElement,\r\n) {\r\n\t@property()\r\n\tpublic set type(newType: UmbContentPickerSource['type']) {\r\n\t\tconst oldType = this.#type;\r\n\t\tif (newType?.toLowerCase() !== this.#type) {\r\n\t\t\tthis.#type = newType?.toLowerCase() as UmbContentPickerSource['type'];\r\n\t\t\tthis.requestUpdate('type', oldType);\r\n\t\t}\r\n\t}\r\n\tpublic get type(): UmbContentPickerSource['type'] {\r\n\t\treturn this.#type;\r\n\t}\r\n\t#type: UmbContentPickerSource['type'] = 'content';\r\n\r\n\t@property({ type: Number })\r\n\tmin = 0;\r\n\r\n\t@property({ type: String, attribute: 'min-message' })\r\n\tminMessage = 'This field need more items';\r\n\r\n\t@property({ type: Number })\r\n\tmax = 0;\r\n\r\n\t@property({ type: String, attribute: 'max-message' })\r\n\tmaxMessage = 'This field exceeds the allowed amount of items';\r\n\r\n\t@property({ type: Object, attribute: false })\r\n\tstartNode?: UmbTreeStartNode;\r\n\r\n\t@property()\r\n\tpublic set allowedContentTypeIds(value: string) {\r\n\t\tthis.#allowedContentTypeIds = value ? value.split(',') : [];\r\n\t}\r\n\tpublic get allowedContentTypeIds(): string {\r\n\t\treturn this.#allowedContentTypeIds.join(',');\r\n\t}\r\n\t#allowedContentTypeIds: Array<string> = [];\r\n\r\n\t@property({ type: Array })\r\n\tpublic set selection(values: Array<UmbReferenceByUniqueAndType>) {\r\n\t\tthis.#selection = values?.map((item) => item.unique) ?? [];\r\n\t}\r\n\tpublic get selection(): Array<UmbReferenceByUniqueAndType> {\r\n\t\treturn this.#selection.map((id) => ({ type: this.#entityTypeLookup[this.#type], unique: id }));\r\n\t}\r\n\r\n\t@property({ type: String })\r\n\tpublic override set value(selectionString: string | undefined) {\r\n\t\tthis.#selection = splitStringToArray(selectionString);\r\n\t}\r\n\tpublic override get value(): string | undefined {\r\n\t\treturn this.#selection.length > 0 ? this.#selection.join(',') : undefined;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the input to readonly mode, meaning value cannot be changed but still able to read and select its content.\r\n\t * @type {boolean}\r\n\t * @attr\r\n\t * @default false\r\n\t */\r\n\t@property({ type: Boolean, reflect: true })\r\n\treadonly = false;\r\n\r\n\t#entityTypeLookup = { content: 'document', media: 'media', member: 'member' };\r\n\r\n\t#selection: Array<string> = [];\r\n\r\n\toverride firstUpdated() {\r\n\t\tthis.addFormControlElement(this.shadowRoot!.querySelector(`umb-input-${this.#entityTypeLookup[this.#type]}`)!);\r\n\t}\r\n\r\n\t#onChange(event: CustomEvent & { target: { selection: string[] | undefined } }) {\r\n\t\tthis.#selection = event.target.selection ?? [];\r\n\t\tthis.value = this.#selection.join(',');\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tswitch (this.#type) {\r\n\t\t\tcase 'content':\r\n\t\t\t\treturn this.#renderDocumentPicker();\r\n\t\t\tcase 'media':\r\n\t\t\t\treturn this.#renderMediaPicker();\r\n\t\t\tcase 'member':\r\n\t\t\t\treturn this.#renderMemberPicker();\r\n\t\t\tdefault:\r\n\t\t\t\treturn html`<p>Type could not be found.</p>`;\r\n\t\t}\r\n\t}\r\n\r\n\t#renderDocumentPicker() {\r\n\t\treturn html`\r\n\t\t\t<umb-input-document\r\n\t\t\t\t.selection=${this.#selection}\r\n\t\t\t\t.startNode=${this.startNode}\r\n\t\t\t\t.allowedContentTypeIds=${this.#allowedContentTypeIds}\r\n\t\t\t\t.min=${this.min}\r\n\t\t\t\t.minMessage=${this.minMessage}\r\n\t\t\t\t.max=${this.max}\r\n\t\t\t\t.maxMessage=${this.maxMessage}\r\n\t\t\t\t?readonly=${this.readonly}\r\n\t\t\t\t@change=${this.#onChange}></umb-input-document>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderMediaPicker() {\r\n\t\treturn html`\r\n\t\t\t<umb-input-media\r\n\t\t\t\t.selection=${this.#selection}\r\n\t\t\t\t.allowedContentTypeIds=${this.#allowedContentTypeIds}\r\n\t\t\t\t.min=${this.min}\r\n\t\t\t\t.minMessage=${this.minMessage}\r\n\t\t\t\t.max=${this.max}\r\n\t\t\t\t.maxMessage=${this.maxMessage}\r\n\t\t\t\t?readonly=${this.readonly}\r\n\t\t\t\t@change=${this.#onChange}></umb-input-media>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderMemberPicker() {\r\n\t\treturn html`\r\n\t\t\t<umb-input-member\r\n\t\t\t\t.selection=${this.#selection}\r\n\t\t\t\t.allowedContentTypeIds=${this.#allowedContentTypeIds}\r\n\t\t\t\t.min=${this.min}\r\n\t\t\t\t.minMessage=${this.minMessage}\r\n\t\t\t\t.max=${this.max}\r\n\t\t\t\t.maxMessage=${this.maxMessage}\r\n\t\t\t\t?readonly=${this.readonly}\r\n\t\t\t\t@change=${this.#onChange}></umb-input-member>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\tp {\r\n\t\t\t\tmargin: 0;\r\n\t\t\t\tcolor: var(--uui-color-border-emphasis);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport { UmbInputContentElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-input-content': UmbInputContentElement;\r\n\t}\r\n}\r\n"],"names":["_type","_allowedContentTypeIds","_entityTypeLookup","_selection","_UmbInputContentElement_instances","onChange_fn","renderDocumentPicker_fn","renderMediaPicker_fn","renderMemberPicker_fn","UmbInputContentElement","UmbFormControlMixin","UmbLitElement","__privateAdd","newType","oldType","__privateGet","__privateSet","value","values","item","id","selectionString","splitStringToArray","__privateMethod","html","event","UmbChangeEvent","css","__decorateClass","property","customElement"],"mappings":";;;;;;;;;;;wYAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAUO,IAAMC,IAAN,cAAqCC;AAAA,EAC3CC;AACD,EAAE;AAAA,EAFK,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAR,CAAA,GAckCQ,EAAA,MAAAZ,GAAA,SAAA,GAGlC,KAAA,MAAA,GAGO,KAAA,aAAA,8BAGP,KAAA,MAAA,GAGO,KAAA,aAAA,kDAYbY,EAAA,MAAAX,GAAwC,EAAC,GAyB9B,KAAA,WAAA,IAEXW,EAAA,MAAAV,GAAoB,EAAE,SAAS,YAAY,OAAO,SAAS,QAAQ,UAAS,GAE5EU,EAAA,MAAAT,GAA4B,EAAC;AAAA,EAAA;AAAA,EA/D7B,IAAW,KAAKU,GAAyC;AACxD,UAAMC,IAAUC,EAAK,MAAAf,CAAA;AACrB,IAAIa,GAAS,YAAkB,MAAAE,EAAA,MAAKf,CAAO,MACrCgB,EAAA,MAAAhB,GAAQa,GAAS,YAAY,CAAA,GAC7B,KAAA,cAAc,QAAQC,CAAO;AAAA,EACnC;AAAA,EAED,IAAW,OAAuC;AACjD,WAAOC,EAAK,MAAAf,CAAA;AAAA,EAAA;AAAA,EAoBb,IAAW,sBAAsBiB,GAAe;AAC/C,IAAAD,EAAA,MAAKf,GAAyBgB,IAAQA,EAAM,MAAM,GAAG,IAAI,EAAC;AAAA,EAAA;AAAA,EAE3D,IAAW,wBAAgC;AACnC,WAAAF,EAAA,MAAKd,CAAuB,EAAA,KAAK,GAAG;AAAA,EAAA;AAAA,EAK5C,IAAW,UAAUiB,GAA4C;AAC3D,IAAAF,EAAA,MAAAb,GAAae,GAAQ,IAAI,CAACC,MAASA,EAAK,MAAM,KAAK,EAAC;AAAA,EAAA;AAAA,EAE1D,IAAW,YAAgD;AAC1D,WAAOJ,EAAK,MAAAZ,CAAA,EAAW,IAAI,CAACiB,OAAQ,EAAE,MAAML,EAAK,MAAAb,CAAA,EAAkBa,EAAK,MAAAf,CAAA,CAAK,GAAG,QAAQoB,IAAK;AAAA,EAAA;AAAA,EAI9F,IAAoB,MAAMC,GAAqC;AACzD,IAAAL,EAAA,MAAAb,GAAamB,EAAmBD,CAAe,CAAA;AAAA,EAAA;AAAA,EAErD,IAAoB,QAA4B;AACxC,WAAAN,EAAA,MAAKZ,GAAW,SAAS,IAAIY,QAAKZ,CAAW,EAAA,KAAK,GAAG,IAAI;AAAA,EAAA;AAAA,EAgBxD,eAAe;AAClB,SAAA,sBAAsB,KAAK,WAAY,cAAc,aAAaY,EAAK,MAAAb,CAAA,EAAkBa,EAAK,MAAAf,CAAA,CAAK,CAAC,EAAE,CAAE;AAAA,EAAA;AAAA,EASrG,SAAS;AACjB,YAAQe,QAAKf,CAAO,GAAA;AAAA,MACnB,KAAK;AACJ,eAAOuB,QAAKnB,GAALE,CAAA,EAAA,KAAA,IAAA;AAAA,MACR,KAAK;AACJ,eAAOiB,QAAKnB,GAALG,CAAA,EAAA,KAAA,IAAA;AAAA,MACR,KAAK;AACJ,eAAOgB,QAAKnB,GAALI,CAAA,EAAA,KAAA,IAAA;AAAA,MACR;AACQ,eAAAgB;AAAA,IAAA;AAAA,EACT;AAsDF;AAjICxB,IAAA,oBAAA,QAAA;AAwBAC,IAAA,oBAAA,QAAA;AA2BAC,IAAA,oBAAA,QAAA;AAEAC,IAAA,oBAAA,QAAA;AAnEMC,IAAA,oBAAA,QAAA;AAyENC,IAAS,SAACoB,GAAsE;AAC/E,EAAAT,EAAA,MAAKb,GAAasB,EAAM,OAAO,aAAa,EAAC,GAC7C,KAAK,QAAQV,EAAA,MAAKZ,CAAW,EAAA,KAAK,GAAG,GAChC,KAAA,cAAc,IAAIuB,GAAgB;AACxC;AAeApB,IAAqB,WAAG;AAChB,SAAAkB;AAAA;AAAA,iBAEQT,QAAKZ,CAAU,CAAA;AAAA,iBACf,KAAK,SAAS;AAAA,6BACFY,QAAKd,CAAsB,CAAA;AAAA,WAC7C,KAAK,GAAG;AAAA,kBACD,KAAK,UAAU;AAAA,WACtB,KAAK,GAAG;AAAA,kBACD,KAAK,UAAU;AAAA,gBACjB,KAAK,QAAQ;AAAA,cACfsB,QAAKnB,GAASC,CAAA,CAAA;AAAA;AAE3B;AAEAE,IAAkB,WAAG;AACb,SAAAiB;AAAA;AAAA,iBAEQT,QAAKZ,CAAU,CAAA;AAAA,6BACHY,QAAKd,CAAsB,CAAA;AAAA,WAC7C,KAAK,GAAG;AAAA,kBACD,KAAK,UAAU;AAAA,WACtB,KAAK,GAAG;AAAA,kBACD,KAAK,UAAU;AAAA,gBACjB,KAAK,QAAQ;AAAA,cACfsB,QAAKnB,GAASC,CAAA,CAAA;AAAA;AAE3B;AAEAG,IAAmB,WAAG;AACd,SAAAgB;AAAA;AAAA,iBAEQT,QAAKZ,CAAU,CAAA;AAAA,6BACHY,QAAKd,CAAsB,CAAA;AAAA,WAC7C,KAAK,GAAG;AAAA,kBACD,KAAK,UAAU;AAAA,WACtB,KAAK,GAAG;AAAA,kBACD,KAAK,UAAU;AAAA,gBACjB,KAAK,QAAQ;AAAA,cACfsB,QAAKnB,GAASC,CAAA,CAAA;AAAA;AAE3B;AArIYI,EAuII,SAAS;AAAA,EACxBkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAMD;AA1IWC,EAAA;AAAA,EADVC,EAAS;AAAA,GAHEpB,EAID,WAAA,QAAA,CAAA;AAaXmB,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,OAAQ,CAAA;AAAA,GAhBdpB,EAiBZ,WAAA,OAAA,CAAA;AAGAmB,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAQ,WAAW,cAAe,CAAA;AAAA,GAnBxCpB,EAoBZ,WAAA,cAAA,CAAA;AAGAmB,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,OAAQ,CAAA;AAAA,GAtBdpB,EAuBZ,WAAA,OAAA,CAAA;AAGAmB,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAQ,WAAW,cAAe,CAAA;AAAA,GAzBxCpB,EA0BZ,WAAA,cAAA,CAAA;AAGAmB,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAQ,WAAW,GAAO,CAAA;AAAA,GA5BhCpB,EA6BZ,WAAA,aAAA,CAAA;AAGWmB,EAAA;AAAA,EADVC,EAAS;AAAA,GA/BEpB,EAgCD,WAAA,yBAAA,CAAA;AASAmB,EAAA;AAAA,EADVC,EAAS,EAAE,MAAM,MAAO,CAAA;AAAA,GAxCbpB,EAyCD,WAAA,aAAA,CAAA;AAQSmB,EAAA;AAAA,EADnBC,EAAS,EAAE,MAAM,OAAQ,CAAA;AAAA,GAhDdpB,EAiDQ,WAAA,SAAA,CAAA;AAcpBmB,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAS,SAAS,GAAM,CAAA;AAAA,GA9D9BpB,EA+DZ,WAAA,YAAA,CAAA;AA/DYA,IAANmB,EAAA;AAAA,EADNE,EAAc,mBAAmB;AAAA,GACrBrB,CAAA;"}