{"version":3,"file":"data-type-tree-item-table-collection-view.element-DHauD-1B.js","sources":["../../../src/packages/data-type/tree/tree-item-children/collection/views/data-type-tree-item-table-collection-view.element.ts"],"sourcesContent":["import type { UmbDataTypeTreeItemModel } from '../../../types.js';\r\nimport { UMB_EDIT_DATA_TYPE_WORKSPACE_PATH_PATTERN } from '../../../../paths.js';\r\nimport { UMB_EDIT_DATA_TYPE_FOLDER_WORKSPACE_PATH_PATTERN } from '../../../folder/index.js';\r\nimport type { UmbDefaultCollectionContext } from '@umbraco-cms/backoffice/collection';\r\nimport { UMB_COLLECTION_CONTEXT } from '@umbraco-cms/backoffice/collection';\r\nimport type { UmbTableColumn, UmbTableConfig, UmbTableItem } from '@umbraco-cms/backoffice/components';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbModalRouteRegistrationController, type UmbModalRouteBuilder } from '@umbraco-cms/backoffice/router';\r\nimport { UMB_WORKSPACE_MODAL } from '@umbraco-cms/backoffice/workspace';\r\n\r\n@customElement('umb-data-type-tree-item-table-collection-view')\r\nexport class UmbDataTypeTreeItemTableCollectionViewElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _tableConfig: UmbTableConfig = {\r\n\t\tallowSelection: false,\r\n\t};\r\n\r\n\t@state()\r\n\tprivate _tableColumns: Array<UmbTableColumn> = [\r\n\t\t{\r\n\t\t\tname: 'Name',\r\n\t\t\talias: 'name',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '',\r\n\t\t\talias: 'entityActions',\r\n\t\t\talign: 'right',\r\n\t\t},\r\n\t];\r\n\r\n\t@state()\r\n\tprivate _tableItems: Array<UmbTableItem> = [];\r\n\r\n\t#collectionContext?: UmbDefaultCollectionContext<any>;\r\n\t#routeBuilder?: UmbModalRouteBuilder;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_COLLECTION_CONTEXT, (instance) => {\r\n\t\t\tthis.#collectionContext = instance;\r\n\t\t});\r\n\r\n\t\tthis.#registerModalRoute();\r\n\t}\r\n\r\n\t#registerModalRoute() {\r\n\t\tnew UmbModalRouteRegistrationController(this, UMB_WORKSPACE_MODAL)\r\n\t\t\t.addAdditionalPath(':entityType')\r\n\t\t\t.onSetup((params) => {\r\n\t\t\t\treturn { data: { entityType: params.entityType, preset: {} } };\r\n\t\t\t})\r\n\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\tthis.#routeBuilder = routeBuilder;\r\n\r\n\t\t\t\t// NOTE: Configuring the observations AFTER the route builder is ready,\r\n\t\t\t\t// otherwise there is a race condition and `#collectionContext.items` tends to win. [LK]\r\n\t\t\t\tthis.#observeCollectionItems();\r\n\t\t\t});\r\n\t}\r\n\r\n\t#observeCollectionItems() {\r\n\t\tif (!this.#collectionContext) return;\r\n\t\tthis.observe(this.#collectionContext.items, (items) => this.#createTableItems(items), 'umbCollectionItemsObserver');\r\n\t}\r\n\r\n\t#createTableItems(items: Array<UmbDataTypeTreeItemModel>) {\r\n\t\tconst routeBuilder = this.#routeBuilder;\r\n\t\tif (!routeBuilder) throw new Error('Route builder not ready');\r\n\r\n\t\tthis._tableItems = items.map((item) => {\r\n\t\t\tconst modalEditPath =\r\n\t\t\t\trouteBuilder({ entityType: item.entityType }) +\r\n\t\t\t\tUMB_EDIT_DATA_TYPE_WORKSPACE_PATH_PATTERN.generateLocal({ unique: item.unique });\r\n\t\t\tconst inlineEditPath = UMB_EDIT_DATA_TYPE_FOLDER_WORKSPACE_PATH_PATTERN.generateAbsolute({\r\n\t\t\t\tunique: item.unique,\r\n\t\t\t});\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid: item.unique,\r\n\t\t\t\ticon: item.isFolder && !item.icon ? 'icon-folder' : item.icon,\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'name',\r\n\t\t\t\t\t\tvalue: html`<uui-button\r\n\t\t\t\t\t\t\thref=${item.isFolder ? inlineEditPath : modalEditPath}\r\n\t\t\t\t\t\t\tlabel=${item.name}></uui-button>`,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'entityActions',\r\n\t\t\t\t\t\tvalue: html`<umb-entity-actions-table-column-view\r\n\t\t\t\t\t\t\t.value=${{\r\n\t\t\t\t\t\t\t\tentityType: item.entityType,\r\n\t\t\t\t\t\t\t\tunique: item.unique,\r\n\t\t\t\t\t\t\t\tname: item.name,\r\n\t\t\t\t\t\t\t}}></umb-entity-actions-table-column-view>`,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-table .config=${this._tableConfig} .columns=${this._tableColumns} .items=${this._tableItems}></umb-table>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport { UmbDataTypeTreeItemTableCollectionViewElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t['umb-data-type-tree-item-table-collection-view']: UmbDataTypeTreeItemTableCollectionViewElement;\r\n\t}\r\n}\r\n"],"names":["_collectionContext","_routeBuilder","_UmbDataTypeTreeItemTableCollectionViewElement_instances","registerModalRoute_fn","observeCollectionItems_fn","createTableItems_fn","UmbDataTypeTreeItemTableCollectionViewElement","UmbLitElement","__privateAdd","UMB_COLLECTION_CONTEXT","instance","__privateSet","__privateMethod","html","UmbModalRouteRegistrationController","UMB_WORKSPACE_MODAL","params","routeBuilder","__privateGet","items","item","modalEditPath","UMB_EDIT_DATA_TYPE_WORKSPACE_PATH_PATTERN","inlineEditPath","UMB_EDIT_DATA_TYPE_FOLDER_WORKSPACE_PATH_PATTERN","UmbTextStyles","css","__decorateClass","state","customElement"],"mappings":"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"}