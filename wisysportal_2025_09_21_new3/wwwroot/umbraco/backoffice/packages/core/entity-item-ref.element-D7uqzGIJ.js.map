{"version":3,"file":"entity-item-ref.element-D7uqzGIJ.js","sources":["../../../src/packages/core/entity-item/entity-item-ref/default-item-ref.element.ts","../../../src/packages/core/entity-item/entity-item-ref/entity-item-ref.element.ts"],"sourcesContent":["import type { UmbDefaultItemModel } from '../types.js';\r\nimport { customElement, html, nothing, property } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\n\r\n@customElement('umb-default-item-ref')\r\nexport class UmbDefaultItemRefElement extends UmbLitElement {\r\n\t@property({ type: Object })\r\n\titem?: UmbDefaultItemModel;\r\n\r\n\t@property({ type: Boolean })\r\n\tstandalone = false;\r\n\r\n\toverride render() {\r\n\t\tif (!this.item) return nothing;\r\n\r\n\t\treturn html`\r\n\t\t\t<uui-ref-node name=${this.item.name} ?standalone=${this.standalone} readonly>\r\n\t\t\t\t<slot name=\"actions\" slot=\"actions\"></slot>\r\n\t\t\t\t${this.#renderIcon(this.item)}\r\n\t\t\t</uui-ref-node>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderIcon(item: UmbDefaultItemModel) {\r\n\t\tif (!item.icon) return;\r\n\t\treturn html`<umb-icon slot=\"icon\" name=${item.icon}></umb-icon>`;\r\n\t}\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-default-item-ref': UmbDefaultItemRefElement;\r\n\t}\r\n}\r\n","import type { ManifestEntityItemRef } from './entity-item-ref.extension.js';\r\nimport { customElement, property, type PropertyValueMap, state, css, html } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbExtensionsElementInitializer } from '@umbraco-cms/backoffice/extension-api';\r\nimport { UMB_MARK_ATTRIBUTE_NAME } from '@umbraco-cms/backoffice/const';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { UmbRoutePathAddendumContext } from '@umbraco-cms/backoffice/router';\r\nimport type { UmbEntityModel } from '@umbraco-cms/backoffice/entity';\r\n\r\nimport './default-item-ref.element.js';\r\nimport { UmbDeselectedEvent, UmbSelectedEvent } from '@umbraco-cms/backoffice/event';\r\n\r\n@customElement('umb-entity-item-ref')\r\nexport class UmbEntityItemRefElement extends UmbLitElement {\r\n\t#extensionsController?: UmbExtensionsElementInitializer<any>;\r\n\t#item?: UmbEntityModel;\r\n\r\n\t@state()\r\n\t_component?: any; // TODO: Add type\r\n\r\n\t@property({ type: Object, attribute: false })\r\n\tpublic get item(): UmbEntityModel | undefined {\r\n\t\treturn this.#item;\r\n\t}\r\n\tpublic set item(value: UmbEntityModel | undefined) {\r\n\t\tconst oldValue = this.#item;\r\n\t\tthis.#item = value;\r\n\r\n\t\tif (value === oldValue) return;\r\n\t\tif (!value) return;\r\n\r\n\t\t// If the component is already created and the entity type is the same, we can just update the item.\r\n\t\tif (this._component && value.entityType === oldValue?.entityType) {\r\n\t\t\tthis._component.item = value;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.#pathAddendum.setAddendum('ref/' + value.entityType + '/' + value.unique);\r\n\r\n\t\t// If the component is already created, but the entity type is different, we need to destroy the component.\r\n\t\tthis.#createController(value.entityType);\r\n\t}\r\n\r\n\t#readonly = false;\r\n\t@property({ type: Boolean, reflect: true })\r\n\tpublic get readonly() {\r\n\t\treturn this.#readonly;\r\n\t}\r\n\tpublic set readonly(value) {\r\n\t\tthis.#readonly = value;\r\n\r\n\t\tif (this._component) {\r\n\t\t\tthis._component.readonly = this.#readonly;\r\n\t\t}\r\n\t}\r\n\r\n\t#standalone = false;\r\n\t@property({ type: Boolean, reflect: true })\r\n\tpublic get standalone() {\r\n\t\treturn this.#standalone;\r\n\t}\r\n\tpublic set standalone(value) {\r\n\t\tthis.#standalone = value;\r\n\r\n\t\tif (this._component) {\r\n\t\t\tthis._component.standalone = this.#standalone;\r\n\t\t}\r\n\t}\r\n\r\n\t#selectOnly = false;\r\n\t@property({ type: Boolean, attribute: 'select-only', reflect: true })\r\n\tpublic get selectOnly() {\r\n\t\treturn this.#selectOnly;\r\n\t}\r\n\tpublic set selectOnly(value) {\r\n\t\tthis.#selectOnly = value;\r\n\r\n\t\tif (this._component) {\r\n\t\t\tthis._component.selectOnly = this.#selectOnly;\r\n\t\t}\r\n\t}\r\n\r\n\t#selectable = false;\r\n\t@property({ type: Boolean, reflect: true })\r\n\tpublic get selectable() {\r\n\t\treturn this.#selectable;\r\n\t}\r\n\tpublic set selectable(value) {\r\n\t\tthis.#selectable = value;\r\n\r\n\t\tif (this._component) {\r\n\t\t\tthis._component.selectable = this.#selectable;\r\n\t\t}\r\n\t}\r\n\r\n\t#selected = false;\r\n\t@property({ type: Boolean, reflect: true })\r\n\tpublic get selected() {\r\n\t\treturn this.#selected;\r\n\t}\r\n\tpublic set selected(value) {\r\n\t\tthis.#selected = value;\r\n\r\n\t\tif (this._component) {\r\n\t\t\tthis._component.selected = this.#selected;\r\n\t\t}\r\n\t}\r\n\r\n\t#disabled = false;\r\n\t@property({ type: Boolean, reflect: true })\r\n\tpublic get disabled() {\r\n\t\treturn this.#disabled;\r\n\t}\r\n\tpublic set disabled(value) {\r\n\t\tthis.#disabled = value;\r\n\r\n\t\tif (this._component) {\r\n\t\t\tthis._component.disabled = this.#disabled;\r\n\t\t}\r\n\t}\r\n\r\n\t#pathAddendum = new UmbRoutePathAddendumContext(this);\r\n\r\n\t#onSelected(event: UmbSelectedEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\tconst unique = this.#item?.unique;\r\n\t\tif (!unique) throw new Error('No unique id found for item');\r\n\t\tthis.dispatchEvent(new UmbSelectedEvent(unique));\r\n\t}\r\n\r\n\t#onDeselected(event: UmbDeselectedEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\tconst unique = this.#item?.unique;\r\n\t\tif (!unique) throw new Error('No unique id found for item');\r\n\t\tthis.dispatchEvent(new UmbDeselectedEvent(unique));\r\n\t}\r\n\r\n\tprotected override firstUpdated(_changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>): void {\r\n\t\tsuper.firstUpdated(_changedProperties);\r\n\t\tthis.setAttribute(UMB_MARK_ATTRIBUTE_NAME, 'entity-item-ref');\r\n\t}\r\n\r\n\t#createController(entityType: string) {\r\n\t\tif (this.#extensionsController) {\r\n\t\t\tthis.#extensionsController.destroy();\r\n\t\t}\r\n\r\n\t\tthis.#extensionsController = new UmbExtensionsElementInitializer(\r\n\t\t\tthis,\r\n\t\t\tumbExtensionsRegistry,\r\n\t\t\t'entityItemRef',\r\n\t\t\t(manifest: ManifestEntityItemRef) => manifest.forEntityTypes.includes(entityType),\r\n\t\t\t(extensionControllers) => {\r\n\t\t\t\tthis._component?.remove();\r\n\t\t\t\tconst component = extensionControllers[0]?.component || document.createElement('umb-default-item-ref');\r\n\r\n\t\t\t\t// assign the properties to the component\r\n\t\t\t\tcomponent.item = this.#item;\r\n\t\t\t\tcomponent.readonly = this.readonly;\r\n\t\t\t\tcomponent.standalone = this.standalone;\r\n\t\t\t\tcomponent.selectOnly = this.selectOnly;\r\n\t\t\t\tcomponent.selectable = this.selectable;\r\n\t\t\t\tcomponent.selected = this.selected;\r\n\t\t\t\tcomponent.disabled = this.disabled;\r\n\r\n\t\t\t\tcomponent.addEventListener(UmbSelectedEvent.TYPE, this.#onSelected.bind(this));\r\n\t\t\t\tcomponent.addEventListener(UmbDeselectedEvent.TYPE, this.#onDeselected.bind(this));\r\n\r\n\t\t\t\t// Proxy the actions slot to the component\r\n\t\t\t\tconst slotElement = document.createElement('slot');\r\n\t\t\t\tslotElement.name = 'actions';\r\n\t\t\t\tslotElement.setAttribute('slot', 'actions');\r\n\t\t\t\tcomponent.appendChild(slotElement);\r\n\r\n\t\t\t\tthis._component = component;\r\n\t\t\t},\r\n\t\t\tundefined, // We can leave the alias to undefined, as we destroy this our selfs.\r\n\t\t\tundefined,\r\n\t\t\t{ single: true },\r\n\t\t);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`${this._component}`;\r\n\t}\r\n\r\n\toverride destroy(): void {\r\n\t\tthis._component?.removeEventListener(UmbSelectedEvent.TYPE, this.#onSelected.bind(this));\r\n\t\tthis._component?.removeEventListener(UmbDeselectedEvent.TYPE, this.#onDeselected.bind(this));\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tposition: relative;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport { UmbEntityItemRefElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-entity-item-ref': UmbEntityItemRefElement;\r\n\t}\r\n}\r\n"],"names":["_UmbDefaultItemRefElement_instances","renderIcon_fn","UmbDefaultItemRefElement","UmbLitElement","__privateAdd","html","__privateMethod","nothing","item","__decorateClass","property","customElement","_extensionsController","_item","_readonly","_standalone","_selectOnly","_selectable","_selected","_disabled","_pathAddendum","_UmbEntityItemRefElement_instances","onSelected_fn","onDeselected_fn","createController_fn","UmbEntityItemRefElement","UmbRoutePathAddendumContext","__privateGet","value","oldValue","__privateSet","_changedProperties","UMB_MARK_ATTRIBUTE_NAME","UmbSelectedEvent","UmbDeselectedEvent","event","unique","entityType","UmbExtensionsElementInitializer","umbExtensionsRegistry","manifest","extensionControllers","component","slotElement","css","state"],"mappings":"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"}