{"version":3,"file":"rename-server-file.action-bL_Mh3mK.js","sources":["../../../src/packages/core/server-file-system/rename/modal/rename-server-file-modal.token.ts","../../../src/packages/core/server-file-system/rename/event/server-file-renamed.entity-event.ts","../../../src/packages/core/server-file-system/rename/rename-server-file.action.ts"],"sourcesContent":["import { UMB_RENAME_SERVER_FILE_MODAL_ALIAS } from './manifests.js';\r\nimport { UmbModalToken } from '@umbraco-cms/backoffice/modal';\r\n\r\nexport interface UmbRenameModalData {\r\n\trenameRepositoryAlias: string;\r\n\titemRepositoryAlias: string;\r\n\tunique: string;\r\n}\r\n\r\nexport interface UmbRenameServerFileModalValue {\r\n\tunique: string;\r\n\tname: string;\r\n}\r\n\r\nexport const UMB_RENAME_SERVER_FILE_MODAL = new UmbModalToken<UmbRenameModalData, UmbRenameServerFileModalValue>(\r\n\tUMB_RENAME_SERVER_FILE_MODAL_ALIAS,\r\n\t{\r\n\t\tmodal: {\r\n\t\t\ttype: 'sidebar',\r\n\t\t\tsize: 'small',\r\n\t\t},\r\n\t},\r\n);\r\n","import type { UmbServerFileRenamedEventArgs } from './types.js';\r\nimport { UmbEntityActionEvent } from '@umbraco-cms/backoffice/entity-action';\r\n\r\nexport class UmbServerFileRenamedEntityEvent extends UmbEntityActionEvent<UmbServerFileRenamedEventArgs> {\r\n\tstatic readonly TYPE = 'server-file-renamed';\r\n\r\n\tconstructor(args: UmbServerFileRenamedEventArgs) {\r\n\t\tsuper(UmbServerFileRenamedEntityEvent.TYPE, args);\r\n\t}\r\n\r\n\tgetNewUnique(): string {\r\n\t\treturn this._args.newUnique;\r\n\t}\r\n\r\n\tgetNewName(): string {\r\n\t\treturn this._args.newName;\r\n\t}\r\n}\r\n","import { UMB_RENAME_SERVER_FILE_MODAL } from './modal/rename-server-file-modal.token.js';\r\nimport type { MetaEntityActionRenameServerFileKind } from './types.js';\r\nimport { UmbServerFileRenamedEntityEvent } from './event/index.js';\r\nimport { UmbEntityActionBase, UmbRequestReloadStructureForEntityEvent } from '@umbraco-cms/backoffice/entity-action';\r\nimport { umbOpenModal } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_ACTION_EVENT_CONTEXT } from '@umbraco-cms/backoffice/action';\r\n\r\nexport class UmbRenameEntityAction extends UmbEntityActionBase<MetaEntityActionRenameServerFileKind> {\r\n\toverride async execute() {\r\n\t\tif (!this.args.unique) throw new Error('Unique is required to rename an entity');\r\n\r\n\t\tconst res = await umbOpenModal(this, UMB_RENAME_SERVER_FILE_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\tunique: this.args.unique,\r\n\t\t\t\trenameRepositoryAlias: this.args.meta.renameRepositoryAlias,\r\n\t\t\t\titemRepositoryAlias: this.args.meta.itemRepositoryAlias,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tconst actionEventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\r\n\t\tif (!actionEventContext) {\r\n\t\t\tthrow new Error('Event context not found.');\r\n\t\t}\r\n\t\tconst event = new UmbRequestReloadStructureForEntityEvent({\r\n\t\t\tunique: this.args.unique,\r\n\t\t\tentityType: this.args.entityType,\r\n\t\t});\r\n\r\n\t\tactionEventContext.dispatchEvent(event);\r\n\r\n\t\tconst event2 = new UmbServerFileRenamedEntityEvent({\r\n\t\t\tunique: this.args.unique,\r\n\t\t\tentityType: this.args.entityType,\r\n\t\t\tnewName: res.name,\r\n\t\t\tnewUnique: res.unique,\r\n\t\t});\r\n\r\n\t\tactionEventContext.dispatchEvent(event2);\r\n\t}\r\n}\r\n\r\nexport default UmbRenameEntityAction;\r\n"],"names":["UMB_RENAME_SERVER_FILE_MODAL","UmbModalToken","UMB_RENAME_SERVER_FILE_MODAL_ALIAS","UmbServerFileRenamedEntityEvent","UmbEntityActionEvent","args","UmbRenameEntityAction","UmbEntityActionBase","res","umbOpenModal","actionEventContext","UMB_ACTION_EVENT_CONTEXT","event","UmbRequestReloadStructureForEntityEvent","event2"],"mappings":";;;;AAcO,MAAMA,IAA+B,IAAIC;AAAA,EAC/CC;AAAA,EACA;AAAA,IACC,OAAO;AAAA,MACN,MAAM;AAAA,MACN,MAAM;AAAA,IAAA;AAAA,EACP;AAEF;ACnBO,MAAMC,UAAwCC,EAAoD;AAAA,EACxG,OAAA;AAAA,SAAgB,OAAO;AAAA,EAAA;AAAA,EAEvB,YAAYC,GAAqC;AAC1C,UAAAF,EAAgC,MAAME,CAAI;AAAA,EAAA;AAAA,EAGjD,eAAuB;AACtB,WAAO,KAAK,MAAM;AAAA,EAAA;AAAA,EAGnB,aAAqB;AACpB,WAAO,KAAK,MAAM;AAAA,EAAA;AAEpB;ACVO,MAAMC,UAA8BC,EAA0D;AAAA,EACpG,MAAe,UAAU;AACxB,QAAI,CAAC,KAAK,KAAK,OAAc,OAAA,IAAI,MAAM,wCAAwC;AAE/E,UAAMC,IAAM,MAAMC,EAAa,MAAMT,GAA8B;AAAA,MAClE,MAAM;AAAA,QACL,QAAQ,KAAK,KAAK;AAAA,QAClB,uBAAuB,KAAK,KAAK,KAAK;AAAA,QACtC,qBAAqB,KAAK,KAAK,KAAK;AAAA,MAAA;AAAA,IACrC,CACA,GAEKU,IAAqB,MAAM,KAAK,WAAWC,CAAwB;AACzE,QAAI,CAACD;AACE,YAAA,IAAI,MAAM,0BAA0B;AAErC,UAAAE,IAAQ,IAAIC,EAAwC;AAAA,MACzD,QAAQ,KAAK,KAAK;AAAA,MAClB,YAAY,KAAK,KAAK;AAAA,IAAA,CACtB;AAED,IAAAH,EAAmB,cAAcE,CAAK;AAEhC,UAAAE,IAAS,IAAIX,EAAgC;AAAA,MAClD,QAAQ,KAAK,KAAK;AAAA,MAClB,YAAY,KAAK,KAAK;AAAA,MACtB,SAASK,EAAI;AAAA,MACb,WAAWA,EAAI;AAAA,IAAA,CACf;AAED,IAAAE,EAAmB,cAAcI,CAAM;AAAA,EAAA;AAEzC;;;;;;"}