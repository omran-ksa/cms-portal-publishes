{"version":3,"file":"move-to.action-CspSKMcB.js","sources":["../../../src/packages/core/entity-bulk-action/common/move-to/move-to.action.ts"],"sourcesContent":["import { UmbEntityBulkActionBase } from '../../entity-bulk-action-base.js';\r\nimport type { UmbBulkMoveToRepository } from './move-to-repository.interface.js';\r\nimport { createExtensionApiByAlias } from '@umbraco-cms/backoffice/extension-registry';\r\nimport {\r\n\tUmbRequestReloadChildrenOfEntityEvent,\r\n\tUmbRequestReloadStructureForEntityEvent,\r\n} from '@umbraco-cms/backoffice/entity-action';\r\nimport { UMB_ACTION_EVENT_CONTEXT } from '@umbraco-cms/backoffice/action';\r\nimport { UMB_ENTITY_CONTEXT } from '@umbraco-cms/backoffice/entity';\r\nimport { umbOpenModal } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_TREE_PICKER_MODAL } from '@umbraco-cms/backoffice/tree';\r\nimport type { MetaEntityBulkActionMoveToKind } from '@umbraco-cms/backoffice/extension-registry';\r\n\r\nexport class UmbMediaMoveEntityBulkAction extends UmbEntityBulkActionBase<MetaEntityBulkActionMoveToKind> {\r\n\tasync execute() {\r\n\t\tif (this.selection?.length === 0) return;\r\n\r\n\t\tconst value = await umbOpenModal(this, UMB_TREE_PICKER_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\tfoldersOnly: this.args.meta.foldersOnly,\r\n\t\t\t\thideTreeRoot: this.args.meta.hideTreeRoot,\r\n\t\t\t\ttreeAlias: this.args.meta.treeAlias,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tif (!value?.selection?.length) return;\r\n\r\n\t\tconst destinationUnique = value.selection[0];\r\n\t\tif (destinationUnique === undefined) throw new Error('Destination Unique is not available');\r\n\r\n\t\tconst bulkMoveRepository = await createExtensionApiByAlias<UmbBulkMoveToRepository>(\r\n\t\t\tthis,\r\n\t\t\tthis.args.meta.bulkMoveRepositoryAlias,\r\n\t\t);\r\n\t\tif (!bulkMoveRepository) throw new Error('Bulk Move Repository is not available');\r\n\r\n\t\tawait bulkMoveRepository.requestBulkMoveTo({ uniques: this.selection, destination: { unique: destinationUnique } });\r\n\r\n\t\tconst entityContext = await this.getContext(UMB_ENTITY_CONTEXT);\r\n\t\tif (!entityContext) throw new Error('Entity Context is not available');\r\n\r\n\t\tconst entityType = entityContext.getEntityType();\r\n\t\tconst unique = entityContext.getUnique();\r\n\r\n\t\tif (entityType && unique !== undefined) {\r\n\t\t\tconst eventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\r\n\t\t\tif (!eventContext) throw new Error('Event Context is not available');\r\n\r\n\t\t\tconst args = { entityType, unique };\r\n\r\n\t\t\tconst reloadChildren = new UmbRequestReloadChildrenOfEntityEvent(args);\r\n\t\t\teventContext.dispatchEvent(reloadChildren);\r\n\r\n\t\t\tconst reloadStructure = new UmbRequestReloadStructureForEntityEvent(args);\r\n\t\t\teventContext.dispatchEvent(reloadStructure);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport { UmbMediaMoveEntityBulkAction as api };\r\n"],"names":["UmbMediaMoveEntityBulkAction","UmbEntityBulkActionBase","value","umbOpenModal","UMB_TREE_PICKER_MODAL","destinationUnique","bulkMoveRepository","createExtensionApiByAlias","entityContext","UMB_ENTITY_CONTEXT","entityType","unique","eventContext","UMB_ACTION_EVENT_CONTEXT","args","reloadChildren","UmbRequestReloadChildrenOfEntityEvent","reloadStructure","UmbRequestReloadStructureForEntityEvent"],"mappings":";;;;;;;AAaO,MAAMA,UAAqCC,EAAwD;AAAA,EACzG,MAAM,UAAU;AACX,QAAA,KAAK,WAAW,WAAW,EAAG;AAElC,UAAMC,IAAQ,MAAMC,EAAa,MAAMC,GAAuB;AAAA,MAC7D,MAAM;AAAA,QACL,aAAa,KAAK,KAAK,KAAK;AAAA,QAC5B,cAAc,KAAK,KAAK,KAAK;AAAA,QAC7B,WAAW,KAAK,KAAK,KAAK;AAAA,MAAA;AAAA,IAC3B,CACA;AAEG,QAAA,CAACF,GAAO,WAAW,OAAQ;AAEzB,UAAAG,IAAoBH,EAAM,UAAU,CAAC;AAC3C,QAAIG,MAAsB,OAAiB,OAAA,IAAI,MAAM,qCAAqC;AAE1F,UAAMC,IAAqB,MAAMC;AAAA,MAChC;AAAA,MACA,KAAK,KAAK,KAAK;AAAA,IAChB;AACA,QAAI,CAACD,EAA0B,OAAA,IAAI,MAAM,uCAAuC;AAE1E,UAAAA,EAAmB,kBAAkB,EAAE,SAAS,KAAK,WAAW,aAAa,EAAE,QAAQD,EAAkB,GAAG;AAElH,UAAMG,IAAgB,MAAM,KAAK,WAAWC,CAAkB;AAC9D,QAAI,CAACD,EAAqB,OAAA,IAAI,MAAM,iCAAiC;AAE/D,UAAAE,IAAaF,EAAc,cAAc,GACzCG,IAASH,EAAc,UAAU;AAEnC,QAAAE,KAAcC,MAAW,QAAW;AACvC,YAAMC,IAAe,MAAM,KAAK,WAAWC,CAAwB;AACnE,UAAI,CAACD,EAAoB,OAAA,IAAI,MAAM,gCAAgC;AAE7D,YAAAE,IAAO,EAAE,YAAAJ,GAAY,QAAAC,EAAO,GAE5BI,IAAiB,IAAIC,EAAsCF,CAAI;AACrE,MAAAF,EAAa,cAAcG,CAAc;AAEnC,YAAAE,IAAkB,IAAIC,EAAwCJ,CAAI;AACxE,MAAAF,EAAa,cAAcK,CAAe;AAAA,IAAA;AAAA,EAC3C;AAEF;"}