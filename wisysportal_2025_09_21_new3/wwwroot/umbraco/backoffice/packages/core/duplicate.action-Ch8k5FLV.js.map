{"version":3,"file":"duplicate.action-Ch8k5FLV.js","sources":["../../../src/packages/core/entity-action/common/duplicate/duplicate.action.ts"],"sourcesContent":["import { UmbEntityActionBase } from '../../entity-action-base.js';\r\nimport { UmbRequestReloadStructureForEntityEvent } from '../../request-reload-structure-for-entity.event.js';\r\nimport type { UmbDuplicateRepository } from './duplicate-repository.interface.js';\r\nimport { createExtensionApiByAlias } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { UMB_ACTION_EVENT_CONTEXT } from '@umbraco-cms/backoffice/action';\r\n\r\nexport class UmbDuplicateEntityAction extends UmbEntityActionBase<any> {\r\n\toverride async execute() {\r\n\t\tif (!this.args.unique) throw new Error('Unique is not available');\r\n\t\tif (!this.args.entityType) throw new Error('Entity Type is not available');\r\n\r\n\t\tconst duplicateRepository = await createExtensionApiByAlias<UmbDuplicateRepository>(\r\n\t\t\tthis,\r\n\t\t\tthis.args.meta.duplicateRepositoryAlias,\r\n\t\t);\r\n\t\tif (!duplicateRepository) throw new Error('Duplicate repository is not available');\r\n\r\n\t\tconst { error } = await duplicateRepository.requestDuplicate({\r\n\t\t\tunique: this.args.unique,\r\n\t\t});\r\n\r\n\t\tif (error) {\r\n\t\t\tthrow error;\r\n\t\t}\r\n\r\n\t\tthis.#notify();\r\n\t}\r\n\r\n\tasync #notify() {\r\n\t\tconst actionEventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\r\n\t\tif (!actionEventContext) {\r\n\t\t\tthrow new Error('Action event context is not available');\r\n\t\t}\r\n\t\tconst event = new UmbRequestReloadStructureForEntityEvent({\r\n\t\t\tunique: this.args.unique,\r\n\t\t\tentityType: this.args.entityType,\r\n\t\t});\r\n\r\n\t\tactionEventContext.dispatchEvent(event);\r\n\t}\r\n}\r\n\r\nexport { UmbDuplicateEntityAction as api };\r\n"],"names":["UmbDuplicateEntityAction","UmbEntityActionBase","duplicateRepository","createExtensionApiByAlias","error","#notify","actionEventContext","UMB_ACTION_EVENT_CONTEXT","event","UmbRequestReloadStructureForEntityEvent"],"mappings":";;;;AAMO,MAAMA,UAAiCC,EAAyB;AAAA,EACtE,MAAe,UAAU;AACxB,QAAI,CAAC,KAAK,KAAK,OAAc,OAAA,IAAI,MAAM,yBAAyB;AAChE,QAAI,CAAC,KAAK,KAAK,WAAkB,OAAA,IAAI,MAAM,8BAA8B;AAEzE,UAAMC,IAAsB,MAAMC;AAAA,MACjC;AAAA,MACA,KAAK,KAAK,KAAK;AAAA,IAChB;AACA,QAAI,CAACD,EAA2B,OAAA,IAAI,MAAM,uCAAuC;AAEjF,UAAM,EAAE,OAAAE,EAAA,IAAU,MAAMF,EAAoB,iBAAiB;AAAA,MAC5D,QAAQ,KAAK,KAAK;AAAA,IAAA,CAClB;AAED,QAAIE;AACG,YAAAA;AAGP,SAAKC,GAAQ;AAAA,EAAA;AAAA,EAGd,MAAMA,KAAU;AACf,UAAMC,IAAqB,MAAM,KAAK,WAAWC,CAAwB;AACzE,QAAI,CAACD;AACE,YAAA,IAAI,MAAM,uCAAuC;AAElD,UAAAE,IAAQ,IAAIC,EAAwC;AAAA,MACzD,QAAQ,KAAK,KAAK;AAAA,MAClB,YAAY,KAAK,KAAK;AAAA,IAAA,CACtB;AAED,IAAAH,EAAmB,cAAcE,CAAK;AAAA,EAAA;AAExC;"}