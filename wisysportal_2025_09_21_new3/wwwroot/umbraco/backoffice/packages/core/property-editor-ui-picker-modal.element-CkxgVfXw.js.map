{"version":3,"file":"property-editor-ui-picker-modal.element-CkxgVfXw.js","sources":["../../../src/packages/core/property-editor/ui-picker-modal/property-editor-ui-picker-modal.element.ts"],"sourcesContent":["import type { ManifestPropertyEditorUi } from '../extensions/types.js';\r\nimport type {\r\n\tUmbPropertyEditorUIPickerModalData,\r\n\tUmbPropertyEditorUIPickerModalValue,\r\n} from './property-editor-ui-picker-modal.token.js';\r\nimport { css, customElement, html, repeat, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { fromCamelCase } from '@umbraco-cms/backoffice/utils';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { umbFocus } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport type { UUIInputEvent } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n@customElement('umb-property-editor-ui-picker-modal')\r\nexport class UmbPropertyEditorUIPickerModalElement extends UmbModalBaseElement<\r\n\tUmbPropertyEditorUIPickerModalData,\r\n\tUmbPropertyEditorUIPickerModalValue\r\n> {\r\n\t@state()\r\n\tprivate _groupedPropertyEditorUIs: Array<{ key: string; items: Array<ManifestPropertyEditorUi> }> = [];\r\n\r\n\t@state()\r\n\tprivate _propertyEditorUIs: Array<ManifestPropertyEditorUi> = [];\r\n\r\n\toverride connectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\r\n\t\tthis.#usePropertyEditorUIs();\r\n\t}\r\n\r\n\t#usePropertyEditorUIs() {\r\n\t\tthis.observe(umbExtensionsRegistry.byType('propertyEditorUi'), (propertyEditorUIs) => {\r\n\t\t\t// Only include Property Editor UIs which has Property Editor Schema Alias\r\n\t\t\tthis._propertyEditorUIs = propertyEditorUIs\r\n\t\t\t\t.filter((propertyEditorUi) => !!propertyEditorUi.meta.propertyEditorSchemaAlias)\r\n\t\t\t\t.sort((a, b) => a.meta.label.localeCompare(b.meta.label));\r\n\r\n\t\t\tthis.#groupPropertyEditorUIs(this._propertyEditorUIs);\r\n\t\t});\r\n\t}\r\n\r\n\t#handleClick(propertyEditorUi: ManifestPropertyEditorUi) {\r\n\t\tthis.value = { selection: [propertyEditorUi.alias] };\r\n\t\tthis._submitModal();\r\n\t}\r\n\r\n\t#handleFilterInput(event: UUIInputEvent) {\r\n\t\tconst query = ((event.target.value as string) || '').toLowerCase();\r\n\r\n\t\tconst result = !query\r\n\t\t\t? this._propertyEditorUIs\r\n\t\t\t: this._propertyEditorUIs.filter(\r\n\t\t\t\t\t(propertyEditorUI) =>\r\n\t\t\t\t\t\tpropertyEditorUI.name.toLowerCase().includes(query) || propertyEditorUI.alias.toLowerCase().includes(query),\r\n\t\t\t\t);\r\n\r\n\t\tthis.#groupPropertyEditorUIs(result);\r\n\t}\r\n\r\n\t#groupPropertyEditorUIs(items: Array<ManifestPropertyEditorUi>) {\r\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n\t\t// @ts-expect-error\r\n\t\tconst grouped = Object.groupBy(items, (propertyEditorUi: ManifestPropertyEditorUi) =>\r\n\t\t\tfromCamelCase(propertyEditorUi.meta.group),\r\n\t\t);\r\n\r\n\t\tthis._groupedPropertyEditorUIs = Object.keys(grouped)\r\n\t\t\t.sort((a, b) => a.localeCompare(b))\r\n\t\t\t.map((key) => ({ key, items: grouped[key] }));\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=${this.localize.term('propertyEditorPicker_openPropertyEditorPicker')}>\r\n\t\t\t\t<uui-box>${this.#renderFilter()} ${this.#renderGrid()}</uui-box>\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button label=${this.localize.term('general_close')} @click=${this._rejectModal}></uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderFilter() {\r\n\t\treturn html`\r\n\t\t\t<uui-input\r\n\t\t\t\ttype=\"search\"\r\n\t\t\t\tid=\"filter\"\r\n\t\t\t\t@input=${this.#handleFilterInput}\r\n\t\t\t\tplaceholder=${this.localize.term('placeholders_filter')}\r\n\t\t\t\tlabel=${this.localize.term('placeholders_filter')}\r\n\t\t\t\t${umbFocus()}>\r\n\t\t\t\t<uui-icon name=\"search\" slot=\"prepend\" id=\"filter-icon\"></uui-icon>\r\n\t\t\t</uui-input>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderGrid() {\r\n\t\treturn html`\r\n\t\t\t${repeat(\r\n\t\t\t\tthis._groupedPropertyEditorUIs,\r\n\t\t\t\t(group) => group.key,\r\n\t\t\t\t(group) => html`\r\n\t\t\t\t\t<h4>${group.key}</h4>\r\n\t\t\t\t\t${this.#renderGroupItems(group.items)}\r\n\t\t\t\t`,\r\n\t\t\t)}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderGroupItems(groupItems: Array<ManifestPropertyEditorUi>) {\r\n\t\treturn html`\r\n\t\t\t<ul id=\"item-grid\">\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tgroupItems,\r\n\t\t\t\t\t(propertyEditorUI) => propertyEditorUI.alias,\r\n\t\t\t\t\t(propertyEditorUI) => html`\r\n\t\t\t\t\t\t<li class=\"item\" ?selected=${this.value.selection.includes(propertyEditorUI.alias)}>\r\n\t\t\t\t\t\t\t<button type=\"button\" @click=${() => this.#handleClick(propertyEditorUI)}>\r\n\t\t\t\t\t\t\t\t<umb-icon name=${propertyEditorUI.meta.icon} class=\"icon\"></umb-icon>\r\n\t\t\t\t\t\t\t\t${propertyEditorUI.meta.label || propertyEditorUI.name}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t</ul>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t#filter {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t#filter-icon {\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tpadding-left: var(--uui-size-space-2);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tcolor: var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t#item-grid {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-template-columns: repeat(auto-fill, minmax(70px, 1fr));\r\n\t\t\t\tmargin: 0;\r\n\t\t\t\tpadding: 0;\r\n\t\t\t\tgrid-gap: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t#item-grid .item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: flex-start;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\tlist-style: none;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tborder: 1px solid transparent;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t}\r\n\r\n\t\t\t#item-grid .item:hover {\r\n\t\t\t\tbackground: var(--uui-color-surface-emphasis);\r\n\t\t\t\tcolor: var(--uui-color-interactive-emphasis);\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t}\r\n\r\n\t\t\t#item-grid .item[selected] button {\r\n\t\t\t\tbackground: var(--uui-color-selected);\r\n\t\t\t\tcolor: var(--uui-color-selected-contrast);\r\n\t\t\t}\r\n\r\n\t\t\t#item-grid .item button {\r\n\t\t\t\tbackground: none;\r\n\t\t\t\tborder: none;\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tpadding: var(--uui-size-space-3);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\tfont-size: 0.8rem;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tcolor: var(--uui-color-interactive);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t}\r\n\r\n\t\t\t#item-grid .item .icon {\r\n\t\t\t\tfont-size: 2em;\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-2);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbPropertyEditorUIPickerModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-property-editor-ui-picker-modal': UmbPropertyEditorUIPickerModalElement;\r\n\t}\r\n}\r\n"],"names":["_UmbPropertyEditorUIPickerModalElement_instances","usePropertyEditorUIs_fn","handleClick_fn","handleFilterInput_fn","groupPropertyEditorUIs_fn","renderFilter_fn","renderGrid_fn","renderGroupItems_fn","UmbPropertyEditorUIPickerModalElement","UmbModalBaseElement","__privateAdd","__privateMethod","html","umbExtensionsRegistry","propertyEditorUIs","propertyEditorUi","a","b","event","query","result","propertyEditorUI","items","grouped","fromCamelCase","key","umbFocus","repeat","group","groupItems","css","__decorateClass","state","customElement","UmbPropertyEditorUIPickerModalElement$1"],"mappings":"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"}