{"version":3,"file":"dictionary-table-collection-view.element-Jhyy_IqJ.js","sources":["../../../src/packages/dictionary/collection/views/table/dictionary-table-collection-view.element.ts"],"sourcesContent":["import type { UmbDictionaryCollectionModel } from '../../types.js';\r\nimport { UMB_EDIT_DICTIONARY_WORKSPACE_PATH_PATTERN } from '../../../workspace/paths.js';\r\nimport type { UmbDefaultCollectionContext } from '@umbraco-cms/backoffice/collection';\r\nimport { UMB_COLLECTION_CONTEXT } from '@umbraco-cms/backoffice/collection';\r\nimport type { UmbTableColumn, UmbTableConfig, UmbTableItem } from '@umbraco-cms/backoffice/components';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbLanguageDetailModel } from '@umbraco-cms/backoffice/language';\r\nimport { UmbLanguageCollectionRepository } from '@umbraco-cms/backoffice/language';\r\n\r\n@customElement('umb-dictionary-table-collection-view')\r\nexport class UmbDictionaryTableCollectionViewElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _tableConfig: UmbTableConfig = {\r\n\t\tallowSelection: false,\r\n\t};\r\n\r\n\t@state()\r\n\tprivate _tableColumns: Array<UmbTableColumn> = [\r\n\t\t{\r\n\t\t\tname: 'Name',\r\n\t\t\talias: 'name',\r\n\t\t},\r\n\t];\r\n\r\n\t@state()\r\n\tprivate _tableItems: Array<UmbTableItem> = [];\r\n\r\n\t#collectionContext?: UmbDefaultCollectionContext<UmbDictionaryCollectionModel>;\r\n\t#languageCollectionRepository = new UmbLanguageCollectionRepository(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_COLLECTION_CONTEXT, (instance) => {\r\n\t\t\tthis.#collectionContext = instance;\r\n\t\t\tthis.#observeCollectionItems();\r\n\t\t});\r\n\t}\r\n\r\n\tasync #observeCollectionItems() {\r\n\t\tif (!this.#collectionContext) return;\r\n\r\n\t\tconst { data: languageData } = await this.#languageCollectionRepository.requestCollection({});\r\n\t\tif (!languageData) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#collectionContext.items,\r\n\t\t\t(collectionItems) => {\r\n\t\t\t\tthis.#createTableColumns(languageData.items);\r\n\t\t\t\tthis.#createTableItems(collectionItems, languageData.items);\r\n\t\t\t},\r\n\t\t\t'umbCollectionItemsObserver',\r\n\t\t);\r\n\t}\r\n\r\n\t#createTableColumns(languages: Array<UmbLanguageDetailModel>) {\r\n\t\tconst columns: Array<UmbTableColumn> = [\r\n\t\t\t{\r\n\t\t\t\tname: this.localize.term('general_name'),\r\n\t\t\t\talias: 'name',\r\n\t\t\t},\r\n\t\t];\r\n\r\n\t\tconst languageColumns: Array<UmbTableColumn> = languages.map((language) => {\r\n\t\t\treturn {\r\n\t\t\t\tname: language.name,\r\n\t\t\t\talias: language.unique,\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\tthis._tableColumns = [...columns, ...languageColumns];\r\n\t}\r\n\r\n\t#createTableItems(dictionaries: Array<UmbDictionaryCollectionModel>, languages: Array<UmbLanguageDetailModel>) {\r\n\t\tthis._tableItems = dictionaries.map((dictionary) => {\r\n\t\t\tconst editPath = UMB_EDIT_DICTIONARY_WORKSPACE_PATH_PATTERN.generateAbsolute({\r\n\t\t\t\tunique: dictionary.unique,\r\n\t\t\t});\r\n\r\n\t\t\treturn {\r\n\t\t\t\tid: dictionary.unique,\r\n\t\t\t\ticon: 'icon-book-alt-2',\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'name',\r\n\t\t\t\t\t\tvalue: html`<a style=\"font-weight:bold\" href=${editPath}> ${dictionary.name}</a> `,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t...languages.map((language) => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tcolumnAlias: language.unique,\r\n\t\t\t\t\t\t\tvalue: dictionary.translatedIsoCodes?.includes(language.unique)\r\n\t\t\t\t\t\t\t\t? this.#renderCheckIcon(language.name)\r\n\t\t\t\t\t\t\t\t: this.#renderAlertIcon(language.name),\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}),\r\n\t\t\t\t],\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\t#renderCheckIcon(name: string) {\r\n\t\treturn html`<uui-icon\r\n\t\t\tname=\"check\"\r\n\t\t\ttitle=\"${this.localize.term('visuallyHiddenTexts_hasTranslation')} (${name})\"\r\n\t\t\tstyle=\"color:var(--uui-color-positive-standalone);display:inline-block\"></uui-icon>`;\r\n\t}\r\n\r\n\t#renderAlertIcon(name: string) {\r\n\t\treturn html`<uui-icon\r\n\t\t\tname=\"alert\"\r\n\t\t\ttitle=\"${this.localize.term('visuallyHiddenTexts_noTranslation')} (${name})\"\r\n\t\t\tstyle=\"color:var(--uui-color-danger-standalone);display:inline-block\"></uui-icon>`;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-table .config=${this._tableConfig} .columns=${this._tableColumns} .items=${this._tableItems}></umb-table>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbDictionaryTableCollectionViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-dictionary-table-collection-view': UmbDictionaryTableCollectionViewElement;\r\n\t}\r\n}\r\n"],"names":["_collectionContext","_languageCollectionRepository","_UmbDictionaryTableCollectionViewElement_instances","observeCollectionItems_fn","createTableColumns_fn","createTableItems_fn","renderCheckIcon_fn","renderAlertIcon_fn","UmbDictionaryTableCollectionViewElement","UmbLitElement","__privateAdd","UmbLanguageCollectionRepository","UMB_COLLECTION_CONTEXT","instance","__privateSet","__privateMethod","html","__privateGet","languageData","collectionItems","languages","columns","languageColumns","language","dictionaries","dictionary","editPath","UMB_EDIT_DICTIONARY_WORKSPACE_PATH_PATTERN","name","UmbTextStyles","css","__decorateClass","state","customElement","UmbDictionaryTableCollectionViewElement$1"],"mappings":";;;;;;;;;;;;wXAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAYa,IAAAC,IAAN,cAAsDC,EAAc;AAAA,EAoB1E,cAAc;AACP,UAAA,GArBDC,EAAA,MAAAR,CAAA,GAEN,KAAQ,eAA+B;AAAA,MACtC,gBAAgB;AAAA,IACjB,GAGA,KAAQ,gBAAuC;AAAA,MAC9C;AAAA,QACC,MAAM;AAAA,QACN,OAAO;AAAA,MAAA;AAAA,IAET,GAGA,KAAQ,cAAmC,CAAC,GAE5CQ,EAAA,MAAAV,CAAA,GACgCU,EAAA,MAAAT,GAAA,IAAIU,EAAgC,IAAI,CAAA,GAKlE,KAAA,eAAeC,GAAwB,CAACC,MAAa;AACzD,MAAAC,EAAA,MAAKd,GAAqBa,CAAA,GAC1BE,EAAA,MAAKb,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,IAAA,CACA;AAAA,EAAA;AAAA,EA8EO,SAAS;AACV,WAAAa;AAAA,wBACe,KAAK,YAAY,aAAa,KAAK,aAAa,WAAW,KAAK,WAAW;AAAA;AAAA,EAAA;AAanG;AAtGChB,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AAlBMC,IAAA,oBAAA,QAAA;AA6BAC,IAAuB,iBAAG;AAC3B,MAAA,CAACc,QAAKjB,CAAoB,EAAA;AAExB,QAAA,EAAE,MAAMkB,EAAa,IAAI,MAAMD,EAAK,MAAAhB,CAAA,EAA8B,kBAAkB,EAAE;AAC5F,EAAKiB,KAEA,KAAA;AAAA,IACJD,QAAKjB,CAAmB,EAAA;AAAA,IACxB,CAACmB,MAAoB;AACf,MAAAJ,EAAA,MAAAb,GAAAE,CAAA,EAAL,WAAyBc,EAAa,KAAA,GACjCH,EAAA,MAAAb,GAAAG,CAAA,EAAL,KAAuB,MAAAc,GAAiBD,EAAa,KAAA;AAAA,IACtD;AAAA,IACA;AAAA,EACD;AACD;AAEAd,IAAmB,SAACgB,GAA0C;AAC7D,QAAMC,IAAiC;AAAA,IACtC;AAAA,MACC,MAAM,KAAK,SAAS,KAAK,cAAc;AAAA,MACvC,OAAO;AAAA,IAAA;AAAA,EAET,GAEMC,IAAyCF,EAAU,IAAI,CAACG,OACtD;AAAA,IACN,MAAMA,EAAS;AAAA,IACf,OAAOA,EAAS;AAAA,EACjB,EACA;AAED,OAAK,gBAAgB,CAAC,GAAGF,GAAS,GAAGC,CAAe;AACrD;AAEAjB,IAAiB,SAACmB,GAAmDJ,GAA0C;AAC9G,OAAK,cAAcI,EAAa,IAAI,CAACC,MAAe;AAC7C,UAAAC,IAAWC,EAA2C,iBAAiB;AAAA,MAC5E,QAAQF,EAAW;AAAA,IAAA,CACnB;AAEM,WAAA;AAAA,MACN,IAAIA,EAAW;AAAA,MACf,MAAM;AAAA,MACN,MAAM;AAAA,QACL;AAAA,UACC,aAAa;AAAA,UACb,OAAOT,qCAAwCU,CAAQ,KAAKD,EAAW,IAAI;AAAA,QAC5E;AAAA,QACA,GAAGL,EAAU,IAAI,CAACG,OACV;AAAA,UACN,aAAaA,EAAS;AAAA,UACtB,OAAOE,EAAW,oBAAoB,SAASF,EAAS,MAAM,IAC3DR,EAAK,MAAAb,GAAAI,CAAA,EAAL,WAAsBiB,EAAS,IAAA,IAC/BR,EAAK,MAAAb,GAAAK,CAAA,EAAL,WAAsBgB,EAAS,IAAA;AAAA,QACnC,EACA;AAAA,MAAA;AAAA,IAEH;AAAA,EAAA,CACA;AACF;AAEAjB,IAAgB,SAACsB,GAAc;AACvB,SAAAZ;AAAA;AAAA,YAEG,KAAK,SAAS,KAAK,oCAAoC,CAAC,KAAKY,CAAI;AAAA;AAE5E;AAEArB,IAAgB,SAACqB,GAAc;AACvB,SAAAZ;AAAA;AAAA,YAEG,KAAK,SAAS,KAAK,mCAAmC,CAAC,KAAKY,CAAI;AAAA;AAE3E;AAtGYpB,EA8GI,SAAS;AAAA,EACxBqB;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAMD;AApHQC,EAAA;AAAA,EADPC,EAAM;AAAA,GADKxB,EAEJ,WAAA,gBAAA,CAAA;AAKAuB,EAAA;AAAA,EADPC,EAAM;AAAA,GANKxB,EAOJ,WAAA,iBAAA,CAAA;AAQAuB,EAAA;AAAA,EADPC,EAAM;AAAA,GAdKxB,EAeJ,WAAA,eAAA,CAAA;AAfIA,IAANuB,EAAA;AAAA,EADNE,EAAc,sCAAsC;AAAA,GACxCzB,CAAA;AAyHb,MAAA0B,IAAe1B;"}