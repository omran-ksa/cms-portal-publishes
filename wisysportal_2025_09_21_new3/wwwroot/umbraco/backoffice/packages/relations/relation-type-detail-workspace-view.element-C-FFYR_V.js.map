{"version":3,"file":"relation-type-detail-workspace-view.element-C-FFYR_V.js","sources":["../../../src/packages/relations/relation-types/workspace/relation-type/views/relation-type-detail-workspace-view.element.ts"],"sourcesContent":["import { UMB_RELATION_TYPE_WORKSPACE_CONTEXT } from '../relation-type-workspace.context-token.js';\r\nimport type { UmbRelationTypeDetailModel } from '../../../types.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { css, html, customElement, state, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UmbTableColumn, UmbTableConfig, UmbTableItem } from '@umbraco-cms/backoffice/components';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbWorkspaceViewElement } from '@umbraco-cms/backoffice/workspace';\r\nimport type { UmbRelationDetailModel } from '@umbraco-cms/backoffice/relations';\r\nimport { UmbRelationCollectionRepository } from '@umbraco-cms/backoffice/relations';\r\nimport { observeMultiple } from '@umbraco-cms/backoffice/observable-api';\r\nimport { UmbPaginationManager } from '@umbraco-cms/backoffice/utils';\r\nimport type { UUIPaginationEvent } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n@customElement('umb-relation-type-detail-workspace-view')\r\nexport class UmbRelationTypeDetailWorkspaceViewElement extends UmbLitElement implements UmbWorkspaceViewElement {\r\n\t@state()\r\n\t_relations: Array<UmbRelationDetailModel> = [];\r\n\r\n\t@state()\r\n\t_parent?: UmbRelationTypeDetailModel['parent'];\r\n\r\n\t@state()\r\n\t_child?: UmbRelationTypeDetailModel['child'];\r\n\r\n\t@state()\r\n\t_isBidirectional?: UmbRelationTypeDetailModel['isBidirectional'];\r\n\r\n\t@state()\r\n\t_isDependency?: UmbRelationTypeDetailModel['isDependency'];\r\n\r\n\t@state()\r\n\t_currentPageNumber = 1;\r\n\r\n\t@state()\r\n\t_totalPages = 1;\r\n\r\n\t@state()\r\n\t_loading = false;\r\n\r\n\t#workspaceContext?: typeof UMB_RELATION_TYPE_WORKSPACE_CONTEXT.TYPE;\r\n\t#relationCollectionRepository = new UmbRelationCollectionRepository(this);\r\n\t#paginationManager = new UmbPaginationManager();\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.#paginationManager.setPageSize(50);\r\n\r\n\t\tthis.observe(this.#paginationManager.currentPage, (number) => (this._currentPageNumber = number));\r\n\t\tthis.observe(this.#paginationManager.totalPages, (number) => (this._totalPages = number));\r\n\r\n\t\tthis.consumeContext(UMB_RELATION_TYPE_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#workspaceContext = instance;\r\n\t\t\tthis.#requestRelations();\r\n\t\t\tthis.#observeDetails();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeDetails() {\r\n\t\tif (!this.#workspaceContext) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tobserveMultiple([\r\n\t\t\t\tthis.#workspaceContext.parent,\r\n\t\t\t\tthis.#workspaceContext.child,\r\n\t\t\t\tthis.#workspaceContext.isBidirectional,\r\n\t\t\t\tthis.#workspaceContext.isDependency,\r\n\t\t\t]),\r\n\t\t\t([parent, child, isBidirectional, isDependency]) => {\r\n\t\t\t\tthis._parent = parent;\r\n\t\t\t\tthis._child = child;\r\n\t\t\t\tthis._isBidirectional = isBidirectional;\r\n\t\t\t\tthis._isDependency = isDependency;\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\tasync #requestRelations() {\r\n\t\tthis._loading = true;\r\n\r\n\t\tconst relationTypeUnique = this.#workspaceContext?.getUnique();\r\n\t\tif (!relationTypeUnique) throw new Error('Relation type unique is required');\r\n\r\n\t\tconst { data } = await this.#relationCollectionRepository.requestCollection({\r\n\t\t\trelationType: {\r\n\t\t\t\tunique: relationTypeUnique,\r\n\t\t\t},\r\n\t\t\tskip: this.#paginationManager.getSkip(),\r\n\t\t\ttake: this.#paginationManager.getPageSize(),\r\n\t\t});\r\n\r\n\t\tif (data) {\r\n\t\t\tthis._relations = data.items;\r\n\t\t\tthis.#paginationManager.setTotalItems(data.total);\r\n\t\t\tthis._loading = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _tableConfig: UmbTableConfig = {\r\n\t\tallowSelection: false,\r\n\t\thideIcon: true,\r\n\t};\r\n\r\n\tprivate _tableColumns: Array<UmbTableColumn> = [\r\n\t\t{\r\n\t\t\tname: 'Parent',\r\n\t\t\talias: 'parent',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Child',\r\n\t\t\talias: 'child',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Created',\r\n\t\t\talias: 'created',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Comment',\r\n\t\t\talias: 'comment',\r\n\t\t},\r\n\t];\r\n\r\n\tprivate get _tableItems(): UmbTableItem[] {\r\n\t\tif (this._relations.length === 0) {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'no-relations',\r\n\t\t\t\t\tdata: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcolumnAlias: 'parent',\r\n\t\t\t\t\t\t\tvalue: 'No relations found',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t},\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\treturn this._relations.map((relation) => {\r\n\t\t\treturn {\r\n\t\t\t\tid: relation.unique,\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'parent',\r\n\t\t\t\t\t\tvalue: relation.parent.name,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'child',\r\n\t\t\t\t\t\tvalue: relation.child.name,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'created',\r\n\t\t\t\t\t\tvalue: this.localize.date(relation.createDate, { dateStyle: 'long', timeStyle: 'medium' }),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'comment',\r\n\t\t\t\t\t\tvalue: relation.comment,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\t#onPageChange(event: UUIPaginationEvent) {\r\n\t\tthis.#paginationManager.setCurrentPageNumber(event.target?.current);\r\n\t\tthis.#requestRelations();\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`${this.#renderRelations()}${this.#renderDetails()}`;\r\n\t}\r\n\r\n\t#renderRelations() {\r\n\t\tif (this._loading) return html`<uui-loader></uui-loader>`;\r\n\t\treturn html`\r\n\t\t\t<div>\r\n\t\t\t\t<umb-table .config=${this._tableConfig} .columns=${this._tableColumns} .items=${this._tableItems}></umb-table>\r\n\r\n\t\t\t\t${this._totalPages > 1\r\n\t\t\t\t\t? html`\r\n\t\t\t\t\t\t\t<uui-pagination\r\n\t\t\t\t\t\t\t\t.current=${this._currentPageNumber}\r\n\t\t\t\t\t\t\t\t.total=${this._totalPages}\r\n\t\t\t\t\t\t\t\tfirstlabel=${this.localize.term('general_first')}\r\n                                previouslabel=${this.localize.term('general_previous')}\r\n                                nextlabel=${this.localize.term('general_next')}\r\n                                lastlabel=${this.localize.term('general_last')}\r\n\t\t\t\t\t\t\t\t@change=${this.#onPageChange}></uui-pagination>\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t: nothing}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderDetails() {\r\n\t\treturn html`<uui-box>\r\n\t\t\t<umb-property-layout label=\"Parent Type\" orientation=\"vertical\"\r\n\t\t\t\t><div slot=\"editor\">${this._parent?.objectType.name}</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t\t<umb-property-layout label=\"Child Type\" orientation=\"vertical\">\r\n\t\t\t\t<div slot=\"editor\">${this._child?.objectType.name}</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t\t<umb-property-layout label=\"Bidirectional\" orientation=\"vertical\">\r\n\t\t\t\t<div slot=\"editor\">${this._isBidirectional}</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t\t<umb-property-layout label=\"Dependency\" orientation=\"vertical\">\r\n\t\t\t\t<div slot=\"editor\">${this._isDependency}</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t</uui-box>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgap: var(--uui-size-layout-1);\r\n\t\t\t\tpadding: var(--uui-size-layout-1);\r\n\t\t\t\tgrid-template-columns: 1fr 350px;\r\n\t\t\t}\r\n\r\n\t\t\tuui-loader {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t}\r\n\r\n\t\t\tuui-pagination {\r\n\t\t\t\tmargin-top: var(--uui-size-layout-1);\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbRelationTypeDetailWorkspaceViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-relation-type-detail-workspace-view': UmbRelationTypeDetailWorkspaceViewElement;\r\n\t}\r\n}\r\n"],"names":["_workspaceContext","_relationCollectionRepository","_paginationManager","_UmbRelationTypeDetailWorkspaceViewElement_instances","observeDetails_fn","requestRelations_fn","onPageChange_fn","renderRelations_fn","renderDetails_fn","UmbRelationTypeDetailWorkspaceViewElement","UmbLitElement","__privateAdd","UmbRelationCollectionRepository","UmbPaginationManager","__privateGet","number","UMB_RELATION_TYPE_WORKSPACE_CONTEXT","instance","__privateSet","__privateMethod","relation","html","observeMultiple","parent","child","isBidirectional","isDependency","relationTypeUnique","data","event","nothing","UmbTextStyles","css","__decorateClass","state","customElement","UmbRelationTypeDetailWorkspaceViewElement$1"],"mappings":"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"}